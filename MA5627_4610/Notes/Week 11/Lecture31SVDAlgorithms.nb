(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     64528,       1614]
NotebookOptionsPosition[     59722,       1525]
NotebookOutlinePosition[     60342,       1546]
CellTagsIndexPosition[     60299,       1543]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Lecture 31: SVD Algorithms", "Title",
 CellChangeTimes->CompressedData["
1:eJwdzE0ow2EAx/G/lxhJUd5qCo2DzGEXc5C2kMVBInKQvGUHLzHvJhQ38k7z
mpDXMZw42Cx/w8QiL3kLC5uJzWspPL/n8O1z+wZmFyfn2TMME0CCYnsxsz1l
EW2cj9lBBccY80osa+fEw9ZfgauVyFYNu0Fzoj7URpwS3VITJ8dG3oidT8pR
6F4ZEMSdtogi3qzUZt/IZX9iCaujdr1L7kqJi7GsEQZfDJoUxFyXcTMUp6vU
A8SG2h8NVGmrw+aInI7ocKhnWko1RF6qjwy2da+pYd2ljrrUU6M8Ju7vKhYg
R29Yh8mSMjVcMbXfQK3twQgdDytMUOLZaobSTcPECVEQej4J69loLeT211Av
hNtbUNdbpIO8l5RD6D1fcAQTovhn0MnaQX3myq/h/aOKmiLfMcLMr4xHKJc2
WqAw3/pM/x98GzzwkVKvPno+YSA/4gt+Fzr8wSxZn8Mp0W+20RmGrOS5QY1/
nAdcn0nzgpl7SX6ws2mCquTnyNhVi2ionlcO/wGufzCH
  "],ExpressionUUID->"bb443c9e-1a1c-437e-b10c-400e63a30bb8"],

Cell[TextData[{
 "Time to learn how to compute the SVD ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"U", ".", "\[CapitalSigma]", ".", 
     SuperscriptBox["V", "*"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "25e47b78-8cfe-4f04-89ff-fe92b7fc27e6"],
 ".  Perhaps not surprisingly, SVD algorithms look quite a bit like \
eigenvalue algorithms."
}], "Text",
 CellChangeTimes->{{3.8470540488466187`*^9, 3.847054299041844*^9}, 
   3.847054620646575*^9, {3.84705469788529*^9, 3.8470547053171043`*^9}, {
   3.84705474014857*^9, 3.847054741548669*^9}, {3.84705479048367*^9, 
   3.8470548010520067`*^9}, {3.847097256754077*^9, 3.8470972849056597`*^9}, {
   3.847140756236305*^9, 3.847140780380496*^9}, {3.847141112793906*^9, 
   3.847141123081209*^9}, {3.847141212815769*^9, 3.8471414441116858`*^9}, {
   3.847141743880835*^9, 3.847141771661133*^9}, {3.847142998261689*^9, 
   3.847143060799942*^9}, {3.85602040131579*^9, 3.8560204580938797`*^9}, {
   3.8560205187472687`*^9, 3.856020526706026*^9}, {3.8560205717190027`*^9, 
   3.8560205921146717`*^9}},ExpressionUUID->"19c34891-b4a5-4bb2-9167-\
f8ac0b4049d9"],

Cell[CellGroupData[{

Cell[TextData[{
 "Eigenvalues of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["A", "*"], ".", "A"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "cb435b65-01fa-4959-a394-d5a4815018e6"]
}], "Section",
 CellChangeTimes->{{3.856020550505967*^9, 3.85602056173662*^9}, {
  3.8560206425211725`*^9, 
  3.8560206425211725`*^9}},ExpressionUUID->"06cf5ec8-bb59-4a7f-9f15-\
f3f30e200a76"],

Cell[TextData[{
 "If ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"U", ".", "\[CapitalSigma]", ".", 
     SuperscriptBox["V", "*"]}]}], TraditionalForm]],ExpressionUUID->
  "507254a0-6e49-4ab0-bd2a-1981086b04b8"],
 " is the SVD then ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["A", "*"], ".", "A"}], "=", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"U", ".", "\[CapitalSigma]", ".", 
         SuperscriptBox["V", "*"]}], ")"}], "*"], ".", "U", ".", 
      "\[CapitalSigma]", ".", 
      SuperscriptBox["V", "*"]}], "=", 
     RowBox[{
      RowBox[{"V", ".", 
       SuperscriptBox["\[CapitalSigma]", "*"], ".", 
       SuperscriptBox["U", "*"], ".", "U", ".", "\[CapitalSigma]", ".", 
       SuperscriptBox["V", "*"]}], "=", 
      RowBox[{"V", ".", 
       SuperscriptBox["\[CapitalSigma]", "*"], ".", "\[CapitalSigma]", ".", 
       SuperscriptBox["V", "*"]}]}]}]}], TraditionalForm]],
  InitializationCell->True,ExpressionUUID->
  "eac922a5-4b6c-4849-864e-675bfc718687"],
 " since U is unitary.  More over, since \[CapitalSigma] is real we wind up \
with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["A", "*"], ".", "A"}], "=", 
    RowBox[{"V", ".", 
     SuperscriptBox["\[CapitalSigma]", "2"], ".", 
     SuperscriptBox["V", "*"]}]}], TraditionalForm]],
  InitializationCell->True,ExpressionUUID->
  "98e75a06-cdb8-4a94-a3b7-23cb2cf62510"],
 ".  We can compute the Hermitian eigenvalue problem ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["A", "*"], ".", "A"}], "=", 
    RowBox[{"V", ".", "\[CapitalLambda]", ".", 
     SuperscriptBox["V", "*"]}]}], TraditionalForm]],
  InitializationCell->True,ExpressionUUID->
  "efd55696-2665-419a-8ce7-c0018893592d"],
 " then compute \n",
 Cell[BoxData[
  FormBox["\[CapitalSigma]", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "712e9f41-6359-4833-bea0-b884a6fba8fa"],
 " as the diagonal matrix of the positive square roots of \[CapitalLambda] \
and compute U from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", ".", "\[CapitalSigma]"}], "=", 
    RowBox[{"A", ".", "V"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "478f4683-4187-45ae-aabc-359101cb1989"],
 ".  The problem with this (or similarly computing with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", ".", 
    SuperscriptBox["A", "*"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "4da22651-016e-4182-aabd-f3fa6fe01cef"],
 ") is that we know this problem (just like the normal equations) is more \
sensitive to perturbations than it needs to be.   The fundamental problem is \
the we formed the product. The stability problem is most extreme for the \
smaller singular values.  "
}], "Text",
 CellChangeTimes->{{3.8560206139560504`*^9, 
  3.856021270228301*^9}},ExpressionUUID->"15635c41-aea7-4a27-ad15-\
2fbcaa60db8d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Eigenvalues of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"H", "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        SuperscriptBox["A", "*"]},
       {"A", "0"}
      }], "\[NoBreak]", ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "3da34cf2-eaf1-44c7-8444-3f279a150ac0"]
}], "Section",
 CellChangeTimes->{{3.856020550505967*^9, 3.85602056173662*^9}, {
  3.8560206425211725`*^9, 3.8560206425211725`*^9}, {3.8560212915017595`*^9, 
  3.856021327163745*^9}},ExpressionUUID->"0d745080-ec3b-4020-ab6c-\
9383ecfd63fe"],

Cell[TextData[{
 "A direct computation shows that if ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"U", ".", "\[CapitalSigma]", ".", 
     SuperscriptBox["V", "*"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "7a93b570-b2b0-4ec9-9b3f-16b86f04752d"],
 " then \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", 
         SuperscriptBox["A", "*"]},
        {"A", "0"}
       }], "\[NoBreak]", ")"}], ".", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"V", "V"},
        {"U", 
         RowBox[{"-", "U"}]}
       }], "\[NoBreak]", ")"}]}], "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         SuperscriptBox["A", "*"], ".", "U"}], 
        RowBox[{"-", 
         RowBox[{
          SuperscriptBox["A", "*"], ".", "U"}]}]},
       {
        RowBox[{"A", ".", "V"}], 
        RowBox[{"A", ".", "V"}]}
      }], "\[NoBreak]", ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "78ac16c6-20ce-49ef-9b58-d2a6d8e97e18"],
 "\nSince ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"U", ".", "\[CapitalSigma]", ".", 
     SuperscriptBox["V", "*"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "9a4d6f9c-3c0a-44f3-9b30-d3bbba08ac01"],
 " we have ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", ".", "V"}], "=", 
    RowBox[{
     RowBox[{"U", ".", "\[CapitalSigma]", ".", 
      SuperscriptBox["V", "*"], ".", "V"}], "=", 
     RowBox[{"U", ".", "\[CapitalSigma]"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "8a2f941a-71fa-4749-a1f0-c6e0ab5cecc0"],
 ".  \nSince ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["A", "*"], "=", 
    RowBox[{"V", ".", "\[CapitalSigma]", ".", 
     SuperscriptBox["U", "*"]}]}], TraditionalForm]],ExpressionUUID->
  "245cabde-0769-41d3-8f7c-2371c6c0164e"],
 " we have that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["A", "*"], ".", "U"}], "=", 
    RowBox[{
     RowBox[{"V", ".", "\[CapitalSigma]", ".", 
      SuperscriptBox["U", "*"], ".", "U"}], "=", 
     RowBox[{"V", ".", "\[CapitalSigma]"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "43740c6e-84e6-4c2f-8bd4-4e29b9249426"],
 ". \nSo\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", 
         SuperscriptBox["A", "*"]},
        {"A", "0"}
       }], "\[NoBreak]", ")"}], ".", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"V", "V"},
        {"U", 
         RowBox[{"-", "U"}]}
       }], "\[NoBreak]", ")"}]}], "=", 
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"V", ".", "\[CapitalSigma]"}], 
         RowBox[{"-", 
          RowBox[{"V", ".", "\[CapitalSigma]"}]}]},
        {
         RowBox[{"U", ".", "\[CapitalSigma]"}], 
         RowBox[{"U", ".", "\[CapitalSigma]"}]}
       }], "\[NoBreak]", ")"}], "=", 
     RowBox[{
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"V", "V"},
         {"U", 
          RowBox[{"-", "U"}]}
        }], "\[NoBreak]", ")"}], ".", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"\[CapitalSigma]", "0"},
         {"0", 
          RowBox[{"-", "\[CapitalSigma]"}]}
        }], "\[NoBreak]", ")"}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "2ac609b6-9cf7-444d-ad9c-be9f948675b3"],
 ".\nIn words, the eigen values of the big Hermitian matrix in the heading \
are the ",
 Cell[BoxData[
  FormBox["\[PlusMinus]", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "10ce6acb-edf0-428a-9a55-88c68c43ba3a"],
 " the singular values. The singular vectors are in the eigenvectors.  "
}], "Text",
 CellChangeTimes->{{3.8560206139560504`*^9, 3.856021270228301*^9}, {
  3.8560213523567667`*^9, 3.856021915550828*^9}, {3.8560219522967925`*^9, 
  3.8560219525624413`*^9}},ExpressionUUID->"12212a60-6f8c-439f-a018-\
117a921cf05f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"12", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{"ConjugateTranspose", "[", "A", "]"}]},
       {"A", "0"}
      }], "\[NoBreak]", ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixPlot", "[", "H", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Lambda]", ",", "V"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", "H", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]", "=", 
   RowBox[{"SingularValueList", "[", "A", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Sigma]", ",", 
     RowBox[{"Select", "[", 
      RowBox[{"\[Lambda]", ",", "Positive"}], "]"}]}], "}"}], ",", 
   RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Directive", "[", 
       RowBox[{"Red", ",", 
        RowBox[{"PointSize", "[", "0.023", "]"}]}], "]"}], ",", 
      RowBox[{"Directive", "[", 
       RowBox[{"Blue", ",", " ", 
        RowBox[{"PointSize", "[", "0.015", "]"}]}], "]"}]}], "}"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8560219551313405`*^9, 3.8560222559820857`*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"0e917fcb-fdb2-48e8-91fb-b10a2105bf8e"],

Cell[BoxData[
 GraphicsBox[{{}, {
    {RGBColor[1, 0, 0], PointSize[0.023], AbsoluteThickness[1.6], 
     PointBox[{{1., 1.0155652615087472`}, {2., 0.8661965470878568}, {3., 
      0.6903431806608725}, {4., 0.23824883944099554`}}]}, 
    {RGBColor[0, 0, 1], PointSize[0.015], AbsoluteThickness[1.6], 
     PointBox[{{1., 1.0155652615087472`}, {2., 0.866196547087856}, {3., 
      0.6903431806608713}, {4., 0.23824883944099468`}, {
      5., -34.60920424289093}, {6., -36.85393873793115}, {
      7., -37.10003544587925}, {8., -40.8210086380974}}]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., -44.09495796954797},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{
     Charting`ScaledTicks[{Log, Exp}, {Log, Exp}, "Nice", WorkingPrecision -> 
      15.954589770191003`, RotateLabel -> 0], 
     Charting`ScaledFrameTicks[{Log, Exp}]}, {Automatic, Automatic}},
  GridLines->FrontEndValueCache[{Automatic, 
     Charting`ScaledTickValues[{Log, Exp}]}, {Automatic, {{-43.74911676688687, 
       Directive[]}, {-32.23619130191664, 
       Directive[]}, {-20.72326583694641, 
       Directive[]}, {-9.210340371976182, 
       Directive[]}, {2.302585092994046, 
       Directive[]}}}],
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 8.}, {-44.09495796954797, 1.0155652615087472`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->FrontEndValueCache[{Automatic, 
     Charting`ScaledTicks[{Log, Exp}, {Log, Exp}, "Nice", WorkingPrecision -> 
      15.954589770191003`, RotateLabel -> 0]}, {
    Automatic, {{-43.74911676688687, 
       FormBox[
        TemplateBox[{"10", 
          RowBox[{"-", "19"}]}, "Superscript", SyntaxForm -> SuperscriptBox], 
        TraditionalForm], {0.01, 0.}}, {-32.23619130191664, 
       FormBox[
        TemplateBox[{"10", 
          RowBox[{"-", "14"}]}, "Superscript", SyntaxForm -> SuperscriptBox], 
        TraditionalForm], {0.01, 0.}}, {-20.72326583694641, 
       FormBox[
        TemplateBox[{"10", 
          RowBox[{"-", "9"}]}, "Superscript", SyntaxForm -> SuperscriptBox], 
        TraditionalForm], {0.01, 0.}}, {-9.210340371976182, 
       FormBox[
        TemplateBox[{"10", 
          RowBox[{"-", "4"}]}, "Superscript", SyntaxForm -> SuperscriptBox], 
        TraditionalForm], {0.01, 0.}}, {2.302585092994046, 
       FormBox["10", TraditionalForm], {0.01, 0.}}, {-46.051701859880914`, 
       FormBox[
        TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-41.44653167389282, 
       FormBox[
        TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-39.14394658089878, 
       FormBox[
        TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-34.538776394910684`, 
       FormBox[
        TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-29.933606208922594`, 
       FormBox[
        TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-27.631021115928547`, 
       FormBox[
        TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-23.025850929940457`, 
       FormBox[
        TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-18.420680743952367`, 
       FormBox[
        TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-16.11809565095832, 
       FormBox[
        TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-11.512925464970229`, 
       FormBox[
        TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-6.907755278982137, 
       FormBox[
        TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-4.605170185988091, 
       FormBox[
        TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {0., 
       FormBox[
        TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      4.605170185988092, 
       FormBox[
        TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}}}]]], "Output",
 CellChangeTimes->{{3.8560220750063367`*^9, 3.8560221895094414`*^9}, {
  3.856022228514674*^9, 3.856022256653597*^9}},
 CellLabel->
  "Out[110]=",ExpressionUUID->"30337a6b-c2c8-4147-a479-974a69c93376"]
}, Open  ]],

Cell["\<\
This stable algorithm is what computes 99.999% of all SVDs in the world.  It \
is sneaky because it does not actualy need to make the big H matrix! Just \
like for eigenvalues there is a preliminary reduction. \
\>", "Text",
 CellChangeTimes->{{3.8560222737404194`*^9, 3.856022469732457*^9}, {
  3.8560227745640697`*^9, 
  3.8560229009711018`*^9}},ExpressionUUID->"e71a3980-88e2-4f34-bdc4-\
304647498636"],

Cell["\<\
For singular values, we can get to an upper bi-diagonal matrix! The \
bi-diagonal form is then iteratively reduced to a diagonal form.  If you only \
want singular values you do not need to keep the rotations \
\>", "Text",
 CellChangeTimes->{{3.8560222737404194`*^9, 3.856022469732457*^9}, {
  3.8560227745640697`*^9, 
  3.856022914637936*^9}},ExpressionUUID->"e36c77f7-ec42-4ce1-ab4a-\
84378847637c"],

Cell[CellGroupData[{

Cell["Bi-diagonalization", "Subsection",
 CellChangeTimes->{{3.8560223648675394`*^9, 3.8560223658669105`*^9}, {
  3.856022632014533*^9, 
  3.8560226470439425`*^9}},ExpressionUUID->"09577c0d-93d9-49f6-96dc-\
c15cacbee4ff"],

Cell["\<\
The plan is to use Householder operations on the left and right to rotate the \
matrix to an upper bi-diagonal form. I am going to call the right rotations U \
and the left rotations V.\
\>", "Text",
 CellChangeTimes->{{3.8560226522404585`*^9, 3.856022715308647*^9}, 
   3.856022770296147*^9, {3.8560229206539454`*^9, 
   3.856022944253423*^9}},ExpressionUUID->"17f15b01-df6a-414a-9f47-\
eb710cbac668"],

Cell[CellGroupData[{

Cell["Preliminary Script. ", "Subsubsection",
 CellChangeTimes->{{3.85602366972259*^9, 3.8560236761940546`*^9}, {
  3.856023794224439*^9, 
  3.8560237977971115`*^9}},ExpressionUUID->"ed190685-07bc-4d0f-9fcd-\
890aefbb3240"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"MatrixPlot", ",", 
    RowBox[{"ColorRules", "->", 
     RowBox[{"{", 
      RowBox[{"0", "->", "Green"}], "}"}]}], ",", " ", 
    RowBox[{"Mesh", "->", "All"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"10", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"A0", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"HouseMat", "[", 
    RowBox[{"A", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"1", ";;", "m"}], ",", "1"}], "\[RightDoubleBracket]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"1", ";;", "m"}], ",", 
     RowBox[{"1", ";;", "n"}]}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"U", ".", 
     RowBox[{"A", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"1", ";;", "m"}], ",", 
       RowBox[{"1", ";;", "n"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixPlot", "[", "A", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"HouseMat", "[", 
    RowBox[{"A", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", 
      RowBox[{"2", ";;", "n"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"1", ";;", "m"}], ",", 
     RowBox[{"2", ";;", "n"}]}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"A", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"1", ";;", "m"}], ",", 
       RowBox[{"2", ";;", "n"}]}], "\[RightDoubleBracket]"}], ".", "V"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixPlot", "[", "A", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"HouseMat", "[", 
    RowBox[{"A", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"2", ";;", "m"}], ",", "2"}], "\[RightDoubleBracket]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"2", ";;", "m"}], ",", 
     RowBox[{"2", ";;", "n"}]}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"U", ".", 
     RowBox[{"A", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"2", ";;", "m"}], ",", 
       RowBox[{"2", ";;", "n"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixPlot", "[", "A", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"HouseMat", "[", 
    RowBox[{"A", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", 
      RowBox[{"3", ";;", "n"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"2", ";;", "m"}], ",", 
     RowBox[{"3", ";;", "n"}]}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"A", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"2", ";;", "m"}], ",", 
       RowBox[{"3", ";;", "n"}]}], "\[RightDoubleBracket]"}], ".", "V"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixPlot", "[", "A", "]"}]}], "Input",
 CellChangeTimes->{{3.856022718376644*^9, 3.8560227569392376`*^9}, {
  3.856022946564886*^9, 3.8560229716655846`*^9}, {3.8560231168975515`*^9, 
  3.856023331970735*^9}, {3.8560233732152615`*^9, 3.856023549530466*^9}, {
  3.8560235959394617`*^9, 3.85602359613628*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"99d0c40b-55e3-4307-b888-72a03fe7013e"],

Cell[BoxData[
 GraphicsBox[{RasterBox[CompressedData["
1:eJx10G1MzAEcB/D/xi4ii6KOVYpdaTUPK9cD901aTakWp0uMLeqanjsuoyfS
s6eUivLUzjw3JWwcolCr7pLrico91On+D1fjsqxEXnjhxf227/Z99dl3P/uo
pB3RcwiCMJ3N3Nn87f/fOP61yrUvbCwukKjwNfASCQbJFebvJrz0qOCEx3Yd
YTCdYNKavJ7Efjfus4/2Knzfnsss6abhsWMhJ7b8K8YnQiLXqXtgzCdOzazJ
vSfDe6dt2gyHQfAv+gveX6CQM+3Pu2E3ACnvwZ3d+hG89G7n+pmQuFWTaJ/h
LIdVkbvVa8NnWHYQtZsbKaO+pPJ35OssPbTu5Vd32erR53snTyKgILbx9IwZ
6EPvNnrPqGEYZ3r9Xo2f0yHs5pW43Zk0hpXXXTgrtDBd7O2au+iDUX/kETvl
udko/AI8HLllFGrPFdXnRDFoGzisC56rB49+vKsviEbZJO/o1sta1HXEPbgk
oGE6bN3bvUSFoTZFiyg0zaifnWTg6b1oiAa9JWGzO7VVjXKFWSvOFse3Rm6Q
4VCVlJfsO4R400D9QSGFt4URb4KaKURUJ9TnMGqsJNghJZ71Rv1+Rx/7l0Xd
CJXtJWb4GqRURS9IsyTRP7S0sovL4P6Xnz75s/9byFYWX7cdQ2rA8fOuJAXW
NZtDrqUa+ISw0weEUqP+r/CzTjx1J4SvsqJ8zFRYPemgFMtIyH5IvDY9puA2
76TarkGFom/LMpwjj2NvScKJlMUMFDFuhtiro1i7J3+iePyTUb8za+P8dnkH
xkRJotsuXzAVw+le7keBdvWWhgYwcJEdLXh4Qgf+01RiX90QktrkY9pVXfA/
ED3VcFeFtzsb3YKqSaO+8NgmqaWtAl3CmNL0GjWca8TvBMEkZp4JFAIlg0Gu
lDQ0UQicro6WeYyAxRZtcaxlUCsxFwezKCRwWMqsIA2c7U7e/XCvE1HmEZ4N
LT34bLH6yfN8GnkLxEf4mXJ8is1f1pyphPsW69TBKRIFq+JOl7lrUS2qa+IX
kmjLdlmha6LhxG/IVjX3wJo1bNWs1+BRU/jDNI0OfwDjHoTq
    "], {{0, 0}, {4, 10}}, {0, 1}], {
    {GrayLevel[
      NCache[-1 + GoldenRatio, 0.6180339887498949]], 
     StyleBox[
      LineBox[{{{0, 10}, {4, 10}}, {{0, 9}, {4, 9}}, {{0, 8}, {4, 8}}, {{0, 
       7}, {4, 7}}, {{0, 6}, {4, 6}}, {{0, 5}, {4, 5}}, {{0, 4}, {4, 4}}, {{0,
        3}, {4, 3}}, {{0, 2}, {4, 2}}, {{0, 1}, {4, 1}}, {{0, 0}, {4, 0}}}],
      Antialiasing->False]}, 
    {GrayLevel[
      NCache[-1 + GoldenRatio, 0.6180339887498949]], 
     StyleBox[
      LineBox[{{{0, 0}, {0, 10}}, {{1, 0}, {1, 10}}, {{2, 0}, {2, 10}}, {{3, 
       0}, {3, 10}}, {{4, 0}, {4, 10}}}],
      Antialiasing->False]}}},
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{9.5, 
       FormBox["1", TraditionalForm]}, {8.5, 
       FormBox["2", TraditionalForm]}, {7.5, 
       FormBox["3", TraditionalForm]}, {6.5, 
       FormBox["4", TraditionalForm]}, {5.5, 
       FormBox["5", TraditionalForm]}, {4.5, 
       FormBox["6", TraditionalForm]}, {3.5, 
       FormBox["7", TraditionalForm]}, {2.5, 
       FormBox["8", TraditionalForm]}, {1.5, 
       FormBox["9", TraditionalForm]}, {0.5, 
       FormBox["10", TraditionalForm]}}, {{9.5, 
       FormBox["1", TraditionalForm]}, {8.5, 
       FormBox["2", TraditionalForm]}, {7.5, 
       FormBox["3", TraditionalForm]}, {6.5, 
       FormBox["4", TraditionalForm]}, {5.5, 
       FormBox["5", TraditionalForm]}, {4.5, 
       FormBox["6", TraditionalForm]}, {3.5, 
       FormBox["7", TraditionalForm]}, {2.5, 
       FormBox["8", TraditionalForm]}, {1.5, 
       FormBox["9", TraditionalForm]}, {0.5, 
       FormBox["10", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic, "DomainPadding" -> Scaled[0.02], "RangePadding" -> 
    Scaled[0.05]}]], "Output",
 CellChangeTimes->{
  3.856022749453368*^9, {3.8560231346647434`*^9, 3.8560231810239077`*^9}, {
   3.856023221040767*^9, 3.85602323400714*^9}, {3.8560232814262094`*^9, 
   3.856023285475075*^9}, 3.8560233184976215`*^9, {3.856023387821698*^9, 
   3.856023408150942*^9}, {3.85602345918882*^9, 3.856023471655169*^9}, 
   3.8560235503076005`*^9, 3.856023597798336*^9},
 CellLabel->
  "Out[143]=",ExpressionUUID->"4531ef22-1f6c-43ab-9b0f-28019641a1d2"],

Cell[BoxData[
 GraphicsBox[{RasterBox[CompressedData["
1:eJyFk3lIkwEYxjUtOzymWR6Zx6w8sLUujxSfUCEzO5SiloZldiFeq02yNLQ/
NEVSo6mtwwozTWeW2SGaBRpiiWdbXvltOt2+fV+tlZqgtv4wiBi98MDzPn/8
eF9eXqfohPATBnp6eku1MtTqt/+7vmLefTcxrhLHyJD05sA3Wj2O7wzbhA+d
JAaV5WeynSmwz3X65VLjmO039elyGcBNZiu+DKpgac354NIwhgX1GcLCFDF0
8ed7IsVStIPo+5NPhHUW7DceBbPsZ+JeQoH0HgcPs6MqvDi/lqvHHUNIzu1d
bD8SDH53zWYWpZNfVlw41XqZQEeYFc9QOobKgWHOVjaJptJpTpCvBKKHDU6L
H4yAlLRXWJQrwHBRc+lCFfy9RKMLc+QwqA35mNXSpZMf6iCrYHj0Ic76sZXb
sVFUHnD1j3yqgKAtyKR7ksJQzst31XYqvH1M1BU7yFF5b45VlEWiKL+sNn6c
gCO9WtOYmK6T35PjFqx/pxu9JWtsg2OkYJ4VSNyOKTGdtHxTbEAnQiz23t3v
R4DzLKKE/1qJNJslVsL7FEjT5m3cISXMjfuP98ikOvmyWdnS/n00zA99+mQX
R2Gq9ym3MluB7GSxkxGPhvrSKs77HxTGbLw5W2glWl2VoclmFBZFuVqxI4cx
E8De+aKeq5MfEmsYL39HwdBxZUfhKRKB9pFJV4NHcEbEutCXrMIN3pXGtm/D
iPVUOyvS+TCboY+sfEKCz/OUSG9JIaneoC4pr9DJb7UWOp6OpTGn6SBsFw7h
qL51Y9OaGAwID/tORalwKFCeu0swimWsGxunjdpRtFvDv36QhPvExXKLRO0e
BcaZe1JpnXxNYJt31jkKEzUbbPI9lBC8IqLXrSDg+aU0LCKcgnhS4B/3SIG0
k/F1qdmf4VM9Yeplr733dv/pBv4ImniDTINNzWhhnme6hbbD3DQ3wU47p/v6
mph7iSSaA8Li3uRR4AurMjOef0Ye3/PWNaOE//zLv/kvdW5mIA==
    "], {{0, 0}, {4, 10}}, {0, 1}], {
    {GrayLevel[
      NCache[-1 + GoldenRatio, 0.6180339887498949]], 
     StyleBox[
      LineBox[{{{0, 10}, {4, 10}}, {{0, 9}, {4, 9}}, {{0, 8}, {4, 8}}, {{0, 
       7}, {4, 7}}, {{0, 6}, {4, 6}}, {{0, 5}, {4, 5}}, {{0, 4}, {4, 4}}, {{0,
        3}, {4, 3}}, {{0, 2}, {4, 2}}, {{0, 1}, {4, 1}}, {{0, 0}, {4, 0}}}],
      Antialiasing->False]}, 
    {GrayLevel[
      NCache[-1 + GoldenRatio, 0.6180339887498949]], 
     StyleBox[
      LineBox[{{{0, 0}, {0, 10}}, {{1, 0}, {1, 10}}, {{2, 0}, {2, 10}}, {{3, 
       0}, {3, 10}}, {{4, 0}, {4, 10}}}],
      Antialiasing->False]}}},
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{9.5, 
       FormBox["1", TraditionalForm]}, {8.5, 
       FormBox["2", TraditionalForm]}, {7.5, 
       FormBox["3", TraditionalForm]}, {6.5, 
       FormBox["4", TraditionalForm]}, {5.5, 
       FormBox["5", TraditionalForm]}, {4.5, 
       FormBox["6", TraditionalForm]}, {3.5, 
       FormBox["7", TraditionalForm]}, {2.5, 
       FormBox["8", TraditionalForm]}, {1.5, 
       FormBox["9", TraditionalForm]}, {0.5, 
       FormBox["10", TraditionalForm]}}, {{9.5, 
       FormBox["1", TraditionalForm]}, {8.5, 
       FormBox["2", TraditionalForm]}, {7.5, 
       FormBox["3", TraditionalForm]}, {6.5, 
       FormBox["4", TraditionalForm]}, {5.5, 
       FormBox["5", TraditionalForm]}, {4.5, 
       FormBox["6", TraditionalForm]}, {3.5, 
       FormBox["7", TraditionalForm]}, {2.5, 
       FormBox["8", TraditionalForm]}, {1.5, 
       FormBox["9", TraditionalForm]}, {0.5, 
       FormBox["10", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic, "DomainPadding" -> Scaled[0.02], "RangePadding" -> 
    Scaled[0.05]}]], "Output",
 CellChangeTimes->{
  3.856022749453368*^9, {3.8560231346647434`*^9, 3.8560231810239077`*^9}, {
   3.856023221040767*^9, 3.85602323400714*^9}, {3.8560232814262094`*^9, 
   3.856023285475075*^9}, 3.8560233184976215`*^9, {3.856023387821698*^9, 
   3.856023408150942*^9}, {3.85602345918882*^9, 3.856023471655169*^9}, 
   3.8560235503076005`*^9, 3.8560235978666945`*^9},
 CellLabel->
  "Out[146]=",ExpressionUUID->"00067329-e066-4d05-bedf-302b3eff966a"],

Cell[BoxData[
 GraphicsBox[{RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDgAmIWIAaxUcEHewwhNHEP1qCq99Pf2DPNLU/l6n5mH2aZ
1THr2CX77BltVyxuvrF/OVnwd/eK5/YSb4SVOjWv2+MyB5f41Js1vEkyl+0n
NEU6h6s8sveevKaxs/SVvV/7hUOMPE/sL/3WiMgJeGlvyqWy6QvnG5LNn3H9
BhNr2EP7sgbrfNUTz+2PrNiVc1Xhtf2KzdPcul3f2BtdX9u7W+mpfUZNzMd3
VadINv+i31ftU1Fv7dkZ8/55nX5pz9Y7966ixAP77J3ZqvzT3tj/TioJOHXl
gf3qv0Zbsw6Wkmz+ov78v5Um1+wzT+2VF1nx2N6nY//qvz9f2q+4xfLaav5b
++Xtfskvz76yf2Wal35pxyOSzT8UGZN4JPudfeqMD4/OXnprv8xbdp7e5Ff2
Umxv9Xv3v7UvdV94qDPqvv336Xe8lTfnkGy+fewEl30fXtvf6pl6gqnyoX3L
pqRp7+9V2gcnzz6ye91re5O8clGLfqC7S8+EK95ZQbL5d7YHMcnKv7PXnL/F
TG3jG3vN1fk7Dy98bv9HNUzbVfylfWQaz0J/rTf296bdnLRt91uc5mvJN626
uPqCfZJAhOWWE9fsbwurbNvd/sZerPFX5ZmN1+3t1R5F7U16Yp+jyb6ped9L
++dH71w4ovDWPjLjjkjewxf2N2/fkVX9cdte56rsVvWoc/bZ57l7bj2+ax+W
WK61tPS1/fv1n69vKH9nn5/jIr/5zV17o2iuDfodyST7FwBPnBqa
    "], {{0, 0}, {4, 10}}, {0, 1}], {
    {GrayLevel[
      NCache[-1 + GoldenRatio, 0.6180339887498949]], 
     StyleBox[
      LineBox[{{{0, 10}, {4, 10}}, {{0, 9}, {4, 9}}, {{0, 8}, {4, 8}}, {{0, 
       7}, {4, 7}}, {{0, 6}, {4, 6}}, {{0, 5}, {4, 5}}, {{0, 4}, {4, 4}}, {{0,
        3}, {4, 3}}, {{0, 2}, {4, 2}}, {{0, 1}, {4, 1}}, {{0, 0}, {4, 0}}}],
      Antialiasing->False]}, 
    {GrayLevel[
      NCache[-1 + GoldenRatio, 0.6180339887498949]], 
     StyleBox[
      LineBox[{{{0, 0}, {0, 10}}, {{1, 0}, {1, 10}}, {{2, 0}, {2, 10}}, {{3, 
       0}, {3, 10}}, {{4, 0}, {4, 10}}}],
      Antialiasing->False]}}},
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{9.5, 
       FormBox["1", TraditionalForm]}, {8.5, 
       FormBox["2", TraditionalForm]}, {7.5, 
       FormBox["3", TraditionalForm]}, {6.5, 
       FormBox["4", TraditionalForm]}, {5.5, 
       FormBox["5", TraditionalForm]}, {4.5, 
       FormBox["6", TraditionalForm]}, {3.5, 
       FormBox["7", TraditionalForm]}, {2.5, 
       FormBox["8", TraditionalForm]}, {1.5, 
       FormBox["9", TraditionalForm]}, {0.5, 
       FormBox["10", TraditionalForm]}}, {{9.5, 
       FormBox["1", TraditionalForm]}, {8.5, 
       FormBox["2", TraditionalForm]}, {7.5, 
       FormBox["3", TraditionalForm]}, {6.5, 
       FormBox["4", TraditionalForm]}, {5.5, 
       FormBox["5", TraditionalForm]}, {4.5, 
       FormBox["6", TraditionalForm]}, {3.5, 
       FormBox["7", TraditionalForm]}, {2.5, 
       FormBox["8", TraditionalForm]}, {1.5, 
       FormBox["9", TraditionalForm]}, {0.5, 
       FormBox["10", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic, "DomainPadding" -> Scaled[0.02], "RangePadding" -> 
    Scaled[0.05]}]], "Output",
 CellChangeTimes->{
  3.856022749453368*^9, {3.8560231346647434`*^9, 3.8560231810239077`*^9}, {
   3.856023221040767*^9, 3.85602323400714*^9}, {3.8560232814262094`*^9, 
   3.856023285475075*^9}, 3.8560233184976215`*^9, {3.856023387821698*^9, 
   3.856023408150942*^9}, {3.85602345918882*^9, 3.856023471655169*^9}, 
   3.8560235503076005`*^9, 3.8560235979135923`*^9},
 CellLabel->
  "Out[149]=",ExpressionUUID->"6eedb7fc-00c0-4b20-ba70-20924ef36676"],

Cell[BoxData[
 GraphicsBox[{RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDgAmIWIAaxUcEHewwhNPGMW7JRiUue2DvZWOb0LntpLynS
xaRi+8a+Smgh4+S2N/byKblacvbP7BnKDsf/nX3RHpc5uMQ5Vt/wbtN9a/8y
/EC+meRLe/+FehO6L9+xv5N9Wj3n0GX7GQd6cueVPrLfuHLi0sXRr0g2vyBu
Wbzj5Tf23VNOWZT0Pbdfo5B3+sWha/bH91pevPLmrf31q7+bVD+/tv9rtUmg
d/NTks0/+rrmY7XvO/tQtqPZ8Qlv7fVr/ul3Zr60b7FZcr6k8419Z9IOV/+H
D+xz+CvjdwuWkWy+7RruhX1yb+wbLIPf21Q8sc95nT75uO1Re7OQu+tTNF/b
t3/4uPFb6Fv74h3KSady35Fs/veLhx8sT39rX/acX+Dl75f2h/LfaE6f9sC+
rK/y6JbO1/Y/0xSbYu8/tD+p4Cw+Mb+GZPNVGC2kfty/Zf/sk34H45Sn9tvP
6SydfPGlfaL74lULK97Z39O7u+rKq7v2WgsOuRrVJJNsfoo2Z0hU1EP7KTZK
VTNOPbfvmGEg4KX02r5iyVElvcfP7Q2WTdusWfPa/ppGYLFFyFuc5mvJN626
uPqCfZJAhOWWE9fsbwurbNvd/sZehot/Te2V1/aVRyy8w0we22uUmvKcnLwN
pzkX7+5VM0s9Zy9mtFhoysm79ouYDi2cVfnanvv3jVrt6rf2a5Zn66Q+um9/
bpmQeyRvAcn+BQCrEQqm
    "], {{0, 0}, {4, 10}}, {0, 1}], {
    {GrayLevel[
      NCache[-1 + GoldenRatio, 0.6180339887498949]], 
     StyleBox[
      LineBox[{{{0, 10}, {4, 10}}, {{0, 9}, {4, 9}}, {{0, 8}, {4, 8}}, {{0, 
       7}, {4, 7}}, {{0, 6}, {4, 6}}, {{0, 5}, {4, 5}}, {{0, 4}, {4, 4}}, {{0,
        3}, {4, 3}}, {{0, 2}, {4, 2}}, {{0, 1}, {4, 1}}, {{0, 0}, {4, 0}}}],
      Antialiasing->False]}, 
    {GrayLevel[
      NCache[-1 + GoldenRatio, 0.6180339887498949]], 
     StyleBox[
      LineBox[{{{0, 0}, {0, 10}}, {{1, 0}, {1, 10}}, {{2, 0}, {2, 10}}, {{3, 
       0}, {3, 10}}, {{4, 0}, {4, 10}}}],
      Antialiasing->False]}}},
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{9.5, 
       FormBox["1", TraditionalForm]}, {8.5, 
       FormBox["2", TraditionalForm]}, {7.5, 
       FormBox["3", TraditionalForm]}, {6.5, 
       FormBox["4", TraditionalForm]}, {5.5, 
       FormBox["5", TraditionalForm]}, {4.5, 
       FormBox["6", TraditionalForm]}, {3.5, 
       FormBox["7", TraditionalForm]}, {2.5, 
       FormBox["8", TraditionalForm]}, {1.5, 
       FormBox["9", TraditionalForm]}, {0.5, 
       FormBox["10", TraditionalForm]}}, {{9.5, 
       FormBox["1", TraditionalForm]}, {8.5, 
       FormBox["2", TraditionalForm]}, {7.5, 
       FormBox["3", TraditionalForm]}, {6.5, 
       FormBox["4", TraditionalForm]}, {5.5, 
       FormBox["5", TraditionalForm]}, {4.5, 
       FormBox["6", TraditionalForm]}, {3.5, 
       FormBox["7", TraditionalForm]}, {2.5, 
       FormBox["8", TraditionalForm]}, {1.5, 
       FormBox["9", TraditionalForm]}, {0.5, 
       FormBox["10", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic, "DomainPadding" -> Scaled[0.02], "RangePadding" -> 
    Scaled[0.05]}]], "Output",
 CellChangeTimes->{
  3.856022749453368*^9, {3.8560231346647434`*^9, 3.8560231810239077`*^9}, {
   3.856023221040767*^9, 3.85602323400714*^9}, {3.8560232814262094`*^9, 
   3.856023285475075*^9}, 3.8560233184976215`*^9, {3.856023387821698*^9, 
   3.856023408150942*^9}, {3.85602345918882*^9, 3.856023471655169*^9}, 
   3.8560235503076005`*^9, 3.856023597960559*^9},
 CellLabel->
  "Out[152]=",ExpressionUUID->"521f10f4-8106-4634-9715-98c8a69f3a36"]
}, Open  ]],

Cell["\<\
I guess we should check that the singular values are being preserved. \
\>", "Text",
 CellChangeTimes->{{3.8560237112219467`*^9, 
  3.8560237404519186`*^9}},ExpressionUUID->"b5ceb4b9-ffab-4cc2-9cec-\
75b5a8d66bc4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"Map", "[", 
   RowBox[{"SingularValueList", ",", 
    RowBox[{"{", 
     RowBox[{"A", ",", "A0"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8560236307907133`*^9, 3.856023654632496*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"a3c617e6-503a-4da7-b865-f8b8b061edfa"],

Cell[BoxData[
 TagBox[GridBox[{
    {"2.3270698924757878`", "1.7677697290502907`", "1.3150591276014518`", 
     "0.9279632153856436`"},
    {"2.3270698924757878`", "1.767769729050291`", "1.3150591276014518`", 
     "0.9279632153856434`"}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8560236407125196`*^9, 3.85602365522591*^9}},
 CellLabel->
  "Out[155]//TableForm=",ExpressionUUID->"7dcea839-c429-4fd5-b867-\
e51d943cc2d2"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Function", "Subsubsection",
 CellChangeTimes->{{3.85602366972259*^9, 3.8560236761940546`*^9}, {
  3.856023794224439*^9, 
  3.8560238114860764`*^9}},ExpressionUUID->"e193b742-c854-45ae-bbdb-\
0400ef3dce5f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GKBiDiagonalization", "[", "AIn_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "=", "AIn"}], ",", "m", ",", "n", ",", "U", ",", "V"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "AIn", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assuming", " ", "Tall", " ", "Skiinny", " ", Cell[
       "m\[GreaterEqual]n",ExpressionUUID->
        "00887bd8-549e-4321-b064-b6e3df00e799"]}], " ", "*)"}], " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"U", "=", 
         RowBox[{"HouseMat", "[", 
          RowBox[{"A", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"k", ";;", "m"}], ",", "k"}], "\[RightDoubleBracket]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"A", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"k", ";;", "m"}], ",", 
           RowBox[{"k", ";;", "n"}]}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"Chop", "[", 
          RowBox[{"U", ".", 
           RowBox[{"A", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"k", ";;", "m"}], ",", 
             RowBox[{"k", ";;", "n"}]}], "\[RightDoubleBracket]"}]}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"V", "=", 
         RowBox[{"HouseMat", "[", 
          RowBox[{"A", "\[LeftDoubleBracket]", 
           RowBox[{"k", ",", 
            RowBox[{
             RowBox[{"k", "+", "1"}], ";;", "n"}]}], 
           "\[RightDoubleBracket]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"A", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"k", ";;", "m"}], ",", 
           RowBox[{
            RowBox[{"k", "+", "1"}], ";;", "n"}]}], "\[RightDoubleBracket]"}],
          "=", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{"A", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"k", ";;", "m"}], ",", 
             RowBox[{
              RowBox[{"k", "+", "1"}], ";;", "n"}]}], 
            "\[RightDoubleBracket]"}], ".", "V"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", " ", "1", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Tidy", " ", "up", " ", "the", " ", "Last", " ", "Column"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"U", "=", 
      RowBox[{"HouseMat", "[", 
       RowBox[{"A", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"n", ";;", "m"}], ",", "n"}], "\[RightDoubleBracket]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"n", ";;", "m"}], ",", 
        RowBox[{"n", ";;", "n"}]}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Chop", "[", 
       RowBox[{"U", ".", 
        RowBox[{"A", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"n", ";;", "m"}], ",", 
          RowBox[{"n", ";;", "n"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "A"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.856023836340992*^9, 3.856024102778532*^9}, {
  3.8560241840242543`*^9, 3.8560242270881653`*^9}, {3.8560242674837465`*^9, 
  3.8560243990459876`*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"41b7b6f7-1fd6-46ec-a0ed-d5dc2d57fc0c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"GKBiDiagonalization", "[", "A", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"SingularValueList", ",", 
   RowBox[{"{", 
    RowBox[{"A", ",", "B"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixPlot", "[", "B", "]"}]}], "Input",
 CellChangeTimes->{{3.856024108183613*^9, 3.856024154135374*^9}, {
  3.856024235260422*^9, 3.856024242523739*^9}, {3.856024409284043*^9, 
  3.856024416969306*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"06628585-bf6c-4db4-a5cc-2f739586e0fc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.611980325847204`", ",", "1.7594803413791795`", ",", 
     "1.553614787091724`", ",", "1.035419143129081`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.6119803258472047`", ",", "1.7594803413791804`", ",", 
     "1.5536147870917254`", ",", "1.0354191431290811`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.856024155181755*^9, {3.8560241919917297`*^9, 3.8560242431640453`*^9}, {
   3.8560244027026663`*^9, 3.856024417437769*^9}},
 CellLabel->
  "Out[179]=",ExpressionUUID->"c23f249f-43cf-434a-9e6d-198520529e6c"],

Cell[BoxData[
 GraphicsBox[{RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDgAmIWIAaxUcEHewyhUfFRcTqIs/++MWnuwdf2q7a+f33q
4SP7iMRXU9UbN9rjUo9LXNHO935X4GV74WWnXsXYPbLf0JLw0C73lb3W6fp/
DlPf2l+K1j9ituKV/R9XXb8jYY9wmt8yvS1PouqdfY1bodSb53ftX/ks2diZ
mWzP4fh6ofjHx/Zqt/02mjq+tF/Ha6z/iuENAXd+sH9YJbLO/eEtuLg8s5zy
pjVv7F/OiRS88vSZPctmxp/rtK+Q7F8AU5536w==
    "], {{0, 0}, {4, 10}}, {0, 1}], {
    {GrayLevel[
      NCache[-1 + GoldenRatio, 0.6180339887498949]], 
     StyleBox[
      LineBox[{{{0, 10}, {4, 10}}, {{0, 9}, {4, 9}}, {{0, 8}, {4, 8}}, {{0, 
       7}, {4, 7}}, {{0, 6}, {4, 6}}, {{0, 5}, {4, 5}}, {{0, 4}, {4, 4}}, {{0,
        3}, {4, 3}}, {{0, 2}, {4, 2}}, {{0, 1}, {4, 1}}, {{0, 0}, {4, 0}}}],
      Antialiasing->False]}, 
    {GrayLevel[
      NCache[-1 + GoldenRatio, 0.6180339887498949]], 
     StyleBox[
      LineBox[{{{0, 0}, {0, 10}}, {{1, 0}, {1, 10}}, {{2, 0}, {2, 10}}, {{3, 
       0}, {3, 10}}, {{4, 0}, {4, 10}}}],
      Antialiasing->False]}}},
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{9.5, 
       FormBox["1", TraditionalForm]}, {8.5, 
       FormBox["2", TraditionalForm]}, {7.5, 
       FormBox["3", TraditionalForm]}, {6.5, 
       FormBox["4", TraditionalForm]}, {5.5, 
       FormBox["5", TraditionalForm]}, {4.5, 
       FormBox["6", TraditionalForm]}, {3.5, 
       FormBox["7", TraditionalForm]}, {2.5, 
       FormBox["8", TraditionalForm]}, {1.5, 
       FormBox["9", TraditionalForm]}, {0.5, 
       FormBox["10", TraditionalForm]}}, {{9.5, 
       FormBox["1", TraditionalForm]}, {8.5, 
       FormBox["2", TraditionalForm]}, {7.5, 
       FormBox["3", TraditionalForm]}, {6.5, 
       FormBox["4", TraditionalForm]}, {5.5, 
       FormBox["5", TraditionalForm]}, {4.5, 
       FormBox["6", TraditionalForm]}, {3.5, 
       FormBox["7", TraditionalForm]}, {2.5, 
       FormBox["8", TraditionalForm]}, {1.5, 
       FormBox["9", TraditionalForm]}, {0.5, 
       FormBox["10", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic, "DomainPadding" -> Scaled[0.02], "RangePadding" -> 
    Scaled[0.05]}]], "Output",
 CellChangeTimes->{
  3.856024155181755*^9, {3.8560241919917297`*^9, 3.8560242431640453`*^9}, {
   3.8560244027026663`*^9, 3.856024417484666*^9}},
 CellLabel->
  "Out[180]=",ExpressionUUID->"970abd5e-9e8b-4ca4-945e-a0d8fe9dc983"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["From Lecture 10: Householder Reflection Code", "Section",
 CellChangeTimes->{{3.847003158823649*^9, 3.84700316723106*^9}, {
  3.854895347801463*^9, 3.854895353811205*^9}, {3.85489594895142*^9, 
  3.8548959517167397`*^9}},ExpressionUUID->"421efc06-e2fc-4ce4-98cb-\
21f783702738"],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Householder Reflections\nMatrix Functions", "Section"],
 " "
}], "Subsection",
 CellChangeTimes->{{3.8468400908517523`*^9, 3.846840125313773*^9}, {
  3.846841365233275*^9, 3.8468413765615253`*^9}, {3.8469334869596004`*^9, 
  3.8469335254269605`*^9}, {3.8469372186478972`*^9, 
  3.84693725068496*^9}},ExpressionUUID->"dd950202-2e82-4ae8-aef0-\
5f46e29c3f46"],

Cell[TextData[{
 "If ",
 Cell[BoxData[
  FormBox["v", TraditionalForm]],ExpressionUUID->
  "32a42084-9412-433a-bbcc-e92100809222"],
 " is a unit vector parallel to \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"sign", "(", 
     RowBox[{"a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     ")"}], "||", "a", "||", 
    RowBox[{
     SubscriptBox["e", "1"], "+", "a"}]}], TraditionalForm]],ExpressionUUID->
  "b9a09fb7-baf2-481e-a612-d0fbfdec8e13"],
 "\nthen the orthogonal matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "=", 
    RowBox[{"I", "-", 
     RowBox[{"2", " ", 
      RowBox[{"v", "\[CircleTimes]", "v"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"ca81967e-f0d6-47e9-9c64-9d88b2bc9653"],
 " satisfies\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Q", ".", "a"}], "=", 
    RowBox[{"||", "a", "||", 
     SubscriptBox["e", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "3b5397fe-2381-44af-8ed5-83def8174fe8"],
 "\nIn other words, Q rotates the vector ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],ExpressionUUID->
  "e01efaf8-9e5e-4aa0-8ae1-5247ee2fe4d3"],
 " to align with the vector ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "1"], TraditionalForm]],ExpressionUUID->
  "70aabf9c-05ec-401b-921c-9f4f97291ac8"],
 ". "
}], "Text",
 CellChangeTimes->{{3.846932854787759*^9, 3.8469329103313017`*^9}, {
   3.8469333722095346`*^9, 3.846933456294175*^9}, {3.846933532225792*^9, 
   3.8469336109655237`*^9}, {3.846933662678347*^9, 3.84693387213366*^9}, {
   3.8469340875665607`*^9, 3.846934291563596*^9}, {3.8469350079034543`*^9, 
   3.8469350094851847`*^9}, 3.8469353408127766`*^9, {3.846936659235436*^9, 
   3.846936939960298*^9}},ExpressionUUID->"9d13eed6-1061-491d-9774-\
4166f0f7a76d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"HouseVec", "[", "a_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", "=", "a"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"v", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+=", 
      RowBox[{
       RowBox[{"Sign", "[", 
        RowBox[{"a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}], 
       RowBox[{"Norm", "[", "a", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v", "/", 
      RowBox[{"Norm", "[", "v", "]"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HouseMat", "[", "a_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"HouseVec", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", 
       RowBox[{"Length", "[", "a", "]"}], "]"}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"v", ",", "v"}], "]"}]}]}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8469370323032928`*^9, 3.8469371705899577`*^9}, {
  3.852652481943019*^9, 3.852652485802258*^9}, {3.852652528051162*^9, 
  3.8526525335935163`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"19577745-a245-4473-a316-31df2ceb31c9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "21"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"HouseMat", "[", "a", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"Q", ".", 
    RowBox[{"Q", "\[Transpose]"}]}], " ", "-", 
   RowBox[{"IdentityMatrix", "[", "m", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Chop", "[", 
  RowBox[{"Q", ".", "a"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8469344920592456`*^9, 3.846934549496911*^9}, {
  3.846934695265825*^9, 3.84693478417249*^9}, {3.8469348408859897`*^9, 
  3.8469348959831905`*^9}, {3.846935793743067*^9, 3.8469360029439135`*^9}, {
  3.84693604642768*^9, 3.846936076847455*^9}, {3.846936965909218*^9, 
  3.846937023968395*^9}, {3.8469371785953503`*^9, 3.8469372092136116`*^9}, {
  3.852645821644829*^9, 3.852645866066623*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"88b38800-3a38-4e03-91a9-876cf87d2da7"],

Cell[BoxData["4.46271937886974`*^-16"], "Output",
 CellChangeTimes->{{3.8469347456744127`*^9, 3.846934784853061*^9}, {
   3.8469348749702806`*^9, 3.846934897011094*^9}, {3.8469359227697563`*^9, 
   3.846936003979722*^9}, {3.846936047516919*^9, 3.8469360774412975`*^9}, 
   3.846936977602109*^9, {3.846937019399043*^9, 3.846937024637398*^9}, {
   3.846937199885892*^9, 3.8469372098126545`*^9}, {3.8526458084559917`*^9, 
   3.852645872849594*^9}, 3.8526526421536818`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"ce96da0f-28a3-468e-a7c9-54c30468267e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2.8822741099161453`", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.8469347456744127`*^9, 3.846934784853061*^9}, {
   3.8469348749702806`*^9, 3.846934897011094*^9}, {3.8469359227697563`*^9, 
   3.846936003979722*^9}, {3.846936047516919*^9, 3.8469360774412975`*^9}, 
   3.846936977602109*^9, {3.846937019399043*^9, 3.846937024637398*^9}, {
   3.846937199885892*^9, 3.8469372098126545`*^9}, {3.8526458084559917`*^9, 
   3.852645872849594*^9}, 3.8526526421693025`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"34be017a-6aec-4dfc-bfb8-4d177b646ca8"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Householder Reflections\nAction Functions", "Section"],
 " "
}], "Subsection",
 CellChangeTimes->{{3.8468400908517523`*^9, 3.846840125313773*^9}, {
  3.846841365233275*^9, 3.8468413765615253`*^9}, {3.8469334869596004`*^9, 
  3.8469335254269605`*^9}, {3.8469372186478972`*^9, 
  3.8469372557172794`*^9}},ExpressionUUID->"18ad0e62-b6df-45b6-9e23-\
f125196fead9"],

Cell["\<\
There is no need to build the Householder matrix.  All we need to be able to \
do is apply the matrix to a vector x. \
\>", "Text",
 CellChangeTimes->{{3.846932854787759*^9, 3.8469329103313017`*^9}, {
   3.8469333722095346`*^9, 3.846933456294175*^9}, {3.846933532225792*^9, 
   3.8469336109655237`*^9}, {3.846933662678347*^9, 3.84693387213366*^9}, {
   3.8469340875665607`*^9, 3.846934291563596*^9}, {3.8469350079034543`*^9, 
   3.8469350094851847`*^9}, 3.8469353408127766`*^9, {3.846936659235436*^9, 
   3.846936939960298*^9}, {3.846937265493534*^9, 3.846937331605727*^9}, {
   3.8469374675167007`*^9, 3.846937467905089*^9}, {3.846997349464962*^9, 
   3.8469973750898113`*^9}, 
   3.846997922783347*^9},ExpressionUUID->"f6beedb7-9bdc-4afd-999e-\
6ff919470272"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HouseActionVec", "[", 
   RowBox[{"x_", ",", "a_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"HouseVec", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "-", 
      RowBox[{"2", " ", "v", " ", 
       RowBox[{"(", 
        RowBox[{"v", ".", "x"}], ")"}]}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8469370323032928`*^9, 3.8469371705899577`*^9}, {
  3.846937334732747*^9, 3.846937390283722*^9}, {3.8469384128336287`*^9, 
  3.8469384133697815`*^9}, {3.846997913942161*^9, 3.8469979182321243`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"32374c18-ebea-473f-99be-a2e9f7d6c9fd"],

Cell["As always TEST!", "Text",
 CellChangeTimes->{{3.846997389733158*^9, 
  3.846997408281502*^9}},ExpressionUUID->"5a3c5877-b5cf-46ed-b681-\
1e1125579951"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "14"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", "a"}], "}"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"HouseMat", "[", "a", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Norm", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Q", ".", "x"}], "-", 
      RowBox[{"HouseActionVec", "[", 
       RowBox[{"x", ",", "a"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"Q", ".", "a"}], "-", " ", 
      RowBox[{"HouseActionVec", "[", 
       RowBox[{"a", ",", "a"}], "]"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8469344920592456`*^9, 3.846934549496911*^9}, {
  3.846934695265825*^9, 3.84693478417249*^9}, {3.8469348408859897`*^9, 
  3.8469348959831905`*^9}, {3.846935793743067*^9, 3.8469360029439135`*^9}, {
  3.84693604642768*^9, 3.846936076847455*^9}, {3.846936965909218*^9, 
  3.846937023968395*^9}, {3.8469371785953503`*^9, 3.8469372092136116`*^9}, {
  3.8469374172100105`*^9, 3.846937433066861*^9}, {3.846938419410689*^9, 
  3.8469384200015383`*^9}, {3.846997937325851*^9, 3.8469981314106503`*^9}, {
  3.852646072571396*^9, 3.8526460731410913`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"475fd3b0-a9d9-4280-a22c-039c3f30481e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.973993651728112`*^-16", ",", "1.1263846865310044`*^-15"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8469347456744127`*^9, 3.846934784853061*^9}, {
   3.8469348749702806`*^9, 3.846934897011094*^9}, {3.8469359227697563`*^9, 
   3.846936003979722*^9}, {3.846936047516919*^9, 3.8469360774412975`*^9}, 
   3.846936977602109*^9, {3.846937019399043*^9, 3.846937024637398*^9}, {
   3.846937199885892*^9, 3.8469372098126545`*^9}, 3.8469374351637125`*^9, 
   3.846938422336793*^9, 3.84699741276353*^9, 3.8469979316726837`*^9, {
   3.8469980111459827`*^9, 3.846998038280382*^9}, {3.846998071397077*^9, 
   3.846998131943534*^9}, {3.8526459979143314`*^9, 3.85264602375478*^9}, 
   3.852646075480006*^9, 3.852652734022664*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"f264da32-43c6-4982-8a03-0fec390605c9"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{1268, 965},
WindowMargins->{{1411, Automatic}, {-134, Automatic}},
TaggingRules-><|
 "PresenterSettings" -> <|"Dialogs" -> {}|>, "TryRealOnly" -> False|>,
Magnification:>1.5 Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->FrontEnd`FileName[{"PresenterTools"}, "Aqua.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"1521e3d3-3fad-4ea9-8207-4404d221c820"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 674, 11, 184, "Title",ExpressionUUID->"bb443c9e-1a1c-437e-b10c-400e63a30bb8"],
Cell[1257, 35, 1149, 22, 83, "Text",ExpressionUUID->"19c34891-b4a5-4bb2-9167-f8ac0b4049d9"],
Cell[CellGroupData[{
Cell[2431, 61, 416, 12, 97, "Section",ExpressionUUID->"06cf5ec8-bb59-4a7f-9f15-f3f30e200a76"],
Cell[2850, 75, 2958, 82, 217, "Text",ExpressionUUID->"15635c41-aea7-4a27-ad15-2fbcaa60db8d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5845, 162, 573, 16, 136, "Section",ExpressionUUID->"0d745080-ec3b-4020-ab6c-9383ecfd63fe"],
Cell[6421, 180, 4021, 125, 327, "Text",ExpressionUUID->"12212a60-6f8c-439f-a018-117a921cf05f"],
Cell[CellGroupData[{
Cell[10467, 309, 1845, 54, 269, "Input",ExpressionUUID->"0e917fcb-fdb2-48e8-91fb-b10a2105bf8e"],
Cell[12315, 365, 4789, 113, 371, "Output",ExpressionUUID->"30337a6b-c2c8-4147-a479-974a69c93376"]
}, Open  ]],
Cell[17119, 481, 415, 8, 83, "Text",ExpressionUUID->"e71a3980-88e2-4f34-bdc4-304647498636"],
Cell[17537, 491, 412, 8, 83, "Text",ExpressionUUID->"e36c77f7-ec42-4ce1-ab4a-84378847637c"],
Cell[CellGroupData[{
Cell[17974, 503, 221, 4, 72, "Subsection",ExpressionUUID->"09577c0d-93d9-49f6-96dc-c15cacbee4ff"],
Cell[18198, 509, 412, 8, 83, "Text",ExpressionUUID->"17f15b01-df6a-414a-9f47-eb710cbac668"],
Cell[CellGroupData[{
Cell[18635, 521, 223, 4, 57, "Subsubsection",ExpressionUUID->"ed190685-07bc-4d0f-9fcd-890aefbb3240"],
Cell[CellGroupData[{
Cell[18883, 529, 3972, 114, 460, "Input",ExpressionUUID->"99d0c40b-55e3-4307-b888-72a03fe7013e"],
Cell[22858, 645, 4154, 85, 691, "Output",ExpressionUUID->"4531ef22-1f6c-43ab-9b0f-28019641a1d2"],
Cell[27015, 732, 4099, 84, 691, "Output",ExpressionUUID->"00067329-e066-4d05-bedf-302b3eff966a"],
Cell[31117, 818, 3855, 80, 691, "Output",ExpressionUUID->"6eedb7fc-00c0-4b20-ba70-20924ef36676"],
Cell[34975, 900, 3821, 80, 691, "Output",ExpressionUUID->"521f10f4-8106-4634-9715-98c8a69f3a36"]
}, Open  ]],
Cell[38811, 983, 224, 5, 50, "Text",ExpressionUUID->"b5ceb4b9-ffab-4cc2-9cec-75b5a8d66bc4"],
Cell[CellGroupData[{
Cell[39060, 992, 335, 8, 60, "Input",ExpressionUUID->"a3c617e6-503a-4da7-b865-f8b8b061edfa"],
Cell[39398, 1002, 771, 20, 89, "Output",ExpressionUUID->"7dcea839-c429-4fd5-b867-e51d943cc2d2"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[40218, 1028, 211, 4, 46, "Subsubsection",ExpressionUUID->"e193b742-c854-45ae-bbdb-0400ef3dce5f"],
Cell[40432, 1034, 3652, 93, 411, "Input",ExpressionUUID->"41b7b6f7-1fd6-46ec-a0ed-d5dc2d57fc0c"],
Cell[CellGroupData[{
Cell[44109, 1131, 835, 23, 147, "Input",ExpressionUUID->"06628585-bf6c-4db4-a5cc-2f739586e0fc"],
Cell[44947, 1156, 607, 16, 66, "Output",ExpressionUUID->"c23f249f-43cf-434a-9e6d-198520529e6c"],
Cell[45557, 1174, 3135, 69, 691, "Output",ExpressionUUID->"970abd5e-9e8b-4ca4-945e-a0d8fe9dc983"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48765, 1251, 284, 4, 97, "Section",ExpressionUUID->"421efc06-e2fc-4ce4-98cb-21f783702738"],
Cell[CellGroupData[{
Cell[49074, 1259, 384, 8, 149, "Subsection",ExpressionUUID->"dd950202-2e82-4ae8-aef0-5f46e29c3f46"],
Cell[49461, 1269, 1749, 48, 184, "Text",ExpressionUUID->"9d13eed6-1061-491d-9774-4166f0f7a76d"],
Cell[51213, 1319, 1405, 35, 210, "Input",ExpressionUUID->"19577745-a245-4473-a316-31df2ceb31c9",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[52643, 1358, 1140, 27, 157, "Input",ExpressionUUID->"88b38800-3a38-4e03-91a9-876cf87d2da7"],
Cell[53786, 1387, 548, 7, 66, "Output",ExpressionUUID->"ce96da0f-28a3-468e-a7c9-54c30468267e"],
Cell[54337, 1396, 795, 13, 66, "Output",ExpressionUUID->"34be017a-6aec-4dfc-bfb8-4d177b646ca8"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[55181, 1415, 387, 8, 135, "Subsection",ExpressionUUID->"18ad0e62-b6df-45b6-9e23-f125196fead9"],
Cell[55571, 1425, 771, 13, 50, "Text",ExpressionUUID->"f6beedb7-9bdc-4afd-999e-6ff919470272"],
Cell[56345, 1440, 785, 18, 124, "Input",ExpressionUUID->"32374c18-ebea-473f-99be-a2e9f7d6c9fd",
 InitializationCell->True],
Cell[57133, 1460, 157, 3, 50, "Text",ExpressionUUID->"5a3c5877-b5cf-46ed-b681-1e1125579951"],
Cell[CellGroupData[{
Cell[57315, 1467, 1516, 37, 128, "Input",ExpressionUUID->"475fd3b0-a9d9-4280-a22c-039c3f30481e"],
Cell[58834, 1506, 836, 13, 70, "Output",ExpressionUUID->"f264da32-43c6-4982-8a03-0fec390605c9"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]]
}
]
*)

