(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    171856,       4206]
NotebookOptionsPosition[    160860,       4026]
NotebookOutlinePosition[    161474,       4047]
CellTagsIndexPosition[    161431,       4044]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["29: Shifted QR Algorithm", "Title",
 CellChangeTimes->CompressedData["
1:eJwd0U0og3EAx/HHSzwkBwcvNbE1Fxnl4OUgbVEWpzUlB0nIDl6a5X2yAzfy
TiOkEXkdDuJgLPNgQuQlb2HhmS02r6Xw//0Pvz633+UrLChXFHkyDBNBBmWe
MmZ7wiHduBj1gHrWlvZKrGxnM2Drb7y/i2ipGQqA9ixrtJs4Ib2jZo2PDr8R
O59nR2BgdaRIMOmQJr65qM2hyYvhxAoLR+16l9+rifPpFhuMuhzk9cRCP4Md
ynKMpgFiU/3POjSaa2OmiWxHaiy0Mi3qdaI4O0QD27pXTbDhiqMu9NTNnhD3
d/VzkLUerkGFvNIEl/j2W2h2P9qg91EVD+VBrXao2jwcOyXGR1+Mw0ZLqhkK
+uuol0nbW5DrLeOg+EV5BINnSo5hZorkHPq4OqhOgfYGPjwZqUrtjg3mfeU+
Qa1K54BJxS4n/f+QuOFBiIp6/dHzCYWSxC/4Xer1B/M1fV5nxLApnS9MEItY
uPfIxzqXHdLch/A4aODUve4V0kcT1wf/AQfGKcQ=
  
  "],ExpressionUUID->"bb443c9e-1a1c-437e-b10c-400e63a30bb8"],

Cell["\<\
This (with some bells and whistles) is what almost all dense eigenvalue \
algorithms are based on after a preliminary reduction to upper Hessenberg \
(tridiagonal for symmetric) form. We are going to look at the scheme first \
and then work out why it works.  \
\>", "Text",
 CellChangeTimes->{{3.8470540488466187`*^9, 3.847054299041844*^9}, 
   3.847054620646575*^9, {3.84705469788529*^9, 3.8470547053171043`*^9}, {
   3.84705474014857*^9, 3.847054741548669*^9}, {3.84705479048367*^9, 
   3.8470548010520067`*^9}, {3.847097256754077*^9, 3.8470972849056597`*^9}, {
   3.847140756236305*^9, 3.847140780380496*^9}, {3.847141112793906*^9, 
   3.847141123081209*^9}, {3.847141212815769*^9, 3.8471414441116858`*^9}, {
   3.847141743880835*^9, 3.847141771661133*^9}, {3.847142998261689*^9, 
   3.847143060799942*^9}, {3.8560901823257103`*^9, 
   3.856090323750142*^9}},ExpressionUUID->"19c34891-b4a5-4bb2-9167-\
f8ac0b4049d9"],

Cell["\<\
Real world versions of QR eigenvalue algorithms do more than one shift at a \
time and these shifts are implemented implicitly. \
\>", "Text",
 CellChangeTimes->{{3.856110790986891*^9, 
  3.856110899972933*^9}},ExpressionUUID->"e5d073cc-c203-49d2-a223-\
4a0ef6f9a86d"],

Cell[CellGroupData[{

Cell["Single Shift ", "Section",
 CellChangeTimes->{{3.856110529559176*^9, 3.8561105463836317`*^9}, {
  3.8561109022930593`*^9, 3.8561109063564777`*^9}, {3.8563538117943907`*^9, 
  3.8563538129006577`*^9}},ExpressionUUID->"4890d14d-99aa-4396-8fcb-\
090e056aa530"],

Cell[TextData[{
 "We implemented a single shift ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Mu]", "1"], TraditionalForm]],ExpressionUUID->
  "5bde8bda-dfb0-4d55-bc4d-cfd91bc4755e"],
 "as follows\n\t",
 Cell[BoxData[
  FormBox[GridBox[{
     {"H", "-", 
      RowBox[{
       SubscriptBox["\[Mu]", "1"], "I"}], "=", 
      RowBox[{
       SubscriptBox["Q", "1"], ".", 
       SubscriptBox["R", "1"]}], " ", " "},
     {" ", " ", 
      SubscriptBox["H", "1"], "=", 
      RowBox[{
       SubscriptBox["R", "1"], ".", 
       SubscriptBox["Q", "1"]}], "+", 
      RowBox[{
       SubscriptBox["\[Mu]", "1"], "I"}]}
    }], TraditionalForm]],ExpressionUUID->
  "650e69fa-6e6b-4ba6-946f-4145f8b08d78"]
}], "Text",
 CellChangeTimes->{{3.856120697680686*^9, 3.856120839266245*^9}, {
  3.85612663759713*^9, 3.856126638032977*^9}, {3.8563538220805097`*^9, 
  3.8563538512752457`*^9}},ExpressionUUID->"dee7c3f0-b248-4400-b1c8-\
73eb4cfe7e37"],

Cell[TextData[{
 "Remember this QR step does not change the eigen values since\n\t",
 Cell[BoxData[
  FormBox[GridBox[{
     {" ", 
      RowBox[{"H", "-", 
       RowBox[{
        SubscriptBox["\[Mu]", "1"], "I"}]}], "=", 
      RowBox[{
       SubscriptBox["Q", "1"], ".", 
       SubscriptBox["R", "1"]}]},
     {"\[DoubleLongRightArrow]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         SubscriptBox["Q", "1"], ")"}], "\[Transpose]"}], ".", 
       RowBox[{"(", 
        RowBox[{"H", "-", 
         RowBox[{
          SubscriptBox["\[Mu]", "1"], "I"}]}], ")"}]}], "=", 
      SubscriptBox["R", "1"]},
     {"\[DoubleLongRightArrow]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         SubscriptBox["Q", "1"], ")"}], "\[Transpose]"}], ".", 
       RowBox[{"(", 
        RowBox[{"H", "-", 
         RowBox[{
          SubscriptBox["\[Mu]", "1"], "I"}]}], ")"}], ".", 
       SubscriptBox["Q", "1"]}], "=", 
      RowBox[{
       SubscriptBox["R", "1"], ".", 
       SubscriptBox["Q", "1"]}]},
     {"\[DoubleLongRightArrow]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         SubscriptBox["Q", "1"], ")"}], "\[Transpose]"}], ".", 
       RowBox[{"(", 
        RowBox[{"H", "-", 
         RowBox[{
          SubscriptBox["\[Mu]", "1"], "I"}]}], ")"}], ".", 
       SubscriptBox["Q", "1"]}], "=", 
      RowBox[{
       SubscriptBox["H", "1"], "-", 
       RowBox[{
        SubscriptBox["\[Mu]", "1"], "I"}]}]}
    }], TraditionalForm]],ExpressionUUID->
  "4720a295-2e84-443f-a034-fc02029a1dca"],
 "\nIn words, the single shift QR algorithm implements an orthogonal \
similarity transformation of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"H", "-", 
    RowBox[{
     SubscriptBox["\[Mu]", "1"], "I"}]}], TraditionalForm]],ExpressionUUID->
  "a525a58c-4812-426e-b1a2-520446b72712"],
 ". This is the same as implementing the same similarity transformation \
(defined by ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Q", "1"], TraditionalForm]],ExpressionUUID->
  "cf0ba8ee-2eb8-4f00-ab05-996acfa00822"],
 ") on ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]],ExpressionUUID->
  "18a0c3e4-78f3-4e62-9aa9-759884332177"],
 "\n\t",
 Cell[BoxData[
  FormBox[GridBox[{
     {" ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         SubscriptBox["Q", "1"], ")"}], "\[Transpose]"}], ".", 
       RowBox[{"(", 
        RowBox[{"H", "-", 
         RowBox[{
          SubscriptBox["\[Mu]", "1"], "I"}]}], ")"}], ".", 
       SubscriptBox["Q", "1"]}], "=", 
      RowBox[{
       SubscriptBox["H", "1"], "-", 
       RowBox[{
        SubscriptBox["\[Mu]", "1"], "I"}]}]},
     {"\[DoubleLongRightArrow]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          SubscriptBox["Q", "1"], ")"}], "\[Transpose]"}], ".", "H", ".", 
        SubscriptBox["Q", "1"]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["\[Mu]", "1"], "(", 
          SubscriptBox["Q", "1"], ")"}], "\[Transpose]"}], ".", 
        SubscriptBox["Q", "1"]}]}], "=", 
      RowBox[{
       SubscriptBox["H", "1"], "-", 
       RowBox[{
        SubscriptBox["\[Mu]", "1"], "I"}]}]},
     {"\[DoubleLongRightArrow]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         SubscriptBox["Q", "1"], ")"}], "\[Transpose]"}], ".", "H", ".", 
       SubscriptBox["Q", "1"]}], "=", 
      SubscriptBox["H", "1"]}
    }], TraditionalForm]],ExpressionUUID->
  "0cdaea67-a44a-46d6-98de-bf3060121fd7"],
 "\nAll we really need is ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Q", "1"], TraditionalForm]],ExpressionUUID->
  "55cd9bdb-4b2f-408c-a9d2-042f05586ebb"],
 "! "
}], "Text",
 CellChangeTimes->{{3.856120697680686*^9, 3.85612093676943*^9}, {
   3.85612098604767*^9, 3.856121163030569*^9}, {3.856121286876671*^9, 
   3.8561212877067537`*^9}, {3.856121336956038*^9, 3.856121337307659*^9}, {
   3.856123940712668*^9, 3.856123944192892*^9}, {3.8561266472529087`*^9, 
   3.856126653260717*^9}, {3.856353875758554*^9, 3.856354213425935*^9}, {
   3.8563542632912006`*^9, 3.85635438531756*^9}, {3.8563552793955913`*^9, 
   3.8563553130548353`*^9}, 
   3.8565964929789267`*^9},ExpressionUUID->"3051b712-ce87-4332-823e-\
9db5365dc408"],

Cell[TextData[{
 "There are several ways to compute ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Q", "1"], TraditionalForm]],ExpressionUUID->
  "44b2b76e-0961-4148-8865-0af630ced162"],
 ". In exact arithmetic they must all be \"essentially\" the same since the \
QR decomposition is \"essentially\" unique.  Of course, we know some are more \
stable than others. Some are more work than others!"
}], "Text",
 CellChangeTimes->{{3.856120697680686*^9, 3.85612093676943*^9}, {
  3.85612098604767*^9, 3.856121163030569*^9}, {3.856121286876671*^9, 
  3.8561212877067537`*^9}, {3.856121336956038*^9, 3.856121337307659*^9}, {
  3.856123940712668*^9, 3.856123944192892*^9}, {3.8561266472529087`*^9, 
  3.856126653260717*^9}, {3.856353875758554*^9, 3.856354213425935*^9}, {
  3.8563542632912006`*^9, 3.85635438531756*^9}, {3.8563552793955913`*^9, 
  3.8563553130548353`*^9}},ExpressionUUID->"5528d7bd-a0da-442e-9f8e-\
bee0a9dada0e"],

Cell[TextData[{
 "For instance we can compute all of Q (using say a QR decomposition) before \
we start doing anything else or we could do the columns (and matching rows) \
with tiny Given\[CloseCurlyQuote]s rotations one at a time and accumulate Q.  \
This version can efficiently exploit T being tridiagonal.  It results in a \
sequence of tiny computations.  The common efficient implementation does not \
actually construct Q! It simply computes the first column of Q and then \
directly computes ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["H", "1"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "4871ea3c-7f3e-45bd-a5d4-d7a665d6b772"],
 " using a sequence of tiny orthogonal matrices place to restore a Hessenberg \
matrix with a bulge to Hessenberg form.  This implicit Hessenberg process \
gives the same result as the explicit computation by the \
\[OpenCurlyDoubleQuote]Unique Q\[CloseCurlyDoubleQuote] theorem."
}], "Text",
 CellChangeTimes->{{3.8563544155037346`*^9, 3.8563552520547857`*^9}, {
  3.856355324619265*^9, 3.8563553310511475`*^9}, {3.856355515272947*^9, 
  3.856355554682805*^9}, {3.8565376269520473`*^9, 3.8565380245941615`*^9}, {
  3.8565381293373175`*^9, 3.8565381750271993`*^9}, {3.856538221714196*^9, 
  3.8565385109321184`*^9}, {3.856596535424212*^9, 3.8565970344521313`*^9}, {
  3.8565971222298517`*^9, 
  3.8565971841250134`*^9}},ExpressionUUID->"b58740e6-d141-4144-b0f6-\
5b04ee3308a5"],

Cell["\<\
The implicit computation is called an implicit shift and it is much less work \
when we try to do two (or more) shifts at the same time.   \
\>", "Text",
 CellChangeTimes->{{3.8563544155037346`*^9, 3.8563552520547857`*^9}, {
  3.856355324619265*^9, 3.8563553310511475`*^9}, {3.856355515272947*^9, 
  3.856355554682805*^9}, {3.8565376269520473`*^9, 3.8565380245941615`*^9}, {
  3.8565381293373175`*^9, 3.8565381750271993`*^9}, {3.856538221714196*^9, 
  3.8565385109321184`*^9}, {3.856596535424212*^9, 3.856596557063097*^9}, {
  3.856597037214513*^9, 3.856597109877475*^9}, {3.856597190173872*^9, 
  3.8565972095107613`*^9}},ExpressionUUID->"a06a96a1-5ab2-42b7-8214-\
488f3b03a830"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Double Shift ", "Section",
 CellChangeTimes->{{3.856110529559176*^9, 3.8561105463836317`*^9}, {
  3.8561109022930593`*^9, 
  3.8561109063564777`*^9}},ExpressionUUID->"eb071cf8-a99e-49e1-a188-\
114a69fd84e7"],

Cell[TextData[{
 "Double shifts are vitally important for real but non-symmetric matrices \
because of the complex eigenvalue pairs.  A single real shift can not \
approximate a complex conjugate eigen pair!  To work out how to do this we \
need to manually work through two steps of QR to see what is actually \
happening\n\t",
 Cell[BoxData[
  FormBox[GridBox[{
     {"H", "-", 
      RowBox[{
       SubscriptBox["\[Mu]", "1"], "I"}], "=", 
      RowBox[{
       SubscriptBox["Q", "1"], ".", 
       SubscriptBox["R", "1"]}], " ", " "},
     {" ", " ", 
      SubscriptBox["H", "1"], "=", 
      RowBox[{
       SubscriptBox["R", "1"], ".", 
       SubscriptBox["Q", "1"]}], "+", 
      RowBox[{
       SubscriptBox["\[Mu]", "1"], "I"}]},
     {
      SubscriptBox["H", "1"], "-", 
      RowBox[{
       SubscriptBox["\[Mu]", "2"], "I"}], "=", 
      RowBox[{
       SubscriptBox["Q", "2"], ".", 
       SubscriptBox["R", "2"]}], " ", " "},
     {" ", " ", 
      SubscriptBox["H", "2"], "=", 
      RowBox[{
       SubscriptBox["R", "2"], ".", 
       SubscriptBox["Q", "2"]}], "+", 
      RowBox[{
       SubscriptBox["\[Mu]", "2"], "I"}]}
    }], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "185105c3-6c1c-456c-8507-6b3dbe06d873"]
}], "Text",
 CellChangeTimes->{{3.856120697680686*^9, 3.856120839266245*^9}, {
  3.85612663759713*^9, 
  3.856126638032977*^9}},ExpressionUUID->"77683d59-441a-4191-bcc8-\
726d69681fec"],

Cell[TextData[{
 "Remember each QR step does not change the eigen values since\n\t",
 Cell[BoxData[
  FormBox[GridBox[{
     {" ", 
      RowBox[{"H", "-", 
       RowBox[{
        SubscriptBox["\[Mu]", "1"], "I"}]}], "=", 
      RowBox[{
       SubscriptBox["Q", "1"], ".", 
       SubscriptBox["R", "1"]}]},
     {"\[DoubleLongRightArrow]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         SubscriptBox["Q", "1"], ")"}], "\[Transpose]"}], ".", 
       RowBox[{"(", 
        RowBox[{"H", "-", 
         RowBox[{
          SubscriptBox["\[Mu]", "1"], "I"}]}], ")"}]}], "=", 
      SubscriptBox["R", "1"]},
     {"\[DoubleLongRightArrow]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         SubscriptBox["Q", "1"], ")"}], "\[Transpose]"}], ".", 
       RowBox[{"(", 
        RowBox[{"H", "-", 
         RowBox[{
          SubscriptBox["\[Mu]", "1"], "I"}]}], ")"}], ".", 
       SubscriptBox["Q", "1"]}], "=", 
      RowBox[{
       SubscriptBox["R", "1"], ".", 
       SubscriptBox["Q", "1"]}]},
     {"\[DoubleLongRightArrow]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         SubscriptBox["Q", "1"], ")"}], "\[Transpose]"}], ".", 
       RowBox[{"(", 
        RowBox[{"H", "-", 
         RowBox[{
          SubscriptBox["\[Mu]", "1"], "I"}]}], ")"}], ".", 
       SubscriptBox["Q", "1"]}], "=", 
      RowBox[{
       SubscriptBox["H", "1"], "-", 
       RowBox[{
        SubscriptBox["\[Mu]", "1"], "I"}]}]}
    }], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "7e959b89-37cb-4fe8-8374-05134d977cf5"],
 "\nand for the same reasons\n\t",
 Cell[BoxData[
  FormBox[GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         SubscriptBox["Q", "2"], ")"}], "\[Transpose]"}], ".", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["H", "1"], "-", 
         RowBox[{
          SubscriptBox["\[Mu]", "2"], "I"}]}], ")"}], ".", 
       SubscriptBox["Q", "2"]}], "=", 
      RowBox[{
       SubscriptBox["H", "2"], "-", 
       RowBox[{
        SubscriptBox["\[Mu]", "2"], "I"}]}]}
    }], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "02eae8c7-38fd-49fe-8c19-13b763a23a34"],
 "."
}], "Text",
 CellChangeTimes->{{3.856120697680686*^9, 3.85612093676943*^9}, {
  3.85612098604767*^9, 3.856121163030569*^9}, {3.856121286876671*^9, 
  3.8561212877067537`*^9}, {3.856121336956038*^9, 3.856121337307659*^9}, {
  3.856123940712668*^9, 3.856123944192892*^9}, {3.8561266472529087`*^9, 
  3.856126653260717*^9}},ExpressionUUID->"b7e077d8-049d-464c-9307-\
c73bc039f223"],

Cell[TextData[{
 "The question is what does this look like if we try to combine the two \
steps. One way to think about this would be to look at the combined \
orthogonal matrices ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "=", 
    RowBox[{
     SubscriptBox["Q", "1"], ".", 
     SubscriptBox["Q", "2"]}]}], TraditionalForm]],ExpressionUUID->
  "c9c59a6b-094e-4f0f-bffe-70bf7ff3eb9e"],
 " (still orthogonal) and the combined upper triangular matrices ",
 Cell[BoxData[
  FormBox[
   RowBox[{"R", "=", 
    RowBox[{
     SubscriptBox["R", "2"], ".", 
     SubscriptBox["R", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "87d7786d-96e4-4c6f-98a0-6267067a9bc5"],
 "(still upper triangular)   \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Q", ".", "R"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["Q", "1"], ".", 
       SubscriptBox["Q", "2"]}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["R", "2"], ".", 
       SubscriptBox["R", "1"]}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "e7f81724-1137-4f48-b55e-7bf48298802e"],
 "\nA direct computation gives \n\t",
 Cell[BoxData[
  FormBox[GridBox[{
     {" ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["Q", "1"], ".", 
         SubscriptBox["Q", "2"]}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["R", "2"], ".", 
         SubscriptBox["R", "1"]}], ")"}]}], "=", 
      RowBox[{
       SubscriptBox["Q", "1"], ".", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["Q", "2"], ".", 
         SubscriptBox["R", "2"]}], ")"}], ".", 
       SubscriptBox["R", "1"]}]},
     {"\[DoubleLongRightArrow]", " ", "=", 
      RowBox[{
       SubscriptBox["Q", "1"], ".", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["H", "1"], "-", 
         RowBox[{
          SubscriptBox["\[Mu]", "2"], "I"}]}], ")"}], ".", 
       SubscriptBox["R", "1"]}]},
     {"\[DoubleLongRightArrow]", " ", "=", 
      RowBox[{
       SubscriptBox["Q", "1"], ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", GridBox[{
            {
             RowBox[{
              SubscriptBox["R", "1"], ".", 
              SubscriptBox["Q", "1"]}], "+", 
             RowBox[{
              SubscriptBox["\[Mu]", "1"], "I"}]}
           }], ")"}], "-", 
         RowBox[{
          SubscriptBox["\[Mu]", "2"], "I"}]}], ")"}], ".", 
       SubscriptBox["R", "1"]}]},
     {"\[DoubleLongRightArrow]", " ", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["Q", "1"], ".", 
          SubscriptBox["R", "1"], ".", 
          SubscriptBox["Q", "1"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[Mu]", "1"], "-", 
            SubscriptBox["\[Mu]", "2"]}], ")"}], 
          SubscriptBox["Q", "1"]}]}], ")"}], ".", 
       SubscriptBox["R", "1"]}]},
     {"\[DoubleLongRightArrow]", " ", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["Q", "1"], ".", 
          SubscriptBox["R", "1"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[Mu]", "1"], "-", 
            SubscriptBox["\[Mu]", "2"]}], ")"}], "I"}]}], ")"}], ".", 
       SubscriptBox["Q", "1"], ".", 
       SubscriptBox["R", "1"]}]},
     {"\[DoubleLongRightArrow]", " ", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"H", "-", 
           RowBox[{
            SubscriptBox["\[Mu]", "1"], "I"}]}], ")"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[Mu]", "1"], "-", 
            SubscriptBox["\[Mu]", "2"]}], ")"}], "I"}]}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"H", "-", 
         RowBox[{
          SubscriptBox["\[Mu]", "1"], "I"}]}], ")"}]}]},
     {"\[DoubleLongRightArrow]", " ", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"H", "-", 
         RowBox[{
          SubscriptBox["\[Mu]", "2"], "I"}]}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"H", "-", 
         RowBox[{
          SubscriptBox["\[Mu]", "1"], "I"}]}], ")"}]}]}
    }], TraditionalForm]],ExpressionUUID->
  "0d5ae332-27d2-4c99-bfde-222cc71eadec"],
 "\nIn words, the effect of the double step with the two shifts is described \
by the matrix quadratic\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"H", "-", 
      RowBox[{
       SubscriptBox["\[Mu]", "2"], "I"}]}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{"H", "-", 
      RowBox[{
       SubscriptBox["\[Mu]", "1"], "I"}]}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"6c699219-2e27-412a-bc9d-475fc6d9304c"],
 "\nwhich is real if ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Mu]", "1"], TraditionalForm]],ExpressionUUID->
  "4259514c-ac42-4463-acdd-bdd748842163"],
 " are the roots of a real polynomial or eigenvalues of a real matrix!  It \
should be possible to do the double step in real arithmetic if ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Mu]", "1"], TraditionalForm]],ExpressionUUID->
  "7d235d17-a264-4e5f-8ae5-f3695b609818"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Mu]", "2"], TraditionalForm]],ExpressionUUID->
  "dd9cbf19-7c1b-46c0-8424-441914403896"],
 " are real (no surprise there) or a complex conjugate pair!   "
}], "Text",
 CellChangeTimes->{{3.8561239560750523`*^9, 3.8561241614999933`*^9}, {
  3.856124232350006*^9, 3.856124424710178*^9}, {3.856124501002227*^9, 
  3.856124533974845*^9}, {3.8561245812147503`*^9, 3.856125095436062*^9}, {
  3.856125138445517*^9, 3.8561252363074617`*^9}, {3.856126155775022*^9, 
  3.856126176558135*^9}, {3.856126668284287*^9, 
  3.856126706382245*^9}},ExpressionUUID->"1f1fbf69-cecb-44d0-841f-\
a8938693c357"],

Cell[TextData[{
 "We could build the matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"H", "-", 
      RowBox[{
       SubscriptBox["\[Mu]", "2"], "I"}]}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{"H", "-", 
      RowBox[{
       SubscriptBox["\[Mu]", "1"], "I"}]}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"9ce44cef-436d-44da-af5a-74b683e3b744"],
 ", compute a ",
 Cell[BoxData[
  FormBox["QR", TraditionalForm]],ExpressionUUID->
  "4cfd90fb-046b-42fe-88cf-d0338ac1f0ba"],
 " decomposition of it and reverse the order but we do not need to.  The \
implicit Q theorem says that although there are many different Hessenberg \
reductions of a matrix A ones with the same first column are the same if we \
make sure we have positive subdiagonals. So the first column of Q and the \
input H determines the new Hessenberg form.   "
}], "Text",
 CellChangeTimes->{{3.8561261334026747`*^9, 3.856126251976789*^9}, {
  3.856126305714698*^9, 3.856126403161983*^9}, {3.856126449841186*^9, 
  3.856126573137311*^9}, {3.856126711612483*^9, 3.856126714794366*^9}, {
  3.856597243726243*^9, 
  3.856597446948619*^9}},ExpressionUUID->"1138fce6-7cc2-445e-baf5-\
560951afc884"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implicit Shifts", "Section",
 CellChangeTimes->{{3.856110552839574*^9, 
  3.856110559024342*^9}},ExpressionUUID->"e6509389-10bd-4603-851c-\
51b8332c938a"],

Cell[CellGroupData[{

Cell["M trick", "Subsection",
 CellChangeTimes->{{3.856348860312004*^9, 
  3.85634886193783*^9}},ExpressionUUID->"cc385a15-324d-465e-8fa0-\
cc44b0477e11"],

Cell[TextData[{
 "The first column of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"H", "-", 
       RowBox[{
        SubscriptBox["\[Mu]", "2"], "I"}]}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"H", "-", 
       RowBox[{
        SubscriptBox["\[Mu]", "1"], "I"}]}], ")"}]}], "=", 
    RowBox[{
     SuperscriptBox["H", "2"], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Mu]", "1"], "+", 
        SubscriptBox["\[Mu]", "2"]}], ")"}], "H"}], "+", 
     RowBox[{
      SubscriptBox["\[Mu]", "1"], 
      SubscriptBox["\[Mu]", "2"], "I"}]}]}], TraditionalForm]],ExpressionUUID->
  "0d87df21-5851-4e66-9fcf-3fac0e10c5f5"],
 " is simply ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"H", "-", 
       RowBox[{
        SubscriptBox["\[Mu]", "2"], "I"}]}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"H", "-", 
       RowBox[{
        SubscriptBox["\[Mu]", "1"], "I"}]}], ")"}], ".", 
     SubscriptBox["e", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "b04d8fd2-03f0-43d7-b990-a4b1f41bfc46"],
 ".  Since H is Upper Hessenberg ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "add1242f-0745-4a2f-bac3-2a897ec6c47e"],
 " has three non-zero entries at the top. A direct computation gives\n\t",
 Cell[BoxData[
  FormBox[GridBox[{
     {
      SubscriptBox["m", "1"], "=", 
      RowBox[{
       SubscriptBox["H", 
        RowBox[{"1", ",", "1"}]], 
       SubscriptBox["H", 
        RowBox[{"1", ",", "1"}]]}], "+", 
      RowBox[{
       SubscriptBox["H", 
        RowBox[{"1", ",", "2"}]], 
       SubscriptBox["H", 
        RowBox[{"2", ",", "1"}]]}], "-", 
      RowBox[{"s", " ", 
       SubscriptBox["H", 
        RowBox[{"1", ",", "1"}]]}], "+", "t"},
     {
      SubscriptBox["m", "2"], "=", 
      RowBox[{
       SubscriptBox["H", 
        RowBox[{"2", ",", "1"}]], 
       SubscriptBox["H", 
        RowBox[{"1", ",", "1"}]]}], "+", 
      RowBox[{
       SubscriptBox["H", 
        RowBox[{"2", ",", "2"}]], 
       SubscriptBox["H", 
        RowBox[{"2", ",", "1"}]]}], "-", 
      RowBox[{"s", " ", 
       SubscriptBox["H", 
        RowBox[{"2", ",", "1"}]]}], " ", " "},
     {
      SubscriptBox["m", "3"], "=", 
      RowBox[{
       SubscriptBox["H", 
        RowBox[{"3", ",", "2"}]], 
       SubscriptBox["H", 
        RowBox[{"2", ",", "1"}]]}], " ", " ", " ", " ", " ", " "}
    }], TraditionalForm]],ExpressionUUID->
  "ceb7caac-be57-42a9-9a36-f3335484dc6a"],
 "    \nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "=", 
    RowBox[{
     SubscriptBox["\[Mu]", "1"], "+", 
     SubscriptBox["\[Mu]", "2"]}]}], TraditionalForm]],ExpressionUUID->
  "f6d833bd-b057-4b9d-a4b0-a3883009d4e9"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", "=", 
    RowBox[{
     SubscriptBox["\[Mu]", "1"], 
     SubscriptBox["\[Mu]", "2"]}]}], TraditionalForm]],ExpressionUUID->
  "72d1320c-30d4-4b74-ac7e-288818f5dafd"],
 " are real.  "
}], "Text",
 CellChangeTimes->{{3.856126606689431*^9, 3.8561266312647333`*^9}, {
  3.856126729753373*^9, 3.8561267684757633`*^9}, {3.856126800994335*^9, 
  3.8561272921232433`*^9}, {3.8561273338406973`*^9, 3.856127334769258*^9}, {
  3.856128301900928*^9, 3.856128467287406*^9}, {3.85612871283785*^9, 
  3.856128738437962*^9}},ExpressionUUID->"fa24239b-f428-49be-9a75-\
82a41cc7b7b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Shift Trick", "Subsection",
 CellChangeTimes->{{3.85634887057251*^9, 
  3.8563488739303417`*^9}},ExpressionUUID->"579dadd3-fed7-4eba-8a1f-\
9f81ee8a5ee1"],

Cell[TextData[{
 "As an added bonus if we are using shifts ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Mu]", "1"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "862af0ed-76bb-4ad9-9dff-e74f84839cf9"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Mu]", "2"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b6fc258e-fbec-4584-905e-b81748a56e42"],
 " which are eigenvalues of a 2\[Times]2 matrix \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"S", "=", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["S", 
         RowBox[{"1", ",", "1"}]], 
        SubscriptBox["S", 
         RowBox[{"1", ",", "2"}]]},
       {
        SubscriptBox["S", 
         RowBox[{"2", ",", "1"}]], 
        SubscriptBox["S", 
         RowBox[{"2", ",", "2"}]]}
      }], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "67741b58-bdff-4e06-8c0c-9b47a1e4741d"],
 "\nwe do not need to compute eigenvalues since \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "1"], 
      SubscriptBox["\[Mu]", "2"]}], "=", 
     RowBox[{
      RowBox[{"Det", "(", "S", ")"}], "=", 
      RowBox[{
       RowBox[{
        SubscriptBox["S", 
         RowBox[{"1", ",", "1"}]], 
        SubscriptBox["S", 
         RowBox[{"2", ",", "2"}]]}], "-", 
       RowBox[{
        SubscriptBox["S", 
         RowBox[{"1", ",", "2"}]], 
        SubscriptBox["S", 
         RowBox[{"2", ",", "1"}]]}]}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "3d1667fd-a994-4578-8139-f3142428e687"],
 "\nand\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "1"], "+", 
      SubscriptBox["\[Mu]", "2"]}], "=", 
     RowBox[{
      RowBox[{"tr", "(", "S", ")"}], "=", 
      RowBox[{
       SubscriptBox["S", 
        RowBox[{"1", ",", "1"}]], "+", 
       SubscriptBox["S", 
        RowBox[{"2", ",", "2"}]]}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "3551d9e8-9f29-4af7-ab70-00ea4dafd561"],
 ". "
}], "Text",
 CellChangeTimes->{{3.856126606689431*^9, 3.8561266312647333`*^9}, {
  3.856126729753373*^9, 3.8561267684757633`*^9}, {3.856126800994335*^9, 
  3.8561272921232433`*^9}, {3.8561273338406973`*^9, 3.856127334769258*^9}, {
  3.856128301900928*^9, 
  3.856128632370768*^9}},ExpressionUUID->"dccabaef-6194-4639-a9de-\
27eb21acbcc7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implicit Trick", "Subsection",
 CellChangeTimes->{{3.856348883650631*^9, 
  3.85634889278433*^9}},ExpressionUUID->"e5b75195-bb18-44e1-be71-\
90134d5abfd4"],

Cell["We could: ", "Text",
 CellChangeTimes->{{3.8563488955374813`*^9, 3.856348910166597*^9}, {
   3.8563498810736113`*^9, 3.856349906469941*^9}, 
   3.8566068454963856`*^9},ExpressionUUID->"c11979ce-1cdd-48a4-a060-\
018a092a6c90"],

Cell[CellGroupData[{

Cell[TextData[{
 "Form ",
 Cell[BoxData[
  FormBox[
   RowBox[{"M", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"H", "-", 
       RowBox[{
        SubscriptBox["\[Mu]", "2"], "I"}]}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"H", "-", 
       RowBox[{
        SubscriptBox["\[Mu]", "1"], "I"}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"851fcdc6-3d4e-45ac-a0fb-034d8aec0c48"]
}], "Item",
 CellChangeTimes->{{3.856349915042594*^9, 3.8563499223401546`*^9}, {
  3.8566068551072598`*^9, 
  3.856606855546418*^9}},ExpressionUUID->"32f66f4c-ecb2-4bb4-ab1c-\
e1350f75e1b4"],

Cell[TextData[{
 "Compute the QR decomposition of ",
 Cell[BoxData[
  FormBox["M", TraditionalForm]],ExpressionUUID->
  "ae9d19e8-0f96-4a82-9e3c-ea9751e06fd1"]
}], "Item",
 CellChangeTimes->{{3.856349915042594*^9, 
  3.8563499510521607`*^9}},ExpressionUUID->"18c3ab73-fe2b-49a9-b097-\
532d51b52027"],

Cell[TextData[{
 "Flip the order to get ",
 Cell[BoxData[
  FormBox[
   RowBox[{"R", ".", "Q"}], TraditionalForm]],ExpressionUUID->
  "a1370565-9d34-43df-83d9-bf2930c7b31c"]
}], "Item",
 CellChangeTimes->{{3.856349915042594*^9, 3.8563499927348413`*^9}, {
  3.856350040213933*^9, 3.856350046820106*^9}, {3.8566068720334735`*^9, 
  3.8566068754377327`*^9}},ExpressionUUID->"f8bab608-d34c-463b-bd65-\
572bb84894a5"]
}, Open  ]],

Cell["\<\
The cool thing is that we do not need to:  there is a much faster way!\
\>", "Text",
 CellChangeTimes->{{3.856606881331049*^9, 
  3.856606942143786*^9}},ExpressionUUID->"1e4dc1a3-64bd-4df7-b983-\
a784e319d17a"],

Cell[TextData[{
 "All we really want out of the shifts etc is the orthogonal matrix ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],ExpressionUUID->
  "08cb4806-1c59-4490-b1a1-2899ba07c520"],
 ": We do not care about M or R.  Even better all we really want to do with ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],ExpressionUUID->
  "2fd9b080-83b3-41dd-a569-46c7ae64b385"],
 " is form the Hessenberg decomposition (similarity transformation) ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", ".", "H", ".", 
    RowBox[{"Q", "\[Transpose]"}]}], TraditionalForm]],ExpressionUUID->
  "5850401b-0c21-4c17-882e-9bcd99f49897"],
 ".  The Implicit Q theorem says everything we want is determined by the \
first column of Q! "
}], "Text",
 CellChangeTimes->{{3.8563500788859425`*^9, 3.856350157376051*^9}, {
  3.8563501968697753`*^9, 3.8563502925295253`*^9}, {3.8566066489395576`*^9, 
  3.8566067043578835`*^9}, {3.856606752260309*^9, 
  3.8566068386087484`*^9}},ExpressionUUID->"922f240e-aff2-4553-980f-\
b4c311574382"],

Cell["\<\
The Implicit Shift Trick consists of: Starting from an Upper Hessenberg \
matrix H and two shifts \[Mu]1and \[Mu]2\
\>", "Text",
 CellChangeTimes->{{3.8566069728840857`*^9, 3.856606999764533*^9}, {
  3.856607310912972*^9, 3.8566073241282215`*^9}, {3.856607359255083*^9, 
  3.8566074023031054`*^9}},ExpressionUUID->"bfc341dc-ca7c-43bf-8f03-\
54a80476b125"],

Cell[CellGroupData[{

Cell[TextData[{
 "Compute ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "=", 
    RowBox[{
     RowBox[{"M", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"], ",", 
       SubscriptBox["m", "3"], ",", "0", ",", "\[Ellipsis]", ",", "0"}], 
      "}"}]}]}], TraditionalForm]],ExpressionUUID->
  "5e7c31d4-68df-4eeb-b838-8c2651d44c5f"]
}], "ItemNumbered",
 CellChangeTimes->{{3.856349915042594*^9, 3.8563499223401546`*^9}, {
  3.8566068551072598`*^9, 3.856606855546418*^9}, {3.856607011966893*^9, 
  3.8566070550233865`*^9}, {3.856607372570058*^9, 
  3.8566073737446423`*^9}},ExpressionUUID->"ccecd8da-3192-42ca-9c7a-\
e30c956905d4"],

Cell[TextData[{
 "Compute the Householder Reflector ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Q", "0"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "46b20ef2-0b4f-46b2-88ef-418febd8642f"],
 " satisfying ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       SubscriptBox["Q", "0"], ")"}], "\[Transpose]"}], ".", "m"}], "=", 
    SubscriptBox["e", "1"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "32707b4e-9fc2-4388-8fca-eaee4eb484dc"]
}], "ItemNumbered",
 CellChangeTimes->{{3.856349915042594*^9, 3.8563499510521607`*^9}, {
  3.856607076819371*^9, 3.8566071547461452`*^9}, {3.856607269194892*^9, 
  3.8566072857759037`*^9}},ExpressionUUID->"0bbedf31-ea78-4a60-ac1d-\
ae3d0fe38540"],

Cell[TextData[{
 "Note that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["Q", "0"], ".", 
     SubscriptBox["e", "1"]}], "=", "m"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1101d931-ae83-4b5f-9935-0669b0ace034"],
 ".  In other words the first column of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Q", "0"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "523424c6-9a2a-4f1d-9081-21684befe822"],
 " contains our target."
}], "SubitemNumbered",
 CellChangeTimes->{{3.856349915042594*^9, 3.8563499927348413`*^9}, {
  3.856350040213933*^9, 3.856350046820106*^9}, {3.8566068720334735`*^9, 
  3.8566068754377327`*^9}, {3.8566071671907625`*^9, 3.856607169721947*^9}, {
  3.856607303079791*^9, 3.856607305492436*^9}, {3.8566074427776117`*^9, 
  3.8566075445438285`*^9}, {3.856607593202691*^9, 
  3.856607593202691*^9}},ExpressionUUID->"63677d91-b065-4f69-8311-\
ea4fb40a8599"],

Cell[TextData[{
 "Note that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Q", "0"], ".", "H"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e3e0a9f7-25aa-4d68-a978-87a0b6737c94"],
 " recombines the first three rows of H"
}], "SubitemNumbered",
 CellGroupingRules->{"GroupTogetherNestedGrouping", 15000.},
 CellChangeTimes->{{3.856349915042594*^9, 3.8563499927348413`*^9}, {
  3.856350040213933*^9, 3.856350046820106*^9}, {3.8566068720334735`*^9, 
  3.8566068754377327`*^9}, {3.8566071671907625`*^9, 3.856607169721947*^9}, {
  3.856607303079791*^9, 3.856607305492436*^9}, {3.8566074427776117`*^9, 
  3.8566075445438285`*^9}, {3.8566075942354574`*^9, 
  3.856607658436485*^9}},ExpressionUUID->"ba88ba19-ca8a-48aa-bc55-\
95b363c6776b"],

Cell[TextData[{
 "Note that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"H", ".", 
    RowBox[{
     RowBox[{"(", 
      SubscriptBox["Q", "0"], ")"}], "\[Transpose]"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "91dfbd2e-e940-4911-a740-d385b5f6e557"],
 " recombines the first three columns of H"
}], "SubitemNumbered",
 CellGroupingRules->{"GroupTogetherNestedGrouping", 15000.},
 CellChangeTimes->{{3.856349915042594*^9, 3.8563499927348413`*^9}, {
  3.856350040213933*^9, 3.856350046820106*^9}, {3.8566068720334735`*^9, 
  3.8566068754377327`*^9}, {3.8566071671907625`*^9, 3.856607169721947*^9}, {
  3.856607303079791*^9, 3.856607305492436*^9}, {3.8566074427776117`*^9, 
  3.8566075445438285`*^9}, {3.8566075942354574`*^9, 
  3.856607677536152*^9}},ExpressionUUID->"c8ca5021-6d44-46a0-b7df-\
916d4b39e215"],

Cell[TextData[{
 "Compute ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Q", "0"], ".", "H", ".", 
    RowBox[{
     RowBox[{"(", 
      SubscriptBox["Q", "0"], ")"}], "\[Transpose]"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0697e5f7-a92c-4bd4-9dc5-b4a68b6bd1b8"],
 " and note it is almost Upper Hessenberg"
}], "ItemNumbered",
 CellChangeTimes->{{3.856349915042594*^9, 3.8563499927348413`*^9}, {
  3.856350040213933*^9, 3.856350046820106*^9}, {3.8566068720334735`*^9, 
  3.8566068754377327`*^9}, {3.8566071671907625`*^9, 3.856607169721947*^9}, {
  3.856607303079791*^9, 3.856607305492436*^9}, {3.8566074427776117`*^9, 
  3.8566075882600393`*^9}, {3.856607685833399*^9, 
  3.856607700464035*^9}},ExpressionUUID->"a57ec074-3086-4c2d-88fc-\
9f57c12e0f49"],

Cell[CellGroupData[{

Cell[TextData[{
 "The only problem is that the top ",
 Cell[BoxData[
  FormBox[
   RowBox[{"4", "\[Times]", "34"}], TraditionalForm]],ExpressionUUID->
  "f5c14748-aaaf-4e03-8759-47e1a856c254"],
 " block has been filled in."
}], "SubitemNumbered",
 CellChangeTimes->{{3.856349915042594*^9, 3.8563499927348413`*^9}, {
  3.856350040213933*^9, 3.856350046820106*^9}, {3.8566068720334735`*^9, 
  3.8566068754377327`*^9}, {3.8566071671907625`*^9, 3.856607169721947*^9}, {
  3.856607303079791*^9, 3.856607305492436*^9}, {3.8566074427776117`*^9, 
  3.8566075882600393`*^9}, {3.856607685833399*^9, 3.856607764143566*^9}, {
  3.856768147037476*^9, 
  3.856768148741951*^9}},ExpressionUUID->"ba02000d-38d7-49a1-9555-\
d478e09a999a"],

Cell["This is called a bulge! ", "SubitemNumbered",
 CellChangeTimes->{{3.856349915042594*^9, 3.8563499927348413`*^9}, {
  3.856350040213933*^9, 3.856350046820106*^9}, {3.8566068720334735`*^9, 
  3.8566068754377327`*^9}, {3.8566071671907625`*^9, 3.856607169721947*^9}, {
  3.856607303079791*^9, 3.856607305492436*^9}, {3.8566074427776117`*^9, 
  3.8566075882600393`*^9}, {3.856607685833399*^9, 3.8566077736512346`*^9}, {
  3.8566110121402855`*^9, 
  3.856611012151223*^9}},ExpressionUUID->"49163665-e347-4a19-b4d5-\
449fd97b9f09"],

Cell["We will see later how to push the bulge down to the bottom. ", \
"SubitemNumbered",
 CellChangeTimes->{{3.856349915042594*^9, 3.8563499927348413`*^9}, {
  3.856350040213933*^9, 3.856350046820106*^9}, {3.8566068720334735`*^9, 
  3.8566068754377327`*^9}, {3.8566071671907625`*^9, 3.856607169721947*^9}, {
  3.856607303079791*^9, 3.856607305492436*^9}, {3.8566074427776117`*^9, 
  3.8566075882600393`*^9}, {3.856607685833399*^9, 3.8566077736512346`*^9}, {
  3.8566110137864103`*^9, 3.856611037650997*^9}, {3.856768156051712*^9, 
  3.8567681610431232`*^9}},ExpressionUUID->"3ce67aa2-6146-4bec-b540-\
66aa031bf89e"]
}, Open  ]]
}, Open  ]],

Cell["Lets look at a picture of this \[OpenCurlyDoubleQuote]cast of \
characters\[CloseCurlyDoubleQuote].", "Text",
 CellChangeTimes->{{3.856607787989021*^9, 3.8566077943044786`*^9}, {
  3.856767460065398*^9, 
  3.8567674662865133`*^9}},ExpressionUUID->"ef25525c-966d-497e-a3a9-\
d3baca6a857a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"MatrixPlot", ",", " ", 
    RowBox[{"ColorRules", "->", 
     RowBox[{"{", 
      RowBox[{"0", "->", "LightGreen"}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", "12"}], ";", 
  RowBox[{"Id", "=", 
   RowBox[{"IdentityMatrix", "[", "m", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{
    RowBox[{"HessenbergDecomposition", "[", "A", "]"}], 
    "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HBot", "=", 
   RowBox[{"H", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{
      RowBox[{"m", "-", "1"}], ";;", "m"}], ",", 
     RowBox[{
      RowBox[{"m", "-", "1"}], ";;", "m"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"s", ",", "t"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Tr", "[", "HBot", "]"}], ",", 
     RowBox[{"Det", "[", "HBot", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Mu]1", ",", "\[Mu]2"}], "}"}], "=", 
   RowBox[{"Eigenvalues", "[", "HBot", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"H", "-", " ", 
       RowBox[{"\[Mu]1", " ", "Id"}]}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"H", "-", 
       RowBox[{"\[Mu]2", " ", "Id"}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m1Top", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"H", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "2"], "+", 
      RowBox[{
       RowBox[{"H", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"H", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", " ", 
      RowBox[{"s", " ", 
       RowBox[{"H", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "+", "t"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"H", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"H", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"H", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"H", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", " ", 
      RowBox[{"s", " ", 
       RowBox[{"H", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"H", "\[LeftDoubleBracket]", 
       RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
      RowBox[{"H", "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v0", "=", "m1Top"}], ";", " ", 
  RowBox[{
   RowBox[{"v0", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+=", 
   RowBox[{"Norm", "[", "m1Top", "]"}]}], ";", 
  RowBox[{"v0", "=", 
   RowBox[{"Normalize", "[", "v0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q0", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Band", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "]"}], "->", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", " ", 
  RowBox[{
   RowBox[{"Q0", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"1", ";;", "3"}], ",", 
     RowBox[{"1", ";;", "3"}]}], "\[RightDoubleBracket]"}], "-=", 
   RowBox[{"2", " ", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"v0", ",", "v0"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TabView", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<M\>\"", "->", 
     RowBox[{"MatrixPlot", "[", 
      RowBox[{"Chop", "[", "M", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Q0\>\"", "->", 
     RowBox[{"MatrixPlot", "[", 
      RowBox[{"Chop", "[", "Q0", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<H\>\"", "->", 
     RowBox[{"MatrixPlot", "[", 
      RowBox[{"Chop", "[", "H", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Q0\[Transpose].M\>\"", "->", 
     RowBox[{"MatrixPlot", "[", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{"Q0", "\[Transpose]"}], ".", "M"}], "]"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Q0.H\>\"", "->", 
     RowBox[{"MatrixPlot", "[", 
      RowBox[{"Chop", "[", 
       RowBox[{"Q0", ".", "H"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Q0.H.Q0\[Transpose]\>\"", "->", 
     RowBox[{"MatrixPlot", "[", 
      RowBox[{"Chop", "[", 
       RowBox[{"Q0", ".", "H", ".", 
        RowBox[{"Q0", "\[Transpose]"}]}], "]"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Q0 & M\>\"", "->", 
     RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m1Top", ",", 
         RowBox[{"M", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"1", ";;", "3"}], ",", "1"}], "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{"Q0", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"1", ";;", "3"}], ",", "1"}], "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{
          RowBox[{"Q0", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"1", ";;", "3"}], ",", "1"}], "\[RightDoubleBracket]"}], 
          "/", 
          RowBox[{"M", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"1", ";;", "3"}], ",", "1"}], 
           "\[RightDoubleBracket]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TableHeadings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<m1Top\>\"", ",", 
            "\"\<M\[LeftDoubleBracket]1;;3,1\[RightDoubleBracket]\>\"", ",", 
            "\"\<Q0\[LeftDoubleBracket]1;;3,1\[RightDoubleBracket]\>\"", ",", 
            "\"\<(Q0/M)\[LeftDoubleBracket]1;;3,1\[RightDoubleBracket]\>\""}],
            "}"}], ",", "Automatic"}], "}"}]}]}], "]"}]}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.85660779766298*^9, 3.856607868035225*^9}, {
   3.8566110546116524`*^9, 3.8566113684630795`*^9}, {3.8566141746625595`*^9, 
   3.856614515898755*^9}, {3.8566145749544125`*^9, 3.8566145757111454`*^9}, {
   3.856614607243222*^9, 3.856614613639614*^9}, {3.856766951947289*^9, 
   3.8567670310599747`*^9}, {3.856767090873919*^9, 3.856767241284231*^9}, {
   3.856767275852736*^9, 3.856767444437695*^9}, {3.856767517525*^9, 
   3.856767518636348*^9}, {3.856767551526764*^9, 3.856767945568725*^9}, {
   3.856767992151593*^9, 3.856768024705503*^9}, 3.856769668571415*^9, {
   3.856769701631119*^9, 3.856769884679619*^9}},
 CellLabel->
  "In[311]:=",ExpressionUUID->"80f5c0f7-f95d-49d6-8169-bb424bf9c70d"],

Cell[BoxData[
 TabViewBox[{{1,"\<\"M\"\>"->
  GraphicsBox[RasterBox[CompressedData["
1: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
G3AWOIpBEmOOXOm+NonRVo/FY6gzWjUQuD0W4trQgRcUH34fDa5jQoy+DJ/h
kfcEtogUN544RKNk9Nr6RXI0UmKUCyuUCfhGsbdaOZCw3ZxyqeYFhROfeTgm
9EjPe1zya9h9Enm2p2xMw4XolfMIX2v1BD5hlXt5aQLciS1odVslgev8LWa8
dBIZHiXPI46TiDUrM0i0noBOyUrDlDMP4dcmfqWXQyDoQeyjQzkUBOeGouZy
aBi9M06b036CKTu/iqxzfNhs8s/c/VYMDxZbYGFOQu5V6mufYWk9nva2i3Xo
QnJFRlVcgLQuZkV2y/MF0Ix5pNU4242j/hWmZdJ+/IukbdvsgriYwXkMe8ej
PcyGfTFmDM0l9jnuDkIYnQz5Pq5fAtvAZXUT0xI8GW6IWrOJQoh8pVeiLw3+
u4INo4snkGhZa8ljSmATNr3kdAsJ45qVYdpPCaQrLuz4JpOL4ohj6Z87H4bs
YrfufesoGHzOqPNfJsaBGQYz+eYvODzLOGt/axR0RNvFjksTiJLzCd4r7Qey
W8MdTTU4+PuKoe0jUp+55bFV7mSdGD11CTl2NzmQdc9X+Vg4DvvitPke+WI0
u3RU6ZWRKPrR4i23bgLvosOc8tz7cM3J2qhvA42nL5y0TOQotGgzlxnGifBP
my9haQ==
    "], {{0, 0}, {12, 12}}, {0, 1}],
   Frame->True,
   FrameLabel->{None, None},
   FrameTicks->{{{{11.5, 
        FormBox["1", TraditionalForm]}, {7.5, 
        FormBox["5", TraditionalForm]}, {0.5, 
        FormBox["12", TraditionalForm]}}, {{11.5, 
        FormBox["1", TraditionalForm]}, {7.5, 
        FormBox["5", TraditionalForm]}, {0.5, 
        FormBox["12", TraditionalForm]}}}, {{{0.5, 
        FormBox["1", TraditionalForm]}, {4.5, 
        FormBox["5", TraditionalForm]}, {11.5, 
        FormBox["12", TraditionalForm]}}, {{0.5, 
        FormBox["1", TraditionalForm]}, {4.5, 
        FormBox["5", TraditionalForm]}, {11.5, 
        FormBox["12", TraditionalForm]}}}},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   Method->{
    "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
     "DefaultGraphicsInteraction" -> {
      "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
       "Effects" -> {
        "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
         "Droplines" -> {
          "freeformCursorMode" -> True, 
           "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
     "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
     "RangePadding" -> Scaled[0.05]}]}, {2,"\<\"Q0\"\>"->
  GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggWIQWzOm/9BXjTf2DGDwwR7GH2niS+zWJMeLvbfPMb8V
XrDxjv2brl+KGc7hg86do+EwGg6j4TAaDqPhMBoOg0F8NByGdzhoyTeturj6
gn2SQITllhPX7G8Lq2zb3f7G/iS3u/46j0f2ljOu1fgHvrD3PCT+J6Lotf3B
ZSfEZv96Y790WsH1TqsX9pNuv3Dem35z0PmLWuKiy41vVLlcs6+SCJn8cv1j
+xnft62q+/7SXuKeSlL9lTf2Lr/M/hye9sC+irP0R5NxCc5wG2z+opb4N9kC
j+mvz9uredaLNc18YG/VuFYk4vMrnOGGK70NNn9RSxwAIUN66Q==
    "], {{0, 0}, {12, 
    12}}, {0, 1}],
   Frame->True,
   FrameLabel->{None, None},
   FrameTicks->{{{{11.5, 
        FormBox["1", TraditionalForm]}, {7.5, 
        FormBox["5", TraditionalForm]}, {0.5, 
        FormBox["12", TraditionalForm]}}, {{11.5, 
        FormBox["1", TraditionalForm]}, {7.5, 
        FormBox["5", TraditionalForm]}, {0.5, 
        FormBox["12", TraditionalForm]}}}, {{{0.5, 
        FormBox["1", TraditionalForm]}, {4.5, 
        FormBox["5", TraditionalForm]}, {11.5, 
        FormBox["12", TraditionalForm]}}, {{0.5, 
        FormBox["1", TraditionalForm]}, {4.5, 
        FormBox["5", TraditionalForm]}, {11.5, 
        FormBox["12", TraditionalForm]}}}},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   Method->{
    "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
     "DefaultGraphicsInteraction" -> {
      "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
       "Effects" -> {
        "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
         "Droplines" -> {
          "freeformCursorMode" -> True, 
           "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
     "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
     "RangePadding" -> Scaled[0.05]}]}, {3,"\<\"H\"\>"->
  GraphicsBox[RasterBox[CompressedData["
1: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
IKK7+42rnTvwG/9KSWc=
    "], {{0, 0}, {12, 12}}, {0, 1}],
   Frame->True,
   FrameLabel->{None, None},
   FrameTicks->{{{{11.5, 
        FormBox["1", TraditionalForm]}, {7.5, 
        FormBox["5", TraditionalForm]}, {0.5, 
        FormBox["12", TraditionalForm]}}, {{11.5, 
        FormBox["1", TraditionalForm]}, {7.5, 
        FormBox["5", TraditionalForm]}, {0.5, 
        FormBox["12", TraditionalForm]}}}, {{{0.5, 
        FormBox["1", TraditionalForm]}, {4.5, 
        FormBox["5", TraditionalForm]}, {11.5, 
        FormBox["12", TraditionalForm]}}, {{0.5, 
        FormBox["1", TraditionalForm]}, {4.5, 
        FormBox["5", TraditionalForm]}, {11.5, 
        FormBox["12", TraditionalForm]}}}},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   Method->{
    "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
     "DefaultGraphicsInteraction" -> {
      "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
       "Effects" -> {
        "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
         "Droplines" -> {
          "freeformCursorMode" -> True, 
           "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
     "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
     "RangePadding" -> Scaled[0.05]}]}, {4,"\<\"Q0\[Transpose].M\"\>"->
  GraphicsBox[RasterBox[CompressedData["
1:eJzVl3s01ekax12mxmBUlDRlhAqN6y6NSF+pRnMq5RJSimjKsGOrKEkopXKb
iqJIcklHCpOuLo3INjvRtJ3tbl9se/9uWxeTanCcs2b+7I+z1pl15rxrvWu9
3+9f7/N53+d5n9dwR5j7TlUlJSXN3+e/1mZb034aNqWg9O8xhD/0/7t/kXSb
mZHOoPMQl0P6Mfhsv1eK2ij5l9vnn+2r9lhyU2JpGN2P+jHMnUCnUpOkKEqI
KR0JTYFfkHC625N7aD0Nje+TTet2M9iTxjLZMEzjQ5NmsaUOBbVnyUP9k6Uw
L1B8XtIsR9wHxwVVaRR8dNZZv3tL/+Xi/Zjvdv633dyNfLz6ytDlsp0Yu+jP
bOL1CTid8tCvzeuDn/bN4QFSijzzSNHLHAJBrl9HdPowWH0zLHLTaRpj7Gr1
NR1y9EY5xSQEMggzDZ6UXUlj76L6w5OcCUxKbjDyDhXhVRU/P2qnDMUnNVM9
Yv969y0p/KnliQISjX5SMnOHCGpRtyO6t1+FzZxUpQoWhTHWpE9dWyVwmuM+
mvTqCVoCRe+4GwhwOZ6hv3ZS0Il+nVw+j8GOhsqsmH0Mbg0t76t7TaPZ5ZMa
kYyA95bSHUfCaSRZVGxNv8zgO5OBtddtFPi0/YXgzEUxMvkujb1T5bhcEDDZ
WvK/41O95Lvurug2tBeU7Bz2FiI6P165pIqArNbCM3OMQutb8Rev18qwtHsb
7Eo7MMrryPJOphF0ZfDtyeME1if29ZiPC+F2kafiJKARGmup6V9IQnDGlu8s
l2DJNHEMWUuj4FzalPBvSbhvaag0eC8G7wFd0TGDxg8rPW+WlcvQdr/xlc+y
LizQK732nbkQe1bYfX751iDm9K+O6NT+8/nk1D0x5vIoTLPsmc/O7cf9ui7f
a0H74PM4Xb9jLY1K6cyZ/DNyjHu7qyWr96HZa4NnJ2iMaE0JiN8ph2WW8Hjt
l724Z7dFK37i3G246Zk+E3l1IPIr+zS6H1u8VhhVEl2weRajFdQ3gE7mwlb/
MTk87y59sneyDHOfW92ZlU5iWaljyTR/GgdWZefsq+/E0HhbwqvTA/BVbMvn
8uRwreUzlxqk6FZZR9R0EpBrjC9c++a/x+EnryCurgcNh1GOq+qsfoRGRbs2
anKQ6/n8xp1UEvPtl6XZqorgr2Pt2Jedik6DhavWWzK4XtPU3qGuQGnSeGQo
R4Ef+D7tMfMomGsNwvyMBNHH+2Y3f9YI6XudqSp5/XCI33xhZcAg+im/wHIx
AbeqanVRQCv87o5MDmnph5ZRpm2MiEB3dtvcXQyJonUn7IsLxVALT3NLOlWN
Vlf/t7pzKcT7+FTtFtK4UWv14VodA0nI6NBJbjtu2754qvFSDKUtbyqqRfL/
mMNZVlxL5EEGRYzNEgt5DwqU625lcAJRtcTqrfJ9El2h2dzEOhH0zBewo8gy
8JYuPvZwnMZVrZDDGfYU0iu9S/3YUhxxNC2s1GSQnlJy+WwIBfl2EwGPksJg
/lZ9DRcK7kkzDf9mNoBv8qs1jpY149gKX/5+fwppIX6/hF8YgJFhg7RTrwWi
q9NN3P9Ooc8g5+fWPilks6va1Ka/QI7yYauFKhRG6hu+1Pltgs/ZvHXT2Y8Q
aLzrrEMNH483Fu9l7RGjyU6kE6ZJoEwSu3zGPBqsRE8/SiFDywk/wwU23R/l
8IcWRk8vcxF2/q6VlHyDxJYNPBLqsbyOmktCXDk/W2L5OBofzmF89DQFzaBt
Rc+8pGjINS+3eNeG93t+xfjS5+B09TxNvC1EbGX4W8EFAvQJXUpwncR5B58z
nBohds1YnOt36RBOoqt42IxBMLMvwmii3jqxU+htmjKMsA3rfh4WYaZWi9rC
Shl8jY+oxJWSeOEf/HKJM4Ppvaxari2N/Q5rxx6/l0HrpcVRXR6N+uXjiu+j
SISuCHl8lyNBZWPLFscxElHXejOyQ4QoURHo00kH4eTSfzZLQeHgiCRht7oM
wjWb5WHXBR/lE1fTGBi86xfctr8SMe1bEZaXPyvmBxNwlo79QBRKJvL37K2Q
YjloA6dZ1xwprBatvJNwlMGBo2zf4+YMyrp2nkuJIaGnfbBI7wYNfWmN3FWF
xPtbxcZzVohRsXmNvpvxCyxLDPtRs1CEDU3S28fXEYie5HSvTaMdzadWmVuc
E+OoUcvMTUoEJKzd8VMWTfQj1oppoTYT9aXMrqCe1YPkNKMbvDYKpHXxNt2k
QfxE2Qb0lrQjPqrpXaEPDevktLhF9XJEzKt+OEO1H5KvtGbpRPXgUXpS7vcb
pNhoZcp57UTg15XCy1S+DKVjL0WnZSQOr9cLv3Lu4/1PSks5K/SBEMFZz8SR
yjI08R6lDjiTWBzzzn6TNY19462ykw79mOIVunEVwUE279CJYsUAktZas1oC
CBy979kRUkrBeVGErrMrA/En3qbrAmlsf/3NnXkcOX7bu1L9oUgAyXyLFSoj
Esxw0ua+TpVDEqv6+dwHFEZTe1WZeYNglnFje435E+9KXvBpKzkmCznL1Owo
JDjaavTWT8S/YI3bG10K9iPsA6NeEuSdn+O43O4xXN64KNi2DFpPSsUHJ9FY
lfvUcPZhGZT3DhuktD/Hc+uHHqYqInQqpnaw4wi0vyk2OxBBwdfl0nbW4AA+
cX+03cq5FXl7Fps/z2jB/iAb6ylePVjTF+2hcnqCg63/u+qrL6B909iZEIvA
VR6sj7UjIBiyM4q7QiOuZ6zocDuBVvqBjvEzEYyV46MWn6fhfm3B/MybE/Xf
ZcOpl8EiHFt+I9/lBgWT5H2JX9sw+FDkel53iEGLSf4MtiofKy1juuu0xcgZ
dTU9Y0ZAWsJYHjFgINDbbp1VMfFP2H2vJKlwECU5vxyzJmh4JFq8MZOTGL76
pD0jawDpX6c4lLsNQmdc8YEyI8Fy5jttNqaBHel7M0UUMu+xpse3DcKkN9w3
r/kf0A6IlB70H0ByGLuibyoBq1ueqz1iKFwvLEVCrACrjIfjXzVKMGIuqM7I
leOfZNlkxw==
    "], {{0, 0}, {12, 12}}, {0, 1}],
   Frame->True,
   FrameLabel->{None, None},
   FrameTicks->{{{{11.5, 
        FormBox["1", TraditionalForm]}, {7.5, 
        FormBox["5", TraditionalForm]}, {0.5, 
        FormBox["12", TraditionalForm]}}, {{11.5, 
        FormBox["1", TraditionalForm]}, {7.5, 
        FormBox["5", TraditionalForm]}, {0.5, 
        FormBox["12", TraditionalForm]}}}, {{{0.5, 
        FormBox["1", TraditionalForm]}, {4.5, 
        FormBox["5", TraditionalForm]}, {11.5, 
        FormBox["12", TraditionalForm]}}, {{0.5, 
        FormBox["1", TraditionalForm]}, {4.5, 
        FormBox["5", TraditionalForm]}, {11.5, 
        FormBox["12", TraditionalForm]}}}},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   Method->{
    "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
     "DefaultGraphicsInteraction" -> {
      "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
       "Effects" -> {
        "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
         "Droplines" -> {
          "freeformCursorMode" -> True, 
           "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
     "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
     "RangePadding" -> Scaled[0.05]}]}, {5,"\<\"Q0.H\"\>"->
  GraphicsBox[RasterBox[CompressedData["
1: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
P6dW3TP1uLaT6Z9SLodPbcLBG3EE/gmzo1b0
    "], {{0, 0}, {12, 12}}, {0, 1}],
   Frame->True,
   FrameLabel->{None, None},
   FrameTicks->{{{{11.5, 
        FormBox["1", TraditionalForm]}, {7.5, 
        FormBox["5", TraditionalForm]}, {0.5, 
        FormBox["12", TraditionalForm]}}, {{11.5, 
        FormBox["1", TraditionalForm]}, {7.5, 
        FormBox["5", TraditionalForm]}, {0.5, 
        FormBox["12", TraditionalForm]}}}, {{{0.5, 
        FormBox["1", TraditionalForm]}, {4.5, 
        FormBox["5", TraditionalForm]}, {11.5, 
        FormBox["12", TraditionalForm]}}, {{0.5, 
        FormBox["1", TraditionalForm]}, {4.5, 
        FormBox["5", TraditionalForm]}, {11.5, 
        FormBox["12", TraditionalForm]}}}},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   Method->{
    "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
     "DefaultGraphicsInteraction" -> {
      "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
       "Effects" -> {
        "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
         "Droplines" -> {
          "freeformCursorMode" -> True, 
           "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
     "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
     "RangePadding" -> Scaled[0.05]}]}, {6,"\<\"Q0.H.Q0\[Transpose]\"\>"->
  GraphicsBox[RasterBox[CompressedData["
1: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
    "], {{0, 0}, {12, 12}}, {
    0, 1}],
   Frame->True,
   FrameLabel->{None, None},
   FrameTicks->{{{{11.5, 
        FormBox["1", TraditionalForm]}, {7.5, 
        FormBox["5", TraditionalForm]}, {0.5, 
        FormBox["12", TraditionalForm]}}, {{11.5, 
        FormBox["1", TraditionalForm]}, {7.5, 
        FormBox["5", TraditionalForm]}, {0.5, 
        FormBox["12", TraditionalForm]}}}, {{{0.5, 
        FormBox["1", TraditionalForm]}, {4.5, 
        FormBox["5", TraditionalForm]}, {11.5, 
        FormBox["12", TraditionalForm]}}, {{0.5, 
        FormBox["1", TraditionalForm]}, {4.5, 
        FormBox["5", TraditionalForm]}, {11.5, 
        FormBox["12", TraditionalForm]}}}},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   Method->{
    "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
     "DefaultGraphicsInteraction" -> {
      "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
       "Effects" -> {
        "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
         "Droplines" -> {
          "freeformCursorMode" -> True, 
           "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
     "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
     "RangePadding" -> Scaled[0.05]}]}, {7,"\<\"Q0 & M\"\>"->
  TagBox[
   TagBox[GridBox[{
      {
       StyleBox["\[Null]",
        ShowStringCharacters->False], "1", "2", "3"},
      {
       TagBox["\<\"m1Top\"\>",
        HoldForm], "1.6315312240260118`", "1.1378424247962524`", 
       "3.427492595802899`"},
      {
       TagBox["\<\"M\[LeftDoubleBracket]1;;3,1\[RightDoubleBracket]\"\>",
        HoldForm], "1.6315312240260116`", "1.1378424247962526`", 
       "3.427492595802899`"},
      {
       TagBox["\<\"Q0\[LeftDoubleBracket]1;;3,1\[RightDoubleBracket]\"\>",
        HoldForm], 
       RowBox[{"-", "0.41170515549171993`"}], 
       RowBox[{"-", "0.2871263421302124`"}], 
       RowBox[{"-", "0.8649030746832056`"}]},
      {
       TagBox["\<\"(Q0/M)\[LeftDoubleBracket]1;;3,1\[RightDoubleBracket]\"\>",
        
        HoldForm], 
       RowBox[{"-", "0.2523427988560249`"}], 
       RowBox[{"-", "0.25234279885602484`"}], 
       RowBox[{"-", "0.2523427988560249`"}]}
     },
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxDividers->{
      "Columns" -> {False, True, {False}, False}, 
       "Rows" -> {False, True, {False}, False}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[2.0999999999999996`]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}],
   Function[BoxForm`e$, 
    TableForm[
    BoxForm`e$, 
     TableHeadings -> {{
       "m1Top", "M\[LeftDoubleBracket]1;;3,1\[RightDoubleBracket]", 
        "Q0\[LeftDoubleBracket]1;;3,1\[RightDoubleBracket]", 
        "(Q0/M)\[LeftDoubleBracket]1;;3,1\[RightDoubleBracket]"}, 
       Automatic}]]]}}, 1]], "Output",
 CellChangeTimes->{{3.856767682953549*^9, 3.856767731376177*^9}, 
   3.8567677624951*^9, {3.8567678294080677`*^9, 3.856767946189698*^9}, {
   3.8567680061075478`*^9, 3.856768025577621*^9}, 3.8567680687297087`*^9, 
   3.856769684721506*^9, {3.856769720382886*^9, 3.856769761563953*^9}, 
   3.856769811222211*^9, 3.856769886557046*^9},
 CellLabel->
  "Out[322]=",ExpressionUUID->"ce71c505-7407-4ed1-b07a-df99eb285614"]
}, Open  ]],

Cell["\<\
All we have to do is move the bulge down to the bottom (using orthogonal \
similarity transformations and we have completed a \
\[OpenCurlyDoubleQuote]double-shifted Wilkinson shift QR iteration\
\[CloseCurlyDoubleQuote].  Remember the Hessenberg decomposition is unique \
given the first column of Q.  We matched the first column of Q so we get the \
same output as doing the shifts twice using complex arithmetic.  It may not \
be a free lunch but it is a really good lunch special. \
\>", "Text",
 CellChangeTimes->{{3.856768205020174*^9, 
  3.8567684929175053`*^9}},ExpressionUUID->"08e8c5b8-0eea-481f-80bf-\
c513c5c5b3e4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bulge Chasing", "Section",
 CellChangeTimes->{{3.856768540960404*^9, 
  3.8567685670760193`*^9}},ExpressionUUID->"4953d171-c820-43d0-b4d1-\
e61aba51d146"],

Cell[TextData[{
 "To restore ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Q", "0"], ".", "H", ".", 
    RowBox[{
     RowBox[{"(", 
      SubscriptBox["Q", "0"], ")"}], "\[Transpose]"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a21dc88e-cfd6-47f0-a6f6-fa585a853ff2"],
 " to Hessenberg form we need to chase a ",
 Cell[BoxData[
  FormBox[
   RowBox[{"4", "\[Times]", "4"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "c0020fd5-5a95-44de-9ba9-a49075a6fb67"],
 " bulge from the top of an ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "m"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "23112d3a-4e4c-4bce-8ac8-2baa20b739f9"],
 " matrix down to the bottom. This is just a sequence of tiny versions of our \
Hessenberg code.  "
}], "Text",
 CellChangeTimes->{{3.856768596408585*^9, 3.856768893233615*^9}, {
  3.85676900636024*^9, 
  3.856769006773685*^9}},ExpressionUUID->"4e5867ea-3293-4207-9116-\
417282a9b325"],

Cell[CellGroupData[{

Cell[TextData[{
 "Move all the mass below the diagonal in the first column onto the \
subdiagonal entry with a tiny ",
 Cell[BoxData[
  FormBox[
   RowBox[{"3", "\[Times]", "3"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "721cf76c-290b-4dc1-a16a-d3c3b9527470"],
 " orthogonal ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Q", "1"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "4249e115-0570-46ad-845b-46fe9291dd02"]
}], "Item",
 CellChangeTimes->{{3.8567689064890013`*^9, 3.856769032575132*^9}, {
  3.8567690690391283`*^9, 3.856769080745328*^9}, {3.8567691460368567`*^9, 
  3.856769153933535*^9}},ExpressionUUID->"b6e87267-0003-458c-8243-\
d07438edf14d"],

Cell["We are going to use a tiny standard Householder", "Subitem",
 CellGroupingRules->{"GroupTogetherNestedGrouping", 15000.},
 CellChangeTimes->{{3.8567689064890013`*^9, 3.856769032575132*^9}, {
  3.8567690690391283`*^9, 
  3.856769135613038*^9}},ExpressionUUID->"0eba4b84-7bc3-46c3-87a4-\
7b62713c028c"],

Cell[TextData[{
 "Compute ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["Q", "1"], ".", 
      SubscriptBox["Q", "0"]}], 
     RowBox[{"H", ".", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["Q", "1"], ".", 
         SubscriptBox["Q", "0"]}], ")"}], "\[Transpose]"}]}]}], "=", 
    RowBox[{
     SubscriptBox["Q", "1"], ".", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["Q", "0"], 
       RowBox[{"H", ".", 
        RowBox[{
         RowBox[{"(", 
          SubscriptBox["Q", "0"], ")"}], "\[Transpose]"}], ".", 
        RowBox[{
         RowBox[{"(", 
          SubscriptBox["Q", "1"], ")"}], "\[Transpose]"}]}]}]}]}]}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "340560d2-a8ba-4d1b-99ee-737169c4f17c"],
 " which now has an upper Hessenberg first column and a bulge that has moved \
down by one."
}], "Item",
 CellChangeTimes->{{3.8567689064890013`*^9, 3.856769061994937*^9}, {
  3.8567691691491947`*^9, 
  3.856769297436173*^9}},ExpressionUUID->"edc6cc28-b89f-4151-8afd-\
c95d27eef67c"],

Cell[TextData[{
 "Simply repeat till the bulge gets to the bottom then finish the \
\[OpenCurlyDoubleQuote]chase\[CloseCurlyDoubleQuote] off with a ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "\[Times]", "2"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "227b9d34-f4fc-4fe2-a0b0-0782a164792d"],
 " orthogonal."
}], "Item",
 CellChangeTimes->{{3.8567689064890013`*^9, 3.856769061994937*^9}, {
  3.8567691691491947`*^9, 
  3.8567694056325006`*^9}},ExpressionUUID->"59f765b7-bfbf-42e6-ab29-\
d67f8a88c9f6"],

Cell["\<\
If you need the eigenvectors you can accumulate them.  It is common to do the \
updating in place  \
\>", "Item",
 CellChangeTimes->{{3.8567689064890013`*^9, 3.856769061994937*^9}, {
  3.8567691691491947`*^9, 3.856769462196863*^9}, {3.856769637738611*^9, 
  3.856769640129915*^9}},ExpressionUUID->"a65385fd-9b59-4c9c-8bc4-\
376a3f49d2c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Script", "Subsection",
 CellChangeTimes->{{3.8561281186377993`*^9, 
  3.856128119660955*^9}},ExpressionUUID->"ce22ee2e-3a01-406d-896b-\
befc7849564f"],

Cell["\<\
First we create a bulge explicitly building Q0 and make sure we remember that \
it is much more efficient not to do this stuff implicitly.\
\>", "Text",
 CellChangeTimes->{{3.8567704419932423`*^9, 3.856770457245257*^9}, {
  3.856770518141612*^9, 
  3.8567706003726873`*^9}},ExpressionUUID->"38d4111a-9d19-4ad1-a58f-\
ae360b4aba2a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Id", "=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Band", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "]"}], "->", "1"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "=", 
    RowBox[{
     RowBox[{"HessenbergDecomposition", "[", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "m"}], "}"}]}], "]"}], "]"}], 
     "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Create", " ", "the", " ", "bulge"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Compute", " ", "the", " ", "Shifts", " ", "and", " ", "the", " ", "first",
     " ", "colun", " ", "of", " ", "M"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HBot", "=", 
   RowBox[{"H", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{
      RowBox[{"m", "-", "1"}], ";;", "m"}], ",", 
     RowBox[{
      RowBox[{"m", "-", "1"}], ";;", "m"}]}], "\[RightDoubleBracket]"}]}], 
  ";", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"s", ",", "t"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Tr", "[", "HBot", "]"}], ",", 
     RowBox[{"Det", "[", "HBot", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m1Top", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"H", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "2"], "+", 
       RowBox[{
        RowBox[{"H", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
        RowBox[{"H", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", " ", 
       RowBox[{"s", " ", 
        RowBox[{"H", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "+", "t"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"H", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
        RowBox[{"H", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "+", 
       RowBox[{
        RowBox[{"H", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
        RowBox[{"H", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", " ", 
       RowBox[{"s", " ", 
        RowBox[{"H", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"H", "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"H", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Explicitly", " ", "create", " ", "the", " ", "bulge", " ", "using", " ", 
    "the", " ", "Householder", " ", "Q0"}], "  ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v0", "=", "m1Top"}], ";", " ", 
  RowBox[{
   RowBox[{"v0", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+=", 
   RowBox[{"Norm", "[", "m1Top", "]"}]}], ";", 
  RowBox[{"v0", "=", 
   RowBox[{"Normalize", "[", "v0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q0", "=", "Id"}], ";", 
  RowBox[{
   RowBox[{"Q0", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"1", ";;", "3"}], ",", 
     RowBox[{"1", ";;", "3"}]}], "\[RightDoubleBracket]"}], "-=", 
   RowBox[{"2", " ", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"v0", ",", "v0"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HExp", "=", 
    RowBox[{"Q0", ".", "H", ".", 
     RowBox[{"Q0", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Implicitly", " ", "create", " ", "the", " ", "bulge", " ", "using", " ", 
    "v0"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HImp", "=", "H"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HImp", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"1", ";;", "3"}], ",", "All"}], "\[RightDoubleBracket]"}], "-=", 
   
   RowBox[{"2", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"v0", ",", 
      RowBox[{"v0", ".", 
       RowBox[{"HImp", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"1", ";;", "3"}], ",", "All"}], 
        "\[RightDoubleBracket]"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HImp", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", 
      RowBox[{"1", ";;", "3"}]}], "\[RightDoubleBracket]"}], "-=", 
    RowBox[{"2", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"HImp", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{"1", ";;", "3"}]}], "\[RightDoubleBracket]"}], ".", "v0"}], 
       ",", "v0"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Check", " ", "they", " ", "are", " ", "the", " ", "same"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Norm", "[", 
  RowBox[{"HImp", "-", "HExp"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8567699351191053`*^9, 3.856769968912465*^9}, {
  3.856770031925971*^9, 3.856770210643325*^9}, {3.8567704365445004`*^9, 
  3.856770437319269*^9}, {3.856770469543508*^9, 3.856770506000093*^9}, {
  3.856770603733383*^9, 3.856770728204048*^9}, {3.856770810844659*^9, 
  3.8567708426331787`*^9}, {3.856770912433288*^9, 3.8567711701628323`*^9}, {
  3.8567712045064907`*^9, 3.856771214690022*^9}, {3.856771332279242*^9, 
  3.8567713600247707`*^9}, {3.85677190281007*^9, 3.856771932430703*^9}},
 CellLabel->
  "In[440]:=",ExpressionUUID->"0671a547-36d2-4f60-9649-65cadb1e913c"],

Cell[BoxData["7.598976857195611`*^-16"], "Output",
 CellChangeTimes->{{3.8567713462033978`*^9, 3.8567713607927017`*^9}, {
  3.856771926113228*^9, 3.856771933260026*^9}},
 CellLabel->
  "Out[451]=",ExpressionUUID->"0a221fd6-9552-4ced-978c-9b307dd4c9aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{"Dimensions", ",", 
     RowBox[{"{", 
      RowBox[{"HImpAll", ",", 
       RowBox[{"1", ";;", "3"}]}]}]}]}], "\[RightDoubleBracket]"}], ",", 
  RowBox[{
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"v0", ",", 
     RowBox[{
      RowBox[{"HImp", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", 
        RowBox[{"1", ";;", "3"}]}], "\[RightDoubleBracket]"}], ".", "v0"}]}], 
    "]"}], "//", "Dimensions"}]}]], "Input",
 CellChangeTimes->{{3.856771220291091*^9, 
  3.856771323318921*^9}},ExpressionUUID->"bdd47500-982f-4e9d-bab3-\
8968655c341e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "12"}], "}"}]], "Output",
 CellChangeTimes->{{3.856771233675234*^9, 3.8567712388533583`*^9}, {
  3.856771273624514*^9, 3.856771285738606*^9}},
 CellLabel->
  "Out[390]=",ExpressionUUID->"62abe3fc-9ee6-41d7-b7ef-34714941c867"]
}, Open  ]],

Cell[TextData[{
 "Lets make a Hessenberg matrix and use the eigenvalues of the bottom ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "\[Times]", "2"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "2d8b9fcc-7ebb-4601-a7d0-4badbce2adb1"],
 " block as shifts as described above. "
}], "Text",
 CellChangeTimes->{{3.856128231207427*^9, 3.8561282814367323`*^9}, {
  3.856130542672225*^9, 
  3.856130550071294*^9}},ExpressionUUID->"c5791f17-b3be-4542-9347-\
aa97ff80f8b3"],

Cell["\<\
Things to note are that the choice of shifts have made the bottom of M small \
(shows up as very pale) and that very sadly the similarity transformed matrix \
is nowhere near Hessenberg!\
\>", "Text",
 CellChangeTimes->{{3.856130132466964*^9, 3.8561302168338413`*^9}, {
  3.8561306504263144`*^9, 
  3.856130720829894*^9}},ExpressionUUID->"6a514b1a-f441-47fc-8d3d-\
6cb1e5e2bbb7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{
    RowBox[{"HessenbergDecomposition", "[", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "m"}], "}"}]}], "]"}], "]"}], 
    "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{"H", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{
      RowBox[{"m", "-", "1"}], ";;", "m"}], ",", 
     RowBox[{
      RowBox[{"m", "-", "1"}], ";;", "m"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"s", ",", "t"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Tr", "[", "S", "]"}], ",", 
     RowBox[{"Det", "[", "S", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{
    RowBox[{"H", ".", "H"}], "-", 
    RowBox[{"s", " ", "H"}], " ", "+", 
    RowBox[{"t", " ", 
     RowBox[{"IdentityMatrix", "[", "m", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m1", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"1", "->", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"H", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "2"], "+", 
         RowBox[{
          RowBox[{"H", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"H", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{"s", " ", 
          RowBox[{"H", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "+", "t"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"2", "->", 
        RowBox[{
         RowBox[{
          RowBox[{"H", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], 
          RowBox[{"H", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"H", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"H", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{"s", " ", 
          RowBox[{"H", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"3", "->", 
        RowBox[{
         RowBox[{"H", "\[LeftDoubleBracket]", 
          RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"H", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}]}]}], "}"}], 
     ",", "m"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TableForm", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"M", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", "m1"}], 
    "}"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{
    RowBox[{"HessenbergDecomposition", "[", "M", "]"}], 
    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", " ", 
  RowBox[{"Q", "=", 
   RowBox[{"Q", "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QtMQ", "=", 
   RowBox[{
    RowBox[{"Q", "\[Transpose]"}], ".", "M", ".", "Q"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TabView", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<H\>\"", "->", 
     RowBox[{"MatrixPlot", "[", "H", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<M\>\"", "->", 
     RowBox[{"MatrixPlot", "[", "M", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Q\[Transpose]MQ\>\"", "->", 
     RowBox[{"MatrixPlot", "[", "QtMQ", "]"}]}]}], "}"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.856128186598505*^9, 3.8561282193000937`*^9}, {
  3.856128637555501*^9, 3.856128694459084*^9}, {3.8561287593785954`*^9, 
  3.8561290558660173`*^9}, {3.8561290909764967`*^9, 3.856129092663225*^9}, {
  3.85613000454464*^9, 3.8561300509366503`*^9}, {3.8561301223700047`*^9, 
  3.856130124063386*^9}, {3.856130224944518*^9, 3.856130242081221*^9}, {
  3.856130369074492*^9, 3.8561304929526577`*^9}, {3.856130742350115*^9, 
  3.856130742575941*^9}, {3.856130799546246*^9, 3.856130830969182*^9}, {
  3.8563489733673215`*^9, 3.856348987098715*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"cb9fda57-492d-4c29-a0d8-b3055fb20ed7"],

Cell[BoxData[
 TabViewBox[{{1,"\<\"H\"\>"->
  GraphicsBox[RasterBox[CompressedData["
1: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
16nH8PA7je0CMg==
    "], {{0, 0}, {12, 12}}, {0, 1}],
   Frame->True,
   FrameLabel->{None, None},
   FrameTicks->{{{{11.5, 
        FormBox["1", TraditionalForm]}, {7.5, 
        FormBox["5", TraditionalForm]}, {0.5, 
        FormBox["12", TraditionalForm]}}, {{11.5, 
        FormBox["1", TraditionalForm]}, {7.5, 
        FormBox["5", TraditionalForm]}, {0.5, 
        FormBox["12", TraditionalForm]}}}, {{{0.5, 
        FormBox["1", TraditionalForm]}, {4.5, 
        FormBox["5", TraditionalForm]}, {11.5, 
        FormBox["12", TraditionalForm]}}, {{0.5, 
        FormBox["1", TraditionalForm]}, {4.5, 
        FormBox["5", TraditionalForm]}, {11.5, 
        FormBox["12", TraditionalForm]}}}},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   Method->{
    "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
     "DefaultGraphicsInteraction" -> {
      "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
       "Effects" -> {
        "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
         "Droplines" -> {
          "freeformCursorMode" -> True, 
           "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
     "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
     "RangePadding" -> Scaled[0.05]}]}, {2,"\<\"M\"\>"->
  GraphicsBox[RasterBox[CompressedData["
1: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
6I7Ylbx/XIA/ATpWU84=
    "], {{0, 0}, {12, 12}}, {0, 1}],
   Frame->True,
   FrameLabel->{None, None},
   FrameTicks->{{{{11.5, 
        FormBox["1", TraditionalForm]}, {7.5, 
        FormBox["5", TraditionalForm]}, {0.5, 
        FormBox["12", TraditionalForm]}}, {{11.5, 
        FormBox["1", TraditionalForm]}, {7.5, 
        FormBox["5", TraditionalForm]}, {0.5, 
        FormBox["12", TraditionalForm]}}}, {{{0.5, 
        FormBox["1", TraditionalForm]}, {4.5, 
        FormBox["5", TraditionalForm]}, {11.5, 
        FormBox["12", TraditionalForm]}}, {{0.5, 
        FormBox["1", TraditionalForm]}, {4.5, 
        FormBox["5", TraditionalForm]}, {11.5, 
        FormBox["12", TraditionalForm]}}}},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   Method->{
    "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
     "DefaultGraphicsInteraction" -> {
      "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
       "Effects" -> {
        "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
         "Droplines" -> {
          "freeformCursorMode" -> True, 
           "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
     "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
     "RangePadding" -> Scaled[0.05]}]}, {3,"\<\"Q\[Transpose]MQ\"\>"->
  GraphicsBox[RasterBox[CompressedData["
1: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
Fy5jvoxHknehd7PeYfVrBP4FQJa12A==
    "], {{0, 0}, {12, 12}}, {0, 1}],
   Frame->True,
   FrameLabel->{None, None},
   FrameTicks->{{{{11.5, 
        FormBox["1", TraditionalForm]}, {7.5, 
        FormBox["5", TraditionalForm]}, {0.5, 
        FormBox["12", TraditionalForm]}}, {{11.5, 
        FormBox["1", TraditionalForm]}, {7.5, 
        FormBox["5", TraditionalForm]}, {0.5, 
        FormBox["12", TraditionalForm]}}}, {{{0.5, 
        FormBox["1", TraditionalForm]}, {4.5, 
        FormBox["5", TraditionalForm]}, {11.5, 
        FormBox["12", TraditionalForm]}}, {{0.5, 
        FormBox["1", TraditionalForm]}, {4.5, 
        FormBox["5", TraditionalForm]}, {11.5, 
        FormBox["12", TraditionalForm]}}}},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   Method->{
    "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
     "DefaultGraphicsInteraction" -> {
      "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
       "Effects" -> {
        "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
         "Droplines" -> {
          "freeformCursorMode" -> True, 
           "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
     "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
     "RangePadding" -> Scaled[0.05]}]}}, 3]], "Output",
 CellChangeTimes->{
  3.856128219748663*^9, 3.8561286891875353`*^9, {3.8561287729211273`*^9, 
   3.856128781160571*^9}, {3.856128828334736*^9, 3.8561288413236713`*^9}, 
   3.856129007867258*^9, {3.8561290450212097`*^9, 3.8561290563121557`*^9}, {
   3.856130051421523*^9, 3.8561300771085052`*^9}, 3.856130124941922*^9, 
   3.856130242990045*^9, {3.856130450263689*^9, 3.856130493715773*^9}, 
   3.85613074323752*^9, {3.856130831785192*^9, 3.8561308438177967`*^9}, 
   3.856131133502384*^9, 3.856348935829378*^9, 3.8563489878416157`*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"731dd66f-7b8a-44ef-9b80-ff0a51b0142f"]
}, Open  ]],

Cell[TextData[{
 "Of course, the whole point is that the eigenvalues of H and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Q", "\[Transpose]"}], ".", "H", ".", "Q"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1849082a-d28b-47c8-b85d-66123819a043"],
 " match."
}], "Text",
 CellChangeTimes->{{3.856130132466964*^9, 3.8561302168338413`*^9}, {
   3.856130748560668*^9, 3.8561307915314617`*^9}, {3.85613086348077*^9, 
   3.856130872364112*^9}, 
   3.856131005024068*^9},ExpressionUUID->"10d7ee1d-c129-4982-ab43-\
bfee02467591"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"Eigenvalues", ",", 
      RowBox[{"{", 
       RowBox[{"H", ",", "QtHQ"}], "}"}]}], "]"}], "\[Transpose]"}], ",", 
   RowBox[{"TableHeadings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<H\>\"", ",", "\"\<Q\[Transpose].H.Q\>\""}], "}"}]}], 
     "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.856130916885048*^9, 3.856130992548427*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"a6fe7d1d-8026-4907-9832-31291a190983"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      StyleBox["\[Null]",
       ShowStringCharacters->False], 
      TagBox["\<\"H\"\>",
       HoldForm], 
      TagBox["\<\"Q\[Transpose].H.Q\"\>",
       HoldForm]},
     {"1", 
      RowBox[{
       RowBox[{"-", "2.4497406213980737`"}], "+", 
       RowBox[{"0.07656525826849223`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "2.4497406213980746`"}], "+", 
       RowBox[{"0.07656525826848938`", " ", "\[ImaginaryI]"}]}]},
     {"2", 
      RowBox[{
       RowBox[{"-", "2.4497406213980737`"}], "-", 
       RowBox[{"0.07656525826849223`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "2.4497406213980746`"}], "-", 
       RowBox[{"0.07656525826848938`", " ", "\[ImaginaryI]"}]}]},
     {"3", 
      RowBox[{"1.5697293222560607`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6699871633509652`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"1.5697293222560598`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6699871633509636`", " ", "\[ImaginaryI]"}]}]},
     {"4", 
      RowBox[{"1.5697293222560607`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.6699871633509652`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"1.5697293222560598`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.6699871633509636`", " ", "\[ImaginaryI]"}]}]},
     {"5", 
      RowBox[{"0.7262722971934148`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.3818213761484655`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.7262722971934161`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.3818213761484635`", " ", "\[ImaginaryI]"}]}]},
     {"6", 
      RowBox[{"0.7262722971934148`", "\[VeryThinSpace]", "-", 
       RowBox[{"1.3818213761484655`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.7262722971934161`", "\[VeryThinSpace]", "-", 
       RowBox[{"1.3818213761484635`", " ", "\[ImaginaryI]"}]}]},
     {"7", 
      RowBox[{
       RowBox[{"-", "0.4820787120915092`"}], "+", 
       RowBox[{"1.1335071106475312`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.48207871209150827`"}], "+", 
       RowBox[{"1.1335071106475274`", " ", "\[ImaginaryI]"}]}]},
     {"8", 
      RowBox[{
       RowBox[{"-", "0.4820787120915092`"}], "-", 
       RowBox[{"1.1335071106475312`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.48207871209150827`"}], "-", 
       RowBox[{"1.1335071106475274`", " ", "\[ImaginaryI]"}]}]},
     {"9", 
      RowBox[{
       RowBox[{"-", "1.10870096313594`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.10870096313594`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {"10", 
      RowBox[{"0.5427562989514696`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.399756418306286`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.5427562989514689`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3997564183062857`", " ", "\[ImaginaryI]"}]}]},
     {"11", 
      RowBox[{"0.5427562989514696`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.399756418306286`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.5427562989514689`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.3997564183062857`", " ", "\[ImaginaryI]"}]}]},
     {"12", 
      RowBox[{
       RowBox[{"-", "0.47594182975057564`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.4759418297505759`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxDividers->{
     "Columns" -> {False, True, {False}, False}, 
      "Rows" -> {False, True, {False}, False}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {Automatic, {"H", "Q\[Transpose].H.Q"}}]]]], "Output",
 CellChangeTimes->{3.8561309929556713`*^9},
 CellLabel->
  "Out[181]//TableForm=",ExpressionUUID->"c2b1d7a0-12d0-49cc-906d-\
c6401926973c"]
}, Open  ]],

Cell[TextData[{
 "The clever trick is to compute the Hessenberg reduction of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Q", "\[Transpose]"}], ".", "H", ".", "Q"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b78d3add-70dc-4f7c-b4c2-8eef2f84bfa1"],
 " without explicitly computing either ",
 Cell[BoxData[
  FormBox["M", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "601a14ab-9d85-403a-bc57-0ee072145a5d"],
 " or ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Q", "\[Transpose]"}], ".", "H", ".", "Q"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "fce35764-5ef1-4e56-b032-abfc72c4bbba"],
 ".   "
}], "Text",
 CellChangeTimes->{{3.8561310096440363`*^9, 
  3.856131116499241*^9}},ExpressionUUID->"7d55ed42-ba7f-4acb-97a8-\
1c4f07cb2b37"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["From Lecture 10: Householder Reflection Code", "Section",
 CellChangeTimes->{{3.847003158823649*^9, 3.84700316723106*^9}, {
  3.854895347801463*^9, 3.854895353811205*^9}, {3.85489594895142*^9, 
  3.8548959517167397`*^9}},ExpressionUUID->"9a6affb0-75d1-453c-b6c8-\
6d310f5ec9ed"],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Householder Reflections\nMatrix Functions", "Section"],
 " "
}], "Subsection",
 CellChangeTimes->{{3.8468400908517523`*^9, 3.846840125313773*^9}, {
  3.846841365233275*^9, 3.8468413765615253`*^9}, {3.8469334869596004`*^9, 
  3.8469335254269605`*^9}, {3.8469372186478972`*^9, 
  3.84693725068496*^9}},ExpressionUUID->"4b106c00-ba87-4e76-822c-\
7e6c4cdaa767"],

Cell[TextData[{
 "If ",
 Cell[BoxData[
  FormBox["v", TraditionalForm]],ExpressionUUID->
  "1925c392-36e1-43a2-96d9-e5c8ab95a633"],
 " is a unit vector parallel to \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"sign", "(", 
     RowBox[{"a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     ")"}], "||", "a", "||", 
    RowBox[{
     SubscriptBox["e", "1"], "+", "a"}]}], TraditionalForm]],ExpressionUUID->
  "a49361f3-41a6-4573-bb8a-d693bb107487"],
 "\nthen the orthogonal matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "=", 
    RowBox[{"I", "-", 
     RowBox[{"2", " ", 
      RowBox[{"v", "\[CircleTimes]", "v"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"512b19cc-f633-4bf4-838d-48861894d7ab"],
 " satisfies\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Q", ".", "a"}], "=", 
    RowBox[{"||", "a", "||", 
     SubscriptBox["e", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "a0c30d31-b00e-46ad-accf-345250efee56"],
 "\nIn other words, Q rotates the vector ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],ExpressionUUID->
  "40e6bad2-7c94-4091-8954-e0de6967c024"],
 " to align with the vector ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "1"], TraditionalForm]],ExpressionUUID->
  "974b8d96-7751-42ca-884d-2f7d8dfe63ea"],
 ". "
}], "Text",
 CellChangeTimes->{{3.846932854787759*^9, 3.8469329103313017`*^9}, {
   3.8469333722095346`*^9, 3.846933456294175*^9}, {3.846933532225792*^9, 
   3.8469336109655237`*^9}, {3.846933662678347*^9, 3.84693387213366*^9}, {
   3.8469340875665607`*^9, 3.846934291563596*^9}, {3.8469350079034543`*^9, 
   3.8469350094851847`*^9}, 3.8469353408127766`*^9, {3.846936659235436*^9, 
   3.846936939960298*^9}},ExpressionUUID->"44044b81-b1ec-42ad-a9c2-\
b47e054157e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"HouseVec", "[", "a_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", "=", "a"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"v", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+=", 
      RowBox[{
       RowBox[{"Sign", "[", 
        RowBox[{"a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}], 
       RowBox[{"Norm", "[", "a", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v", "/", 
      RowBox[{"Norm", "[", "v", "]"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HouseMat", "[", "a_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"HouseVec", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", 
       RowBox[{"Length", "[", "a", "]"}], "]"}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"v", ",", "v"}], "]"}]}]}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8469370323032928`*^9, 3.8469371705899577`*^9}, {
  3.852652481943019*^9, 3.852652485802258*^9}, {3.852652528051162*^9, 
  3.8526525335935163`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"235cd440-a4a0-4f6a-9a8b-985fcb7364d3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "21"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"HouseMat", "[", "a", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"Q", ".", 
    RowBox[{"Q", "\[Transpose]"}]}], " ", "-", 
   RowBox[{"IdentityMatrix", "[", "m", "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Chop", "[", 
  RowBox[{"Q", ".", "a"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8469344920592456`*^9, 3.846934549496911*^9}, {
  3.846934695265825*^9, 3.84693478417249*^9}, {3.8469348408859897`*^9, 
  3.8469348959831905`*^9}, {3.846935793743067*^9, 3.8469360029439135`*^9}, {
  3.84693604642768*^9, 3.846936076847455*^9}, {3.846936965909218*^9, 
  3.846937023968395*^9}, {3.8469371785953503`*^9, 3.8469372092136116`*^9}, {
  3.852645821644829*^9, 3.852645866066623*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"d2603c5a-81e8-43f5-8d04-d1e37859f15c"],

Cell[BoxData["4.46271937886974`*^-16"], "Output",
 CellChangeTimes->{{3.8469347456744127`*^9, 3.846934784853061*^9}, {
   3.8469348749702806`*^9, 3.846934897011094*^9}, {3.8469359227697563`*^9, 
   3.846936003979722*^9}, {3.846936047516919*^9, 3.8469360774412975`*^9}, 
   3.846936977602109*^9, {3.846937019399043*^9, 3.846937024637398*^9}, {
   3.846937199885892*^9, 3.8469372098126545`*^9}, {3.8526458084559917`*^9, 
   3.852645872849594*^9}, 3.8526526421536818`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"40521da9-00c2-4aa2-81ce-17f6b0b2ebbb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2.8822741099161453`", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.8469347456744127`*^9, 3.846934784853061*^9}, {
   3.8469348749702806`*^9, 3.846934897011094*^9}, {3.8469359227697563`*^9, 
   3.846936003979722*^9}, {3.846936047516919*^9, 3.8469360774412975`*^9}, 
   3.846936977602109*^9, {3.846937019399043*^9, 3.846937024637398*^9}, {
   3.846937199885892*^9, 3.8469372098126545`*^9}, {3.8526458084559917`*^9, 
   3.852645872849594*^9}, 3.8526526421693025`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"a37e0e83-6826-4adc-bd69-fdc92b085e21"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Householder Reflections\nAction Functions", "Section"],
 " "
}], "Subsection",
 CellChangeTimes->{{3.8468400908517523`*^9, 3.846840125313773*^9}, {
  3.846841365233275*^9, 3.8468413765615253`*^9}, {3.8469334869596004`*^9, 
  3.8469335254269605`*^9}, {3.8469372186478972`*^9, 
  3.8469372557172794`*^9}},ExpressionUUID->"9f956903-6117-4f99-ab36-\
50bb0ccfd55d"],

Cell["\<\
There is no need to build the Householder matrix.  All we need to be able to \
do is apply the matrix to a vector x. \
\>", "Text",
 CellChangeTimes->{{3.846932854787759*^9, 3.8469329103313017`*^9}, {
   3.8469333722095346`*^9, 3.846933456294175*^9}, {3.846933532225792*^9, 
   3.8469336109655237`*^9}, {3.846933662678347*^9, 3.84693387213366*^9}, {
   3.8469340875665607`*^9, 3.846934291563596*^9}, {3.8469350079034543`*^9, 
   3.8469350094851847`*^9}, 3.8469353408127766`*^9, {3.846936659235436*^9, 
   3.846936939960298*^9}, {3.846937265493534*^9, 3.846937331605727*^9}, {
   3.8469374675167007`*^9, 3.846937467905089*^9}, {3.846997349464962*^9, 
   3.8469973750898113`*^9}, 
   3.846997922783347*^9},ExpressionUUID->"2efabaa9-2601-4894-bd02-\
8e28dd3879c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HouseActionVec", "[", 
   RowBox[{"x_", ",", "a_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"HouseVec", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "-", 
      RowBox[{"2", " ", "v", " ", 
       RowBox[{"(", 
        RowBox[{"v", ".", "x"}], ")"}]}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8469370323032928`*^9, 3.8469371705899577`*^9}, {
  3.846937334732747*^9, 3.846937390283722*^9}, {3.8469384128336287`*^9, 
  3.8469384133697815`*^9}, {3.846997913942161*^9, 3.8469979182321243`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"2abcccf5-0252-4a6e-acaf-06ac9e31921e"],

Cell["As always TEST!", "Text",
 CellChangeTimes->{{3.846997389733158*^9, 
  3.846997408281502*^9}},ExpressionUUID->"4bc72b3f-fae1-44de-b432-\
979aff0a6ede"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "14"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", "a"}], "}"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"HouseMat", "[", "a", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Norm", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Q", ".", "x"}], "-", 
      RowBox[{"HouseActionVec", "[", 
       RowBox[{"x", ",", "a"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"Q", ".", "a"}], "-", " ", 
      RowBox[{"HouseActionVec", "[", 
       RowBox[{"a", ",", "a"}], "]"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8469344920592456`*^9, 3.846934549496911*^9}, {
  3.846934695265825*^9, 3.84693478417249*^9}, {3.8469348408859897`*^9, 
  3.8469348959831905`*^9}, {3.846935793743067*^9, 3.8469360029439135`*^9}, {
  3.84693604642768*^9, 3.846936076847455*^9}, {3.846936965909218*^9, 
  3.846937023968395*^9}, {3.8469371785953503`*^9, 3.8469372092136116`*^9}, {
  3.8469374172100105`*^9, 3.846937433066861*^9}, {3.846938419410689*^9, 
  3.8469384200015383`*^9}, {3.846997937325851*^9, 3.8469981314106503`*^9}, {
  3.852646072571396*^9, 3.8526460731410913`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"949a12d8-f2a2-483b-85f9-e2376cbc9141"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.973993651728112`*^-16", ",", "1.1263846865310044`*^-15"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8469347456744127`*^9, 3.846934784853061*^9}, {
   3.8469348749702806`*^9, 3.846934897011094*^9}, {3.8469359227697563`*^9, 
   3.846936003979722*^9}, {3.846936047516919*^9, 3.8469360774412975`*^9}, 
   3.846936977602109*^9, {3.846937019399043*^9, 3.846937024637398*^9}, {
   3.846937199885892*^9, 3.8469372098126545`*^9}, 3.8469374351637125`*^9, 
   3.846938422336793*^9, 3.84699741276353*^9, 3.8469979316726837`*^9, {
   3.8469980111459827`*^9, 3.846998038280382*^9}, {3.846998071397077*^9, 
   3.846998131943534*^9}, {3.8526459979143314`*^9, 3.85264602375478*^9}, 
   3.852646075480006*^9, 3.852652734022664*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"ee91023b-b5c2-483c-9d2a-06a289add75a"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implicit Q Theorem", "Section",
 CellChangeTimes->{{3.856364405247097*^9, 
  3.8563644141450367`*^9}},ExpressionUUID->"54230a9d-32b5-498b-8f54-\
51a1e258576c"],

Cell[TextData[{
 "Non-degenerate QR is unique (if we make some sign choices).  \nTheorem\n\
Every Tall Skinny matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "\[Element]", 
    SuperscriptBox["C", 
     RowBox[{"m", "\[Times]", "n"}]]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "7ce4c650-2613-454c-b505-c97006e4e666"],
 " has a unique QR Decomposition ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"Q", ".", "R"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "052587df-1eae-4a94-bbdb-e2f93c8ceca8"],
 " with positive real entries on the diagonal of the small square upper \
triangular matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{"R", "\[Element]", 
    SuperscriptBox["\[DoubleStruckCapitalC]", 
     RowBox[{"n", "\[Times]", "n"}]]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "ffba23f8-f8e3-4fc1-9cce-8abbb839f814"],
 " and Tall Skinny orthonormal matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "\[Element]", 
    SuperscriptBox["\[DoubleStruckCapitalC]", 
     RowBox[{"m", "\[Times]", "n"}]]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1dc7e677-f260-445f-90ac-2540e4117aa9"],
 " satisfying ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["Q", "H"], ".", "Q"}], "=", 
    SubscriptBox["Id", "n"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "be628ee2-f83a-4c71-91a8-f821d1896b1a"],
 ". Note: although most computational tools give ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "819a3736-ac8c-4e3f-822b-9d33988f6c97"],
 " with real diagonal entries few bother to make them positive. Mathematica \
does not give positive diagonals."
}], "Text",
 CellChangeTimes->{{3.856365095532379*^9, 3.8563652424361243`*^9}, {
  3.8563652772482657`*^9, 3.8563654087837296`*^9}, {3.856365593096303*^9, 
  3.8563658441576157`*^9}, {3.856365876997865*^9, 
  3.856366039861642*^9}},ExpressionUUID->"786eee0a-2fc8-44ad-a692-\
64883088349a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"23", ",", "7"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomComplex", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "-", "I"}], ",", 
       RowBox[{"1", "+", "I"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q", ",", "R"}], "}"}], "=", 
   RowBox[{"QRDecomposition", "[", "A", "]"}]}], ";", " ", 
  RowBox[{"Q", "=", 
   RowBox[{"ConjugateTranspose", "[", "Q", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Chop", "[", 
  RowBox[{"Diagonal", "[", "R", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8563654190374484`*^9, 3.8563655272559743`*^9}, {
  3.856365849132036*^9, 3.856365871757758*^9}, {3.8563660197172155`*^9, 
  3.856366022540267*^9}},ExpressionUUID->"17130879-0147-4605-a0b9-\
0f8bdfc37a61"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.8840958226523807`", ",", 
   RowBox[{"-", "4.065994695225962`"}], ",", "3.6994180246556314`", ",", 
   RowBox[{"-", "3.7219980744892354`"}], ",", 
   RowBox[{"-", "3.489206420699576`"}], ",", 
   RowBox[{"-", "3.422466600766862`"}], ",", 
   RowBox[{"-", "3.4603524077114676`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8563658611055174`*^9, 3.8563658721941605`*^9}, {
  3.8563659775216436`*^9, 3.8563659858546667`*^9}},
 CellLabel->
  "Out[350]=",ExpressionUUID->"0f44ea80-586f-43b6-9351-27f31f3ce7cb"]
}, Open  ]],

Cell["\<\
It is easy enough to fix after the fact.  All you need to do is \
\[OpenCurlyDoubleQuote]fix\[CloseCurlyDoubleQuote] the signs on the diagonals.\
\>", "Text",
 CellChangeTimes->{{3.8563660530678964`*^9, 3.856366109372048*^9}, {
  3.8563663821799307`*^9, 3.85636638848361*^9}, {3.8563665036596465`*^9, 
  3.8563665167082496`*^9}},ExpressionUUID->"f961ec69-4066-44e1-a467-\
b2a11a63cbb1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"23", ",", "7"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomComplex", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "-", "I"}], ",", 
       RowBox[{"1", "+", "I"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q", ",", "R"}], "}"}], "=", 
   RowBox[{"QRDecomposition", "[", "A", "]"}]}], ";", " ", 
  RowBox[{"Q", "=", 
   RowBox[{"ConjugateTranspose", "[", "Q", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RSigns", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Sign", "[", 
     RowBox[{"Chop", "[", 
      RowBox[{"Diagonal", "[", "R", "]"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QHat", "=", 
   RowBox[{"Q", ".", "RSigns"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHat", "=", 
   RowBox[{"RSigns", ".", "R"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Chop", "[", "RHat", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", " ", 
  RowBox[{"Norm", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "-", 
      RowBox[{"Q", ".", "R"}]}], ",", 
     RowBox[{"A", "-", 
      RowBox[{"QHat", ".", "RHat"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.856366116736562*^9, 3.856366463923332*^9}},
 CellLabel->
  "In[465]:=",ExpressionUUID->"da3ccd62-aee5-4718-be9f-637aa8d46cbb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"3.7211639926315456`", 
      RowBox[{
       RowBox[{"-", "0.01367997173951474`"}], "-", 
       RowBox[{"0.5918885317565769`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.5991690056714511`"}], "-", 
       RowBox[{"0.4290662411081574`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.5913642990968656`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.5949846584124239`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.42454458344537643`"}], "+", 
       RowBox[{"0.9385477503152388`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.558605931318525`"}], "+", 
       RowBox[{"0.382722103463111`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.742243813691345`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6789129563058697`", " ", "\[ImaginaryI]"}]}]},
     {"0", "3.7300700572427954`", 
      RowBox[{
       RowBox[{"-", "0.43582133331315753`"}], "-", 
       RowBox[{"0.07070264892880707`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.024712228210168496`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6033526890909494`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.3617555915638885`"}], "+", 
       RowBox[{"0.5438320789998072`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"1.0054608423129459`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.7537553146395946`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.5037335431684972`"}], "-", 
       RowBox[{"0.184641173579082`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", "3.480986152251917`", 
      RowBox[{"0.593978374548215`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.2641132307057755`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.010487793379253041`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3565672957150634`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1731569417586829`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6322658409740463`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"1.147019493640987`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.4369785709722853`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", "0", "3.5049989933403154`", 
      RowBox[{
       RowBox[{"-", "0.22636820989769513`"}], "-", 
       RowBox[{"0.2632547417124732`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.3868718893348453`"}], "+", 
       RowBox[{"0.7900108094640963`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.34238347308021344`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.7602031590764791`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", "0", "0", "3.541567110294617`", 
      RowBox[{"0.42828214904546635`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.04158755819940624`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.8059199337765182`"}], "-", 
       RowBox[{"1.0137463833765896`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", "0", "0", "0", "3.023603528228316`", 
      RowBox[{"0.02647840909817667`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.6169490498223289`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", "0", "0", "0", "0", "3.14319635397956`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.856366119763114*^9, 3.8563661805082703`*^9}, {
  3.8563662312073917`*^9, 3.856366371711445*^9}, {3.8563664453347545`*^9, 
  3.856366464649742*^9}},
 CellLabel->
  "Out[471]//MatrixForm=",ExpressionUUID->"f2b39b9f-10f1-48f5-99da-\
fafcd6985693"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.5124190149787955`*^-15", ",", "2.5124190149787955`*^-15"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.856366119763114*^9, 3.8563661805082703`*^9}, {
  3.8563662312073917`*^9, 3.856366371711445*^9}, {3.8563664453347545`*^9, 
  3.85636646465784*^9}},
 CellLabel->
  "Out[472]=",ExpressionUUID->"83995d3c-785f-4ad5-9c39-3dff2e491473"]
}, Open  ]],

Cell[TextData[{
 "For any real m\[Times]m matrix If B is upper Hessenberg with positive \
subdiagonal elements and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"Q", "\[Transpose]"}], ".", "A", ".", "Q"}], "=", "B"}], 
   TraditionalForm]],ExpressionUUID->"4646c156-e08b-4175-b51b-802377a87366"],
 " then Q and B are uniquely determined by the first column of Q Q\
\[LeftDoubleBracket]All,1\[RightDoubleBracket]. "
}], "Text",
 CellChangeTimes->{{3.8563646142304993`*^9, 3.856364714743983*^9}, {
  3.8563650241279526`*^9, 3.8563650509474783`*^9}, {3.8563655698763027`*^9, 
  3.8563655729660034`*^9}, {3.8564294393883157`*^9, 
  3.8564294411164255`*^9}},ExpressionUUID->"e1d2f7e9-b640-4c6d-9222-\
80412fad2ae3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Messing Around", "Section",
 CellChangeTimes->{{3.856363112632678*^9, 
  3.8563631151904507`*^9}},ExpressionUUID->"43028209-9239-4f58-9f50-\
624b5cfb31ff"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", " ", 
  RowBox[{"A", "=", 
   RowBox[{"A", "+", "A"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]", "=", "1.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{"Sort", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Eigenvalues", "[", "A", "]"}], ",", 
      RowBox[{
       RowBox[{"Eigenvalues", "[", 
        RowBox[{"A", "-", 
         RowBox[{"\[Mu]", " ", 
          RowBox[{"IdentityMatrix", "[", "m", "]"}]}]}], "]"}], "+", 
       "\[Mu]"}]}], "}"}]}], "]"}], "\[Transpose]"}]}], "Input",
 CellChangeTimes->{{3.8563631186108904`*^9, 3.856363151238364*^9}, {
  3.8563642107236967`*^9, 3.8563642964670815`*^9}, {3.856364348259428*^9, 
  3.856364359346137*^9}, {3.8564273638484993`*^9, 
  3.856427365583724*^9}},ExpressionUUID->"0dc877ea-558d-4bd9-9059-\
6d08364b736a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5.199068458313786`"}], ",", 
     RowBox[{"-", "5.199068458313788`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.723002047355076`"}], ",", 
     RowBox[{"-", "3.723002047355081`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.465389567712424`"}], ",", 
     RowBox[{"-", "3.465389567712421`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.5354382704052`"}], ",", 
     RowBox[{"-", "2.5354382704052014`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.107177960330522`"}], ",", 
     RowBox[{"-", "1.107177960330523`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.19060590732168783`"}], ",", 
     RowBox[{"-", "0.1906059073216868`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.4229684174590107`", ",", "0.4229684174590095`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.2534085812993137`", ",", "1.2534085812993123`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.036455095565812`", ",", "2.036455095565812`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.44275722545616`", ",", "2.442757225456159`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.408617347106202`", ",", "3.408617347106202`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.12818476213751`", ",", "4.128184762137508`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8563631343496633`*^9, 3.856363151761961*^9}, {
  3.856364341969208*^9, 3.8563643601134605`*^9}},
 CellLabel->
  "Out[303]=",ExpressionUUID->"0ca33e49-ec34-41fb-8321-51fe38ac808d"]
}, Open  ]],

Cell["\<\
Hessenberg\[CloseCurlyQuote]s are not set up this way either! It is all \
because of the better stability choice for the Householder.  I need to work \
out how to fix it. This is not as easy as it was before. \
\>", "Text",
 CellChangeTimes->{{3.8564274693755083`*^9, 3.8564274881017914`*^9}, {
  3.856427788917152*^9, 3.8564278352146645`*^9}, {3.8564294604766364`*^9, 
  3.8564294638609962`*^9}, {3.8564297228481197`*^9, 
  3.8564297292484827`*^9}},ExpressionUUID->"2d6dc367-703b-4d53-a703-\
88ae6812af9a"],

Cell[CellGroupData[{

Cell[BoxData["HessenbergDecomposition"], "Input",
 CellChangeTimes->{{3.8564294838922696`*^9, 3.8564294865827646`*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"46e55fc9-efd6-4244-ab69-83c56ab0adb2"],

Cell[BoxData["HessenbergDecomposition"], "Output",
 CellChangeTimes->{3.8564294873463216`*^9},
 CellLabel->
  "Out[147]=",ExpressionUUID->"2f902ddf-9a84-46b4-b3c8-a7277decac23"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Information", "[", "HessenbergDecomposition", "]"}]], "Input",
 NumberMarks->False,
 CellLabel->
  "In[148]:=",ExpressionUUID->"8ee4a5fc-b746-4a68-9a7f-66cbf5b38ad9"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = True, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"],
                ImageSizeCache->{20.605, {6., 14.605}}], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"],
                ImageSizeCache->{20.605, {6., 14.605}}]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              
              ButtonData->
               "http://reference.wolfram.com/language/ref/\
HessenbergDecomposition.html",
              
              ButtonNote->
               "http://reference.wolfram.com/language/ref/\
HessenbergDecomposition.html"],
             
             "\"http://reference.wolfram.com/language/ref/\
HessenbergDecomposition.html\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"HessenbergDecomposition\\\", \
\\\"[\\\", StyleBox[\\\"m\\\", \\\"TI\\\"], \\\"]\\\"}]\\) gives the \
Hessenberg decomposition of a numerical matrix \\!\\(\\*StyleBox[\\\"m\\\", \
\\\"TI\\\"]\\). \"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Documentation\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Documentation\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Documentation", "Tooltip"]& ], 
                   TemplateBox[{
                    TemplateBox[{"\"Web \[RightGuillemet]\"", {
                    URL[
                    "http://reference.wolfram.com/language/ref/\
HessenbergDecomposition.html"], None}, 
                    "http://reference.wolfram.com/language/ref/\
HessenbergDecomposition.html", "Hyperlink", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"]},
                    "RowDefault"]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Options\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Options\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Options", "Tooltip"]& ], 
                   RowBox[{"Pivoting", "\[Rule]", "False"}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Attributes\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Attributes\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Attributes", "Tooltip"]& ], 
                   RowBox[{"{", "Protected", "}"}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"System`HessenbergDecomposition\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"],
               ImageSizeCache->{15.85, {5., 10.85}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"],
               ImageSizeCache->{15.85, {5., 10.85}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"]], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"]]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              
              ButtonData->
               "http://reference.wolfram.com/language/ref/\
HessenbergDecomposition.html",
              
              ButtonNote->
               "http://reference.wolfram.com/language/ref/\
HessenbergDecomposition.html"],
             
             "\"http://reference.wolfram.com/language/ref/\
HessenbergDecomposition.html\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"HessenbergDecomposition\\\", \
\\\"[\\\", StyleBox[\\\"m\\\", \\\"TI\\\"], \\\"]\\\"}]\\) gives the \
Hessenberg decomposition of a numerical matrix \\!\\(\\*StyleBox[\\\"m\\\", \
\\\"TI\\\"]\\). \"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[<|
   "ObjectType" -> "Symbol", "Usage" -> 
    "\!\(\*RowBox[{\"HessenbergDecomposition\", \"[\", StyleBox[\"m\", \
\"TI\"], \"]\"}]\) gives the Hessenberg decomposition of a numerical matrix \
\!\(\*StyleBox[\"m\", \"TI\"]\). ", 
    "Documentation" -> <|
     "Web" -> "http://reference.wolfram.com/language/ref/\
HessenbergDecomposition.html"|>, "OwnValues" -> None, "UpValues" -> None, 
    "DownValues" -> None, "SubValues" -> None, "DefaultValues" -> None, 
    "NValues" -> None, "FormatValues" -> None, 
    "Options" -> {Pivoting -> False}, "Attributes" -> {Protected}, "FullName" -> 
    "System`HessenbergDecomposition"|>, True]]], "Output",
 CellChangeTimes->{3.8564294894916644`*^9},
 CellLabel->
  "Out[148]=",ExpressionUUID->"4d79a359-60a4-4cda-a647-3e3bd35c8d4f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q", ",", "H"}], "}"}], "=", 
   RowBox[{"HessenbergDecomposition", "[", "A", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Norm", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"H", "-", 
      RowBox[{
       RowBox[{"Q", "\[Transpose]"}], ".", "A", ".", "Q"}]}], ",", " ", 
     RowBox[{"A", "-", 
      RowBox[{"Q", ".", "H", ".", 
       RowBox[{"Q", "\[Transpose]"}]}]}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SignFix1", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Band", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "]"}], "->", 
      RowBox[{"Sign", "[", 
       RowBox[{"Diagonal", "[", 
        RowBox[{"H", ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SignFix2", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Band", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}], "]"}], "->", 
      RowBox[{"Sign", "[", 
       RowBox[{"Diagonal", "[", 
        RowBox[{"H", ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SignFix", "=", 
   RowBox[{"SignFix1", ".", "SignFix2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"QHat", ",", "HHat"}], "}"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Q", ".", "SignFix"}], ",", 
     RowBox[{"H", ".", "SignFix"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{"Norm", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"H", "-", 
       RowBox[{
        RowBox[{"QHat", "\[Transpose]"}], ".", "A", ".", "QHat"}]}], ",", " ", 
      RowBox[{"A", "-", 
       RowBox[{"Q", ".", "H", ".", 
        RowBox[{"Q", "\[Transpose]"}]}]}]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"MatrixPlot", ",", 
   RowBox[{"{", 
    RowBox[{"H", ",", 
     RowBox[{
      RowBox[{"Q", "\[Transpose]"}], ".", "A", ".", "Q"}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8563631186108904`*^9, 3.856363151238364*^9}, {
   3.8563642107236967`*^9, 3.8563642964670815`*^9}, {3.856364348259428*^9, 
   3.856364359346137*^9}, {3.8564273638484993`*^9, 3.856427398151385*^9}, {
   3.856427498833953*^9, 3.8564277643197017`*^9}, {3.8564278686699944`*^9, 
   3.8564279734324813`*^9}, {3.8564289000723085`*^9, 3.8564289683908463`*^9}, 
   3.8564290422183447`*^9},
 CellLabel->
  "In[137]:=",ExpressionUUID->"eb0554ab-d6e6-4af5-bb6f-43018c5dcdda"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.997901659640524`*^-16", ",", "9.437370396907168`*^-16"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.856427401246089*^9, 3.8564275107775464`*^9, {3.8564275464206343`*^9, 
   3.856427554920185*^9}, {3.856427588162879*^9, 3.8564275964622383`*^9}, {
   3.8564276281099415`*^9, 3.8564276458335414`*^9}, {3.856427677145153*^9, 
   3.8564277008996663`*^9}, 3.85642773195667*^9, 3.85642776510865*^9, {
   3.856427884154704*^9, 3.8564279010075493`*^9}, 3.8564279341374073`*^9, {
   3.8564279685081654`*^9, 3.856427974219465*^9}, {3.8564289467251663`*^9, 
   3.8564289689797735`*^9}, 3.8564290437650905`*^9},
 CellLabel->
  "Out[140]=",ExpressionUUID->"540e91bf-5ffe-4ead-8190-63aa0e999f82"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.048987569782911`", ",", "9.437370396907168`*^-16"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.856427401246089*^9, 3.8564275107775464`*^9, {3.8564275464206343`*^9, 
   3.856427554920185*^9}, {3.856427588162879*^9, 3.8564275964622383`*^9}, {
   3.8564276281099415`*^9, 3.8564276458335414`*^9}, {3.856427677145153*^9, 
   3.8564277008996663`*^9}, 3.85642773195667*^9, 3.85642776510865*^9, {
   3.856427884154704*^9, 3.8564279010075493`*^9}, 3.8564279341374073`*^9, {
   3.8564279685081654`*^9, 3.856427974219465*^9}, {3.8564289467251663`*^9, 
   3.8564289689797735`*^9}, 3.8564290437650905`*^9},
 CellLabel->
  "Out[145]=",ExpressionUUID->"61741326-b7cf-4703-a7cb-8943a04e2041"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBghWIQGwI+2FNK+2rlPTxk9dZ+2ev5n3QNH9hfan3gcn55
of15Ey2jSTsf2h+7v+lrFsMLey19gVA3p9ckm1/9v7ZqeddZ+39PS6J+Xrhv
b/z3258I7df2bWEVMzTc39ob6cYvkml8aT+/0W12zLp79u2tS08E/r1t77Vx
t/XyJ0/tp5vyfWtgfIXT/M+yGq9sBN/Yf7GZdPmv7RP7BmdPlpnFh+3vWxwO
uiL+xt49YTWbftBD+8513xJuPq2w72SbFm5b/sJ+Y1Bd263zr+35XmSd+NL6
1v5Q2b/Uaq4r9gc5vnU+mfHIPvLzpci0AIS9D6tE1rk/vGUPC3l1qYmzNZ+/
tT9busf7Ovd9e5UnM4PddmXZ75ziGtRl+s7+rPdf9aesb+2Dp95RNqp7YZ+i
9Klm29+39qsiyv+9N3pj/2zDfr6qyGf2U/5cS7frA4aHsou5MuMje4ZrnzSU
pvXaO3jrMvw69dq+cJ7mmV1cj+1FRNv9jFi32FeLvRP2PPbGPoftr9qe0Of2
HYedWy8/vmrPaTOjlo/vvT1f4tu3Xw/esff5eutvsniE/cPUewcCqt7YR+wz
MWzifGZfN1/OXvnkBfvP+5k1zi16a59yp/Fa9u1X9tJJBYrfbj+yBwDQsPkd

     "], {{0, 0}, {5, 5}}, {0, 1}],
    Frame->True,
    FrameLabel->{None, None},
    FrameTicks->{{{{4.5, 
         FormBox["1", TraditionalForm]}, {3.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {1.5, 
         FormBox["4", TraditionalForm]}, {0.5, 
         FormBox["5", TraditionalForm]}}, {{4.5, 
         FormBox["1", TraditionalForm]}, {3.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {1.5, 
         FormBox["4", TraditionalForm]}, {0.5, 
         FormBox["5", TraditionalForm]}}}, {{{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}}, {{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}}}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05]}], ",", 
   GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBghWIQGwI+2KPTkpvlHY81vLF/0XA1jV/inX3LbbsY5Yfv
MNTB6Iispv1zrN/a39wt3hZq8MDe5tHnm0mLCu2dbu5PKYm7Zy/ea1t6fsIz
+wa/FboX0l/hNAcXncCqySqpec5+5e8V7/Ij7tkLB0tliaS8tu+ov3b4i+tb
e6v899kTa17ab2TZHL9z2j37vIDVx3jrbtjfOmtdt/PYE/u7n9tfLJ/3Eqf5
nAr2B3fyvbGX/upgymj8xD6Kx8VeR/awvfcs/09W4m/snaZ+Szoe9NC+fdO3
86teVth/+lq56SIz0D8l52VNcl/Zc8TteGG4+Y39+jcSnQy1l+xzVCY1BV17
aO8StLIutQ/h34dVIuvcH96yh4X8ivkVmzc+fWu/JnOzwiG++/bxVvwlf89k
2R/ZfrS7w+SdfWbsXTFxprf2O9NFmnxKXtjPO3QtP+XvW/vmSxM/7jR8Y983
k2F6cNgze68tRl+qe1/bi01efuvC34f2Ci7Tp/B/6bZPeM6WYXDytf1aP9l1
L5ke25+QWb3NvGuzvXi81445h9/YG6U2xHF7Pbe/0pTVdmPrVfvSbzpiWnzv
7c0vJ0rtP3jHPiTSs2uJSIR9XfbTav2KN/YLTiutNGR4Zv9l88cpDUsu2JfY
FlvyLXprbyC3YPK0G6/sV6y9v3L6lUf2ANdf/jI=
     "], {{0, 0}, {5, 5}}, {0, 1}],
    Frame->True,
    FrameLabel->{None, None},
    FrameTicks->{{{{4.5, 
         FormBox["1", TraditionalForm]}, {3.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {1.5, 
         FormBox["4", TraditionalForm]}, {0.5, 
         FormBox["5", TraditionalForm]}}, {{4.5, 
         FormBox["1", TraditionalForm]}, {3.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {1.5, 
         FormBox["4", TraditionalForm]}, {0.5, 
         FormBox["5", TraditionalForm]}}}, {{{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}}, {{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}}}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.856427401246089*^9, 3.8564275107775464`*^9, {3.8564275464206343`*^9, 
   3.856427554920185*^9}, {3.856427588162879*^9, 3.8564275964622383`*^9}, {
   3.8564276281099415`*^9, 3.8564276458335414`*^9}, {3.856427677145153*^9, 
   3.8564277008996663`*^9}, 3.85642773195667*^9, 3.85642776510865*^9, {
   3.856427884154704*^9, 3.8564279010075493`*^9}, 3.8564279341374073`*^9, {
   3.8564279685081654`*^9, 3.856427974219465*^9}, {3.8564289467251663`*^9, 
   3.8564289689797735`*^9}, 3.8564290438155756`*^9},
 CellLabel->
  "Out[146]=",ExpressionUUID->"a536d756-e9f1-4d02-8108-040f7f41dc7d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{1268, 1007},
WindowMargins->{{1342, Automatic}, {63, Automatic}},
TaggingRules-><|
 "PresenterSettings" -> <|"Dialogs" -> {}|>, "TryRealOnly" -> False|>,
Magnification:>1.5 Inherited,
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (December 2, 2021)",
StyleDefinitions->FrontEnd`FileName[{"PresenterTools"}, "Aqua.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"aee0535c-69fe-4f91-9ab5-ec25539e9ff0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 671, 12, 184, "Title",ExpressionUUID->"bb443c9e-1a1c-437e-b10c-400e63a30bb8"],
Cell[1254, 36, 930, 15, 118, "Text",ExpressionUUID->"19c34891-b4a5-4bb2-9167-f8ac0b4049d9"],
Cell[2187, 53, 278, 6, 85, "Text",ExpressionUUID->"e5d073cc-c203-49d2-a223-4a0ef6f9a86d"],
Cell[CellGroupData[{
Cell[2490, 63, 263, 4, 97, "Section",ExpressionUUID->"4890d14d-99aa-4396-8fcb-090e056aa530"],
Cell[2756, 69, 937, 28, 108, "Text",ExpressionUUID->"dee7c3f0-b248-4400-b1c8-73eb4cfe7e37"],
Cell[3696, 99, 4190, 126, 354, "Text",ExpressionUUID->"3051b712-ce87-4332-823e-9db5365dc408"],
Cell[7889, 227, 924, 17, 119, "Text",ExpressionUUID->"5528d7bd-a0da-442e-9f8e-bee0a9dada0e"],
Cell[8816, 246, 1443, 25, 221, "Text",ExpressionUUID->"b58740e6-d141-4144-b0f6-5b04ee3308a5"],
Cell[10262, 273, 690, 11, 85, "Text",ExpressionUUID->"a06a96a1-5ab2-42b7-8214-488f3b03a830"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10989, 289, 213, 4, 97, "Section",ExpressionUUID->"eb071cf8-a99e-49e1-a188-114a69fd84e7"],
Cell[11205, 295, 1446, 42, 230, "Text",ExpressionUUID->"77683d59-441a-4191-bcc8-726d69681fec"],
Cell[12654, 339, 2569, 79, 233, "Text",ExpressionUUID->"b7e077d8-049d-464c-9307-c73bc039f223"],
Cell[15226, 420, 5830, 175, 527, "Text",ExpressionUUID->"1f1fbf69-cecb-44d0-841f-a8938693c357"],
Cell[21059, 597, 1198, 29, 153, "Text",ExpressionUUID->"1138fce6-7cc2-445e-baf5-560951afc884"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22294, 631, 160, 3, 97, "Section",ExpressionUUID->"e6509389-10bd-4603-851c-51b8332c938a"],
Cell[CellGroupData[{
Cell[22479, 638, 154, 3, 72, "Subsection",ExpressionUUID->"cc385a15-324d-465e-8fa0-cc44b0477e11"],
Cell[22636, 643, 3386, 109, 211, "Text",ExpressionUUID->"fa24239b-f428-49be-9a75-82a41cc7b7b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26059, 757, 160, 3, 72, "Subsection",ExpressionUUID->"579dadd3-fed7-4eba-8a1f-9f81ee8a5ee1"],
Cell[26222, 762, 2450, 78, 250, "Text",ExpressionUUID->"dccabaef-6194-4639-a9de-27eb21acbcc7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28709, 845, 161, 3, 72, "Subsection",ExpressionUUID->"e5b75195-bb18-44e1-be71-90134d5abfd4"],
Cell[28873, 850, 231, 4, 51, "Text",ExpressionUUID->"c11979ce-1cdd-48a4-a060-018a092a6c90"],
Cell[CellGroupData[{
Cell[29129, 858, 588, 19, 48, "Item",ExpressionUUID->"32f66f4c-ecb2-4bb4-ab1c-e1350f75e1b4"],
Cell[29720, 879, 299, 8, 48, "Item",ExpressionUUID->"18c3ab73-fe2b-49a9-b097-532d51b52027"],
Cell[30022, 889, 412, 10, 48, "Item",ExpressionUUID->"f8bab608-d34c-463b-bd65-572bb84894a5"]
}, Open  ]],
Cell[30449, 902, 220, 5, 51, "Text",ExpressionUUID->"1e4dc1a3-64bd-4df7-b983-a784e319d17a"],
Cell[30672, 909, 1015, 22, 120, "Text",ExpressionUUID->"922f240e-aff2-4553-980f-b4c311574382"],
Cell[31690, 933, 365, 7, 51, "Text",ExpressionUUID->"bfc341dc-ca7c-43bf-8f03-54a80476b125"],
Cell[CellGroupData[{
Cell[32080, 944, 772, 20, 50, "ItemNumbered",ExpressionUUID->"ccecd8da-3192-42ca-9c7a-e30c956905d4"],
Cell[32855, 966, 777, 22, 50, "ItemNumbered",ExpressionUUID->"0bbedf31-ea78-4a60-ac1d-ae3d0fe38540"],
Cell[33635, 990, 947, 24, 40, "SubitemNumbered",ExpressionUUID->"63677d91-b065-4f69-8311-ea4fb40a8599"],
Cell[34585, 1016, 770, 17, 40, "SubitemNumbered",ExpressionUUID->"ba88ba19-ca8a-48aa-bc55-95b363c6776b",
 CellGroupingRules->{"GroupTogetherNestedGrouping", 15000.}],
Cell[35358, 1035, 832, 19, 40, "SubitemNumbered",ExpressionUUID->"c8ca5021-6d44-46a0-b7df-916d4b39e215",
 CellGroupingRules->{"GroupTogetherNestedGrouping", 15000.}],
Cell[36193, 1056, 797, 19, 50, "ItemNumbered",ExpressionUUID->"a57ec074-3086-4c2d-88fc-9f57c12e0f49"],
Cell[CellGroupData[{
Cell[37015, 1079, 721, 15, 40, "SubitemNumbered",ExpressionUUID->"ba02000d-38d7-49a1-9555-d478e09a999a"],
Cell[37739, 1096, 530, 8, 40, "SubitemNumbered",ExpressionUUID->"49163665-e347-4a19-b4d5-449fd97b9f09"],
Cell[38272, 1106, 616, 9, 40, "SubitemNumbered",ExpressionUUID->"3ce67aa2-6146-4bec-b540-66aa031bf89e"]
}, Open  ]]
}, Open  ]],
Cell[38915, 1119, 294, 5, 51, "Text",ExpressionUUID->"ef25525c-966d-497e-a3a9-d3baca6a857a"],
Cell[CellGroupData[{
Cell[39234, 1128, 7542, 197, 814, "Input",ExpressionUUID->"80f5c0f7-f95d-49d6-8169-bb424bf9c70d"],
Cell[46779, 1327, 25547, 491, 639, "Output",ExpressionUUID->"ce71c505-7407-4ed1-b07a-df99eb285614"]
}, Open  ]],
Cell[72341, 1821, 637, 11, 152, "Text",ExpressionUUID->"08e8c5b8-0eea-481f-80bf-c513c5c5b3e4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[73027, 1838, 160, 3, 97, "Section",ExpressionUUID->"4953d171-c820-43d0-b4d1-e61aba51d146"],
Cell[73190, 1843, 1012, 29, 86, "Text",ExpressionUUID->"4e5867ea-3293-4207-9116-417282a9b325"],
Cell[CellGroupData[{
Cell[74227, 1876, 705, 18, 48, "Item",ExpressionUUID->"b6e87267-0003-458c-8243-d07438edf14d"],
Cell[74935, 1896, 306, 5, 40, "Subitem",ExpressionUUID->"0eba4b84-7bc3-46c3-87a4-7b62713c028c",
 CellGroupingRules->{"GroupTogetherNestedGrouping", 15000.}],
Cell[75244, 1903, 1099, 36, 79, "Item",ExpressionUUID->"edc6cc28-b89f-4151-8afd-c95d27eef67c"],
Cell[76346, 1941, 529, 13, 48, "Item",ExpressionUUID->"59f765b7-bfbf-42e6-ab29-d67f8a88c9f6"],
Cell[76878, 1956, 348, 7, 47, "Item",ExpressionUUID->"a65385fd-9b59-4c9c-8bc4-376a3f49d2c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77263, 1968, 156, 3, 72, "Subsection",ExpressionUUID->"ce22ee2e-3a01-406d-896b-befc7849564f"],
Cell[77422, 1973, 341, 7, 85, "Text",ExpressionUUID->"38d4111a-9d19-4ad1-a58f-ae360b4aba2a"],
Cell[CellGroupData[{
Cell[77788, 1984, 6299, 169, 690, "Input",ExpressionUUID->"0671a547-36d2-4f60-9649-65cadb1e913c"],
Cell[84090, 2155, 252, 4, 86, "Output",ExpressionUUID->"0a221fd6-9552-4ced-978c-9b307dd4c9aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84379, 2164, 625, 18, 46, "Input",ExpressionUUID->"bdd47500-982f-4e9d-bab3-8968655c341e"],
Cell[85007, 2184, 274, 6, 69, "Output",ExpressionUUID->"62abe3fc-9ee6-41d7-b7ef-34714941c867"]
}, Open  ]],
Cell[85296, 2193, 488, 12, 52, "Text",ExpressionUUID->"c5791f17-b3be-4542-9347-aa97ff80f8b3"],
Cell[85787, 2207, 389, 8, 85, "Text",ExpressionUUID->"6a514b1a-f441-47fc-8d3d-6cb1e5e2bbb7"],
Cell[CellGroupData[{
Cell[86201, 2219, 4772, 121, 549, "Input",ExpressionUUID->"cb9fda57-492d-4c29-a0d8-b3055fb20ed7"],
Cell[90976, 2342, 14971, 271, 639, "Output",ExpressionUUID->"731dd66f-7b8a-44ef-9b80-ff0a51b0142f"]
}, Open  ]],
Cell[105962, 2616, 559, 14, 52, "Text",ExpressionUUID->"10d7ee1d-c129-4982-ab43-bfee02467591"],
Cell[CellGroupData[{
Cell[106546, 2634, 584, 16, 46, "Input",ExpressionUUID->"a6fe7d1d-8026-4907-9832-31291a190983"],
Cell[107133, 2652, 4182, 102, 378, "Output",ExpressionUUID->"c2b1d7a0-12d0-49cc-906d-c6401926973c"]
}, Open  ]],
Cell[111330, 2757, 825, 24, 52, "Text",ExpressionUUID->"7d55ed42-ba7f-4acb-97a8-1c4f07cb2b37"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[112204, 2787, 284, 4, 97, "Section",ExpressionUUID->"9a6affb0-75d1-453c-b6c8-6d310f5ec9ed"],
Cell[CellGroupData[{
Cell[112513, 2795, 384, 8, 149, "Subsection",ExpressionUUID->"4b106c00-ba87-4e76-822c-7e6c4cdaa767"],
Cell[112900, 2805, 1749, 48, 190, "Text",ExpressionUUID->"44044b81-b1ec-42ad-a9c2-b47e054157e5"],
Cell[114652, 2855, 1405, 35, 226, "Input",ExpressionUUID->"235cd440-a4a0-4f6a-9a8b-985fcb7364d3",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[116082, 2894, 1143, 28, 171, "Input",ExpressionUUID->"d2603c5a-81e8-43f5-8d04-d1e37859f15c"],
Cell[117228, 2924, 548, 7, 69, "Output",ExpressionUUID->"40521da9-00c2-4aa2-81ce-17f6b0b2ebbb"],
Cell[117779, 2933, 795, 13, 69, "Output",ExpressionUUID->"a37e0e83-6826-4adc-bd69-fdc92b085e21"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[118623, 2952, 387, 8, 149, "Subsection",ExpressionUUID->"9f956903-6117-4f99-ab36-50bb0ccfd55d"],
Cell[119013, 2962, 771, 13, 51, "Text",ExpressionUUID->"2efabaa9-2601-4894-bd02-8e28dd3879c9"],
Cell[119787, 2977, 785, 18, 133, "Input",ExpressionUUID->"2abcccf5-0252-4a6e-acaf-06ac9e31921e",
 InitializationCell->True],
Cell[120575, 2997, 157, 3, 51, "Text",ExpressionUUID->"4bc72b3f-fae1-44de-b432-979aff0a6ede"],
Cell[CellGroupData[{
Cell[120757, 3004, 1516, 37, 140, "Input",ExpressionUUID->"949a12d8-f2a2-483b-85f9-e2376cbc9141"],
Cell[122276, 3043, 836, 13, 72, "Output",ExpressionUUID->"ee91023b-b5c2-483c-9d2a-06a289add75a"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[123173, 3063, 165, 3, 97, "Section",ExpressionUUID->"54230a9d-32b5-498b-8f54-51a1e258576c"],
Cell[123341, 3068, 2067, 55, 222, "Text",ExpressionUUID->"786eee0a-2fc8-44ad-a692-64883088349a"],
Cell[CellGroupData[{
Cell[125433, 3127, 1055, 31, 140, "Input",ExpressionUUID->"17130879-0147-4605-a0b9-0f8bdfc37a61"],
Cell[126491, 3160, 547, 11, 69, "Output",ExpressionUUID->"0f44ea80-586f-43b6-9351-27f31f3ce7cb"]
}, Open  ]],
Cell[127053, 3174, 396, 7, 51, "Text",ExpressionUUID->"f961ec69-4066-44e1-a467-b2a11a63cbb1"],
Cell[CellGroupData[{
Cell[127474, 3185, 1655, 51, 264, "Input",ExpressionUUID->"da3ccd62-aee5-4718-be9f-637aa8d46cbb"],
Cell[129132, 3238, 3750, 78, 218, "Output",ExpressionUUID->"f2b39b9f-10f1-48f5-99da-fafcd6985693"],
Cell[132885, 3318, 374, 8, 70, "Output",ExpressionUUID->"83995d3c-785f-4ad5-9c39-3dff2e491473"]
}, Open  ]],
Cell[133274, 3329, 731, 16, 83, "Text",ExpressionUUID->"e1d2f7e9-b640-4c6d-9222-80412fad2ae3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134042, 3350, 161, 3, 97, "Section",ExpressionUUID->"43028209-9239-4f58-9f50-624b5cfb31ff"],
Cell[CellGroupData[{
Cell[134228, 3357, 1144, 32, 128, "Input",ExpressionUUID->"0dc877ea-558d-4bd9-9059-6d08364b736a"],
Cell[135375, 3391, 1630, 43, 124, "Output",ExpressionUUID->"0ca33e49-ec34-41fb-8321-51fe38ac808d"]
}, Open  ]],
Cell[137020, 3437, 517, 9, 83, "Text",ExpressionUUID->"2d6dc367-703b-4d53-a703-88ae6812af9a"],
Cell[CellGroupData[{
Cell[137562, 3450, 202, 3, 60, "Input",ExpressionUUID->"46e55fc9-efd6-4244-ab69-83c56ab0adb2"],
Cell[137767, 3455, 177, 3, 66, "Output",ExpressionUUID->"2f902ddf-9a84-46b4-b3c8-a7277decac23"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137981, 3463, 190, 4, 60, "Input",ExpressionUUID->"8ee4a5fc-b746-4a68-9a7f-66cbf5b38ad9"],
Cell[138174, 3469, 12518, 309, 308, "Output",ExpressionUUID->"4d79a359-60a4-4cda-a647-3e3bd35c8d4f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150729, 3783, 3154, 94, 346, "Input",ExpressionUUID->"eb0554ab-d6e6-4af5-bb6f-43018c5dcdda"],
Cell[153886, 3879, 726, 13, 70, "Output",ExpressionUUID->"540e91bf-5ffe-4ead-8190-63aa0e999f82"],
Cell[154615, 3894, 721, 13, 70, "Output",ExpressionUUID->"61741326-b7cf-4703-a7cb-8943a04e2041"],
Cell[155339, 3909, 5481, 112, 332, "Output",ExpressionUUID->"a536d756-e9f1-4d02-8108-040f7f41dc7d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

